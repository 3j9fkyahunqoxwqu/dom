<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN"><html lang="en-US"><head>
  <meta content="text/html;charset=UTF-8" http-equiv="content-type">
  <title>DOM Core</title>
  <style type="text/css">
   pre.idl { border:solid thin; background:#eee; color:#000; padding:0.5em }
   pre.idl :link, pre.idl :visited { color:inherit; background:transparent }
   pre code { color:inherit; background:transparent }
   div.example { margin-left:1em; padding-left:1em; border-left:double; color:#222; background:#fcfcfc }
   .note { margin-left:2em; font-weight:bold; font-style:italic; color:#008000 }
   p.note::before { content:"Note: " }
   .XXX { padding:.5em; border:solid #f00 }
   p.XXX::before { content:"Issue: " }
   dl.switch { padding-left:2em }
   dl.switch > dt { text-indent:-1.5em }
   dl.switch > dt:before { content:'\21AA'; padding:0 0.5em 0 0; display:inline-block; width:1em; text-align:right; line-height:0.5em }
   dl.domintro { color: green; margin: 2em 0 2em 2em; padding: 0.5em 1em; border: none; background: #DDFFDD; }
   dl.domintro dt, dl.domintro dt * { color: black; text-decoration: none; }
   dl.domintro dd { margin: 0.5em 0 1em 2em; padding: 0; }
   dl.domintro dd p { margin: 0.5em 0; }
   dl.domintro:before { display: table; margin: -1em -0.5em -0.5em auto; width: auto; content: 'This box is non-normative. Implementation requirements are given below this box.'; color: red; border: solid 2px; background: white; padding: 0 0.25em; }
   em.ct { text-transform:lowercase; font-variant:small-caps; font-style:normal }
   dfn { font-weight:bold; font-style:normal }
   code { color:orangered }
   code :link, code :visited { color:inherit }
   hr:not(.top) { display:block; background:none; border:none; padding:0; margin:2em 0; height:auto }
   table { border-collapse:collapse; border-style:hidden hidden none hidden }
   table thead { border-bottom:solid }
   table tbody th:first-child { border-left:solid }
   table td, table th { border-left:solid; border-right:solid; border-bottom:solid thin; vertical-align:top; padding:0.2em }

   .warning { color: red; background: transparent; font-weight: bolder; font-style: italic; }
   .warning p:first-child { margin-top: 0; }
   .warning p:last-child { margin-bottom: 0; }
   .warning:before { font-style: normal; }
   p.warning:before { content: '\26A0 Warning! '; }

   @media print {
     [data-anolis-spec]::after { content:"[" attr(data-anolis-spec) "]"; font-size:.6em; vertical-align:super; text-transform:uppercase }
   }
  </style>
  <link href="http://www.w3.org/StyleSheets/TR/W3C-ED" rel="stylesheet">
 </head>
 <body>

<div class="head">

<!--begin-logo-->
<p><a href="http://www.w3.org/"><img alt="W3C" height="48" src="http://www.w3.org/Icons/w3c_home" width="72"></a></p>
<!--end-logo-->
 <h1>DOM Core</h1>
 <h2 class="no-num no-toc" id="editor-s-draft-4-march-2011">Editor's Draft 4 March 2011</h2>

 <dl>
  <dt>This Version:
  <dd class="dontpublish"><a href="http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html">http://dvcs.w3.org/hg/domcore/raw-file/tip/Overview.html</a>
  <dt>Latest Version:
  <dd><a href="http://www.w3.org/TR/domcore">http://www.w3.org/TR/domcore</a>

  <dt>Previous Versions:
  <dd><a href="http://www.w3.org/TR/2010/WD-domcore-20101007/">http://www.w3.org/TR/2010/WD-domcore-20101007/</a>

  <dt>Editors:
  <dd><a href="http://annevankesteren.nl/">Anne van Kesteren</a>
    (<a href="http://www.opera.com/">Opera Software ASA</a>)
    &lt;<a href="mailto:annevk@opera.com">annevk@opera.com</a>&gt;
  <dd>Ms2ger (<a href="http://www.mozilla.org/">Mozilla Foundation</a>)
    &lt;<a href="mailto:ms2ger@gmail.com">ms2ger@gmail.com</a>&gt;
 </dl>

<!--begin-copyright-->
<p class="copyright"><a href="http://www.w3.org/Consortium/Legal/ipr-notice#Copyright">Copyright</a> &copy; 2011 <a href="http://www.w3.org/"><abbr title="World Wide Web Consortium">W3C</abbr></a><sup>&reg;</sup> (<a href="http://www.csail.mit.edu/"><abbr title="Massachusetts Institute of Technology">MIT</abbr></a>, <a href="http://www.ercim.eu/"><abbr title="European Research Consortium for Informatics and Mathematics">ERCIM</abbr></a>, <a href="http://www.keio.ac.jp/">Keio</a>), All Rights Reserved. W3C <a href="http://www.w3.org/Consortium/Legal/ipr-notice#Legal_Disclaimer">liability</a>, <a href="http://www.w3.org/Consortium/Legal/ipr-notice#W3C_Trademarks">trademark</a> and <a href="http://www.w3.org/Consortium/Legal/copyright-documents">document use</a> rules apply.</p>
<!--end-copyright-->
</div>

<hr class="top">

<h2 class="no-num no-toc" id="abstract">Abstract</h2>
<p>DOM Core defines the event and document model the Web platform uses. The
DOM is a language- and platform neutral interface that allows programs and
scripts to dynamically access and update the content and structure of
documents.
<!-- XXX say something about exceptions? -->



<h2 class="no-num no-toc" id="status-of-this-document"><span id="sotd">Status of this Document</span></h2>
<p><i>This section describes the status of this document at the time of its
publication. Other documents may supersede this document. A list of current W3C
publications and the latest revision of this technical report can be found in
the <a href="http://www.w3.org/TR/">W3C technical reports index</a> at
http://www.w3.org/TR/.</i>

<p>This is the 4 March 2011 Editor's Draft of DOM Core. Please send
comments to
<a href="mailto:www-dom@w3.org?subject=%5BDOMCore%5D%20">www-dom@w3.org</a>
(<a href="http://lists.w3.org/Archives/Public/www-dom/">archived</a>)
with <samp>[DOMCore]</samp> at the start of the subject line.

<p>This document is produced by the
<a href="http://www.w3.org/2008/webapps/">Web Applications</a> (WebApps) Working
Group. The WebApps Working Group is part of the
<a href="http://www.w3.org/2006/rwc/Activity">Rich Web Clients Activity</a> in
the W3C <a href="http://www.w3.org/Interaction/">Interaction Domain</a>.

<p>This document was produced by a group operating under the
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/">5 February 2004
W3C Patent Policy</a>. W3C maintains a
<a href="http://www.w3.org/2004/01/pp-impl/42538/status" rel="disclosure">public
list of any patent disclosures</a> made in connection with the deliverables of
the group; that page also includes instructions for disclosing a patent. An
individual who has actual knowledge of a patent which the individual believes
contains
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#def-essential">Essential
Claim(s)</a> must disclose the information in accordance with
<a href="http://www.w3.org/Consortium/Patent-Policy-20040205/#sec-Disclosure">section
6 of the W3C Patent Policy</a>.

<p>Publication as a Working Draft does not imply endorsement by the W3C
Membership. This is a draft document and may be updated, replaced or
obsoleted by other documents at any time. It is inappropriate to cite this
document as other than work in progress.



<h2 class="no-num no-toc" id="table-of-contents">Table of Contents</h2>

<!--begin-toc-->
<ol class="toc">
 <li><a class="no-num" href="#goals">Goals</a></li>
 <li><a class="no-num" href="#issues">Issues</a></li>
 <li><a href="#conformance"><span class="secno">1 </span>Conformance</a>
  <ol class="toc">
   <li><a href="#dependencies"><span class="secno">1.1 </span>Dependencies</a></li>
   <li><a href="#extensibility"><span class="secno">1.2 </span>Extensibility</a></ol></li>
 <li><a href="#terminology"><span class="secno">2 </span>Terminology</a>
  <ol class="toc">
   <li><a href="#trees"><span class="secno">2.1 </span>Trees</a></li>
   <li><a href="#strings"><span class="secno">2.2 </span>Strings</a></li>
   <li><a href="#common-microsyntaxes"><span class="secno">2.3 </span>Common microsyntaxes</a>
    <ol class="toc">
     <li><a href="#common-parser-idioms"><span class="secno">2.3.1 </span>Common parser idioms</a></li>
     <li><a href="#space-separated-tokens"><span class="secno">2.3.2 </span>Space-separated tokens</a></ol></li>
   <li><a href="#namespaces"><span class="secno">2.4 </span>Namespaces</a></ol></li>
 <li><a href="#exceptions"><span class="secno">3 </span>Exceptions</a>
  <ol class="toc">
   <li><a href="#exception-domexception"><span class="secno">3.1 </span>Exception <code>DOMException</code></a></ol></li>
 <li><a href="#events"><span class="secno">4 </span>Events</a>
  <ol class="toc">
   <li><a href="#interface-event"><span class="secno">4.1 </span>Interface <code>Event</code></a></li>
   <li><a href="#interface-customevent"><span class="secno">4.2 </span>Interface <code>CustomEvent</code></a></li>
   <li><a href="#interface-eventtarget"><span class="secno">4.3 </span>Interface <code>EventTarget</code></a></li>
   <li><a href="#creating-events"><span class="secno">4.4 </span>Creating Events</a></li>
   <li><a href="#dispatching-events"><span class="secno">4.5 </span>Dispatching Events</a></li>
   <li><a href="#firing-events"><span class="secno">4.6 </span>Firing Events</a></ol></li>
 <li><a href="#nodes"><span class="secno">5 </span>Nodes</a>
  <ol class="toc">
   <li><a href="#nodes-model"><span class="secno">5.1 </span>Nodes Model</a></li>
   <li><a href="#cloning-nodes"><span class="secno">5.2 </span>Cloning nodes</a></li>
   <li><a href="#interface-node"><span class="secno">5.3 </span>Interface <code>Node</code></a></li>
   <li><a href="#interface-documentfragment"><span class="secno">5.4 </span>Interface <code>DocumentFragment</code></a></li>
   <li><a href="#interface-document"><span class="secno">5.5 </span>Interface <code>Document</code></a>
    <ol class="toc">
     <li><a href="#interface-domimplementation"><span class="secno">5.5.1 </span>Interface <code>DOMImplementation</code></a></ol></li>
   <li><a href="#interface-element"><span class="secno">5.6 </span>Interface <code>Element</code></a>
    <ol class="toc">
     <li><a href="#interface-attr"><span class="secno">5.6.1 </span>Interface <code>Attr</code></a></ol></li>
   <li><a href="#interface-documenttype"><span class="secno">5.7 </span>Interface <code>DocumentType</code></a></li>
   <li><a href="#interface-processinginstruction"><span class="secno">5.8 </span>Interface <code>ProcessingInstruction</code></a></li>
   <li><a href="#interface-characterdata"><span class="secno">5.9 </span>Interface <code>CharacterData</code></a></li>
   <li><a href="#interface-text"><span class="secno">5.10 </span>Interface <code>Text</code></a></li>
   <li><a href="#interface-comment"><span class="secno">5.11 </span>Interface <code>Comment</code></a></ol></li>
 <li><a href="#collections"><span class="secno">6 </span>Collections</a>
  <ol class="toc">
   <li><a href="#interface-nodelist"><span class="secno">6.1 </span>Interface <code>NodeList</code></a></li>
   <li><a href="#interface-htmlcollection"><span class="secno">6.2 </span>Interface <code>HTMLCollection</code></a></ol></li>
 <li><a href="#lists"><span class="secno">7 </span>Lists</a>
  <ol class="toc">
   <li><a href="#interface-domstringlist"><span class="secno">7.1 </span>Interface <code>DOMStringList</code></a></li>
   <li><a href="#interface-domtokenlist"><span class="secno">7.2 </span>Interface <code>DOMTokenList</code></a></li>
   <li><a href="#interface-domsettabletokenlist"><span class="secno">7.3 </span>Interface <code>DOMSettableTokenList</code></a></ol></li>
 <li><a href="#dom-features"><span class="secno">8 </span>DOM features</a></li>
 <li><a href="#historical"><span class="secno">9 </span>Historical</a>
  <ol class="toc">
   <li><a href="#dom-events"><span class="secno">9.1 </span>DOM Events</a></li>
   <li><a href="#dom-core"><span class="secno">9.2 </span>DOM Core</a></li>
   <li><a href="#html"><span class="secno">9.3 </span>HTML</a></li>
   <li><a href="#element-traversal"><span class="secno">9.4 </span>Element Traversal</a></ol></li>
 <li><a class="no-num" href="#references">References</a>
  <ol class="toc">
   <li><a class="no-num" href="#normative-references">Normative references</a></li>
   <li><a class="no-num" href="#informative-references">Informative references</a></ol></li>
 <li><a class="no-num" href="#acknowledgements">Acknowledgements</a></ol>
<!--end-toc-->



<h2 class="no-num" id="goals">Goals</h2>

<p>The goal of this specification is taking all of DOM Level 3 Core and the
"DOM Event Architecture" and "Basic Event Interfaces" chapters of
DOM Level 3 Events (specific type of events do not belong in the base
specification) and do the following:</p>

<ul>
 <li>Align them with the needs of ECMAScript where possible.
 <li>Align them with existing implementations.
 <li>Simplify them as much as possible.
 <li>Import bits of HTML5 that ought to be in DOM Core.
 <li>Prevent a dependency on HTML5.
</ul>

<p>New features might be added, once everything else is sort of stable.


<h2 class="no-num" id="issues">Issues</h2>

<ul class="XXX">
 <li>Node.baseURI
 <li>Node.compareDocumentPosition
 <li>Document.documentURI
 <li>Move DOMStringMap here?
 <li>Move Document.charset / Document.characterSet / Document.defaultCharset here?
</ul>


<h2 id="conformance"><span class="secno">1 </span>Conformance</h2>
<p>All diagrams, examples, and notes in this specification are
non-normative, as are all sections explicitly marked non-normative.
Everything else in this specification is normative.

<p>The key words "MUST", "MUST NOT", "REQUIRED", <!--"SHALL", "SHALL
NOT",--> "SHOULD", "SHOULD NOT", "RECOMMENDED", "MAY", and
"OPTIONAL" in the normative parts of this document are to be
interpreted as described in RFC2119. For readability, these words do
not appear in all uppercase letters in this specification. <a href="#refsRFC2119">[RFC2119]</a>

<p>Requirements phrased in the imperative as part of algorithms
(such as "strip any leading space characters" or "return false and
terminate these steps") are to be interpreted with the meaning of the
key word ("must", "should", "may", etc) used in introducing the
algorithm.

<p>Conformance requirements phrased as algorithms or specific steps
may be implemented in any manner, so long as the end result is
equivalent. (In particular, the algorithms defined in this
specification are intended to be easy to follow, and not intended to
be performant.)

<p id="hardwareLimitations">User agents may impose
implementation-specific limits on otherwise unconstrained inputs,
e.g. to prevent denial of service attacks, to guard against running
out of memory, or to work around platform-specific limitations.

<p>When a method or an attribute is said to call another method or attribute, the user agent must invoke its internal API for that attribute or method so that e.g. the author can't change the behavior by overriding attributes or methods with custom properties or functions in ECMAScript.

<p>Unless otherwise stated, string comparisons are done in a <a href="#case-sensitive">case-sensitive</a> manner.

<h3 id="dependencies"><span class="secno">1.1 </span>Dependencies</h3>

<p>The IDL fragments in this specification must be interpreted as
required for conforming IDL fragments, as described in the Web IDL
specification. <a href="#refsWEBIDL">[WEBIDL]</a>

<p>Some of the terms used in this specification are defined in
<cite>Web IDL</cite>, <cite>XML</cite> and <cite>Namespaces in XML</cite>.
<a href="#refsWEBIDL">[WEBIDL]</a>
<a href="#refsXML">[XML]</a>
<a href="#refsXMLNS">[XMLNS]</a>

<h3 id="extensibility"><span class="secno">1.2 </span>Extensibility</h3>

<p>Vendor-specific proprietary extensions to this specification are
strongly discouraged. Authors must not use such extensions, as
doing so reduces interoperability and fragments the user base,
allowing only users of specific user agents to access the content in
question.

<p>If vendor-specific extensions are needed, the members should be
prefixed by vendor-specific strings to prevent clashes with future
versions of this specification. Extensions must be defined so that
the use of extensions neither contradicts nor causes the
non-conformance of functionality defined in the specification.
<!-- thanks to QA Framework -->

<p>When vendor-neutral extensions to this specification are needed,
either this specification can be updated accordingly, or an
extension specification can be written that overrides the
requirements in this specification. When someone applying this
specification to their activities decides that they will recognise
the requirements of such an extension specification, it becomes an
<dfn id="other-applicable-specifications" title="other applicable specifications">applicable
specification</dfn> for the purposes of conformance requirements in
this specification.
<!-- http://www.w3.org/mid/17E341CD-E790-422C-9F9A-69347EE01CEB@iki.fi -->


<h2 id="terminology"><span class="secno">2 </span>Terminology</h2>

<p>The term <dfn id="context-object">context object</dfn> means the object on which the method
or attribute being discussed was called. When the <a href="#context-object">context object</a>
is unambiguous, the term can be omitted.


<h3 id="trees"><span class="secno">2.1 </span>Trees</h3> <!-- Sorry reddit, this is not /r/trees -->

<p>Just like most programming paradigms the Web platform has finite
hierarchical tree structures, simply named
<dfn id="concept-tree" title="concept-tree">trees</dfn>.

<p>An object that <dfn id="concept-tree-participate" title="concept-tree-participate">participates</dfn> in
a <a href="#concept-tree" title="concept-tree">tree</a> has a
<dfn id="concept-tree-parent" title="concept-tree-parent">parent</dfn>, which is either another object
or null, and an ordered list of zero or more
<dfn id="concept-tree-child" title="concept-tree-child">child</dfn> objects.

<p>An object whose <a href="#concept-tree-parent" title="concept-tree-parent">parent</a> is null is
called the <dfn id="concept-tree-root" title="concept-tree-root">root</dfn> object.

<p>An object <var title="">A</var> is called a
<dfn id="concept-tree-descendant" title="concept-tree-descendant">descendant</dfn> of an object
<var title="">B</var>, if either <var title="">A</var> is a
<a href="#concept-tree-child" title="concept-tree-child">child</a> of <var title="">B</var> or
<var title="">A</var> is a <a href="#concept-tree-child" title="concept-tree-child">child</a> of an
object <var title="">C</var> that is a
<a href="#concept-tree-descendant" title="concept-tree-descendant">descendant</a> of <var title="">B</var>.

<p>An object <var title="">A</var> is called an
<dfn id="concept-tree-ancestor" title="concept-tree-ancestor">ancestor</dfn> of an object
<var title="">B</var> if and only if <var title="">B</var> is a
<a href="#concept-tree-descendant" title="concept-tree-descendant">descendant</a> of
<var title="">A</var>.

<p>An object <var title="">A</var> is called a
<dfn id="concept-tree-sibling" title="concept-tree-sibling">sibling</dfn> of an object
<var title="">B</var>, if and only if <var title="">B</var> and <var title="">A</var>
share the same non-null <a href="#concept-tree-parent" title="concept-tree-parent">parent</a>.
<var title="">A</var> is a
<dfn id="concept-tree-preceding-sibling" title="concept-tree-preceding-sibling">preceding sibling</dfn> of
<var title="">B</var> if <var title="">A</var> and <var title="">B</var> are
<a href="#concept-tree-sibling" title="concept-tree-sibling">siblings</a> and <var title="">A</var>
comes before <var title="">B</var> in their shared
<a href="#concept-tree-parent" title="concept-tree-parent">parent</a>.
<var title="">A</var> is a
<dfn id="concept-tree-following-sibling" title="concept-tree-following-sibling">following sibling</dfn> of
<var title="">B</var> if <var title="">A</var> and <var title="">B</var> are
<span title="concept-sibling-node">siblings</span> and <var title="">A</var>
comes after <var title="">B</var> in their shared
<a href="#concept-tree-parent" title="concept-tree-parent">parent</a>.

<hr>

<p>The term <dfn id="tree-order">tree order</dfn> means a pre-order, depth-first traversal
of a <a href="#concept-tree" title="concept-tree">tree</a>.
<!-- XXX should that use concept- ? -->
<!-- http://en.wikipedia.org/wiki/Tree_traversal#Depth-first_Traversal -->


<h3 id="strings"><span class="secno">2.2 </span>Strings</h3>
<p>Comparing two strings in a <dfn id="case-sensitive">case-sensitive</dfn> manner means comparing them exactly, codepoint for codepoint.

<p>Comparing two strings in a <dfn id="ascii-case-insensitive">ASCII case-insensitive</dfn> manner means comparing them exactly, codepoint for codepoint, except that the characters in the range U+0041 .. U+005A (i.e. LATIN CAPITAL LETTER A to LATIN CAPITAL LETTER Z) and the corresponding characters in the range U+0061 .. U+007A (i.e. LATIN SMALL LETTER A to LATIN SMALL LETTER Z) are considered to also match.

<p><dfn id="converted-to-uppercase" title="converted to uppercase">Converting a string to uppercase</dfn> means replacing all characters in the range U+0061 .. U+007A (i.e. LATIN SMALL LETTER A to LATIN SMALL LETTER Z) with the corresponding characters in the range U+0041 .. U+005A (i.e. LATIN CAPITAL LETTER A to LATIN CAPITAL LETTER Z).

<p><dfn id="converted-to-lowercase" title="converted to lowercase">Converting a string to lowercase</dfn> means replacing all characters in the range U+0041 .. U+005A (i.e. LATIN CAPITAL LETTER A to LATIN CAPITAL LETTER Z) with the corresponding characters in the range U+0061 .. U+007A (i.e. LATIN SMALL LETTER A to LATIN SMALL LETTER Z).

<p>A string <var title="">pattern</var> is a <dfn id="prefix-match">prefix match</dfn> for a string
<var title="">s</var> when <var title="">pattern</var> is not longer than
<var title="">s</var> and truncating <var title="">s</var> to
<var title="">pattern</var>'s length leaves the two strings as matches of each
other.

<p>The <dfn id="space-character" title="space character">space characters</dfn>, for the
purposes of this specification, are U+0020 SPACE, U+0009 CHARACTER
TABULATION (tab), U+000A LINE FEED (LF), U+000C FORM FEED (FF), and
U+000D CARRIAGE RETURN (CR).


<h3 id="common-microsyntaxes"><span class="secno">2.3 </span>Common microsyntaxes</h3>
<h4 id="common-parser-idioms"><span class="secno">2.3.1 </span>Common parser idioms</h4>
<p>Some of the micro-parsers described below follow the pattern of having an
<var title="">input</var> variable that holds the string being parsed, and having a
<var title="">position</var> variable pointing at the next character to parse in
<var title="">input</var>.

<p>For parsers based on this pattern, a step that requires the user agent to
<dfn id="collect-a-sequence-of-characters">collect a sequence of characters</dfn> means that the following algorithm
must be run, with <var title="">characters</var> being the set of characters that
can be collected:

<ol>
 <li><p>Let <var title="">input</var> and <var title="">position</var> be the same
 variables as those of the same name in the algorithm that invoked these steps.

 <li><p>Let <var title="">result</var> be the empty string.

 <li><p>While <var title="">position</var> does not point past the end of
 <var title="">input</var> and the character at <var title="">position</var> is one of
 the <var title="">characters</var>, append that character to the end of
 <var title="">result</var> and advance <var title="">position</var> to the next
 character in <var title="">input</var>.

 <li><p>Return <var title="">result</var>.
</ol>

<p>The step <dfn id="skip-whitespace">skip whitespace</dfn> means that the user agent
must <a href="#collect-a-sequence-of-characters">collect a sequence of characters</a> that are <a href="#space-character" title="space character">space characters</a>. The collected
characters are not used.

<h4 id="space-separated-tokens"><span class="secno">2.3.2 </span>Space-separated tokens</h4>

<p>A <dfn id="set-of-space-separated-tokens">set of space-separated tokens</dfn> is a string containing
zero or more words (known as tokens) separated by one or more <a href="#space-character" title="space character">space characters</a>, where words consist
of any string of one or more characters, none of which are <a href="#space-character" title="space character">space characters</a>.

<p>A string containing a <a href="#set-of-space-separated-tokens">set of space-separated tokens</a>
may have leading or trailing <a href="#space-character" title="space character">space
characters</a>.

<p>An <dfn id="unordered-set-of-unique-space-separated-tokens">unordered set of unique space-separated tokens</dfn> is a
<a href="#set-of-space-separated-tokens">set of space-separated tokens</a> where none of the tokens
are duplicated.

<p>An <dfn id="ordered-set-of-unique-space-separated-tokens">ordered set of unique space-separated tokens</dfn> is a
<a href="#set-of-space-separated-tokens">set of space-separated tokens</a> where none of the tokens
are duplicated but where the order of the tokens is meaningful.

<p><a href="#set-of-space-separated-tokens" title="set of space-separated tokens">Sets of
space-separated tokens</a> sometimes have a defined set of
allowed values. When a set of allowed values is defined, the tokens
must all be from that list of allowed values; other values are
non-conforming. If no such set of allowed values is provided, then
all values are conforming.

<p class="note">How tokens in a <a href="#set-of-space-separated-tokens">set of space-separated
tokens</a> are to be compared (e.g. case-sensitively or not) is
defined on a per-set basis.

<div class="impl">

<p>When a user agent has to <dfn id="split-a-string-on-spaces">split a string on spaces</dfn>, it
must use the following algorithm:

<ol>
 <li><p>Let <var title="">input</var> be the string being parsed.

 <li><p>Let <var title="">position</var> be a pointer into <var title="">input</var>,
 initially pointing at the start of the string.

 <li><p>Let <var title="">tokens</var> be a list of tokens, initially empty.

 <li><p><a href="#skip-whitespace">Skip whitespace</a>.

 <li><p>While <var title="">position</var> is not past the end of
 <var title="">input</var>:

  <ol>
   <li><p><a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are not
   <a href="#space-character" title="space character">space characters</a>.

   <li><p>Add the string collected in the previous step to
   <var title="">tokens</var>.

   <li><p><a href="#skip-whitespace">Skip whitespace</a>.
  </ol>

 <li><p>Return <var title="">tokens</var>.
</ol>

<p>When a user agent has to <dfn id="remove-a-token-from-a-string">remove a token from a string</dfn>,
it must use the following algorithm:

<ol>
 <li><p>Let <var title="">input</var> be the string being modified.

 <li><p>Let <var title="">token</var> be the token being removed. It will not
 contain any <a href="#space-character" title="space character">space characters</a>.

 <li><p>Let <var title="">output</var> be the output string, initially empty.

 <li><p>Let <var title="">position</var> be a pointer into <var title="">input</var>,
 initially pointing at the start of the string.

 <li><p><i title="">Loop</i>: If <var title="">position</var> is beyond the end of
 <var title="">input</var>, terminate these steps.

 <li>
  <p>If the character at <var title="">position</var> is a <a href="#space-character">space
  character</a>:

  <ol>
   <li><p>Append the character at <var title="">position</var> to the end of <var title="">output</var>.

   <li><p>Advance <var title="">position</var> so it points at the next character
   in <var title="">input</var>.

   <li><p>Return to the step labeled <i title="">loop</i>.
  </ol>

 <li><p>Otherwise, the character at <var title="">position</var> is the first
 character of a token. <a href="#collect-a-sequence-of-characters">Collect a sequence of characters</a> that are
 not <a href="#space-character" title="space character">space characters</a>, and let that be <var title="">s</var>.

 <li>
  <p>If <var title="">s</var> is exactly equal to <var title="">token</var>, then:

  <ol>
   <li><p><a href="#skip-whitespace">Skip whitespace</a> (in <var title="">input</var>).

   <li><p>Remove any <a href="#space-character" title="space character">space characters</a>
   currently at the end of <var title="">output</var>.

   <li><p>If <var title="">position</var> is not past the end of <var title="">input</var>, and <var title="">output</var> is not the empty string,
   append a single U+0020 SPACE character at the end of <var title="">output</var>.
  </ol>

 <li><p>Otherwise, append <var title="">s</var> to the end of <var title="">output</var>.

 <li><p>Return to the step labeled <i title="">loop</i>.
</ol>

<p class="note">This causes any occurrences of the token to be
removed from the string, and any spaces that were surrounding the
token to be collapsed to a single space, except at the start and end
of the string, where such spaces are removed.

</div>


<h3 id="namespaces"><span class="secno">2.4 </span>Namespaces</h3>
<p>The <dfn id="html-namespace">HTML namespace</dfn> is <code title="">http://www.w3.org/1999/xhtml</code>.

<p>The <dfn id="xml-namespace">XML namespace</dfn> is <code title="">http://www.w3.org/XML/1998/namespace</code>.

<p>The <dfn id="xmlns-namespace">XMLNS namespace</dfn> is <code title="">http://www.w3.org/2000/xmlns/</code>.


<h2 id="exceptions"><span class="secno">3 </span>Exceptions</h2>
<h3 id="exception-domexception"><span class="secno">3.1 </span>Exception <code><a href="#domexception">DOMException</a></code></h3>
<pre class="idl">exception <dfn id="domexception">DOMException</dfn> {
  const unsigned short <a href="#dom-domexception-index_size_err" title="dom-DOMException-INDEX_SIZE_ERR">INDEX_SIZE_ERR</a> = 1;
  const unsigned short <a href="#dom-domexception-domstring_size_err" title="dom-DOMException-DOMSTRING_SIZE_ERR">DOMSTRING_SIZE_ERR</a> = 2; // historical
  const unsigned short <a href="#dom-domexception-hierarchy_request_err" title="dom-DOMException-HIERARCHY_REQUEST_ERR">HIERARCHY_REQUEST_ERR</a> = 3;
  const unsigned short <a href="#dom-domexception-wrong_document_err" title="dom-DOMException-WRONG_DOCUMENT_ERR">WRONG_DOCUMENT_ERR</a> = 4;
  const unsigned short <a href="#dom-domexception-invalid_character_err" title="dom-DOMException-INVALID_CHARACTER_ERR">INVALID_CHARACTER_ERR</a> = 5;
  const unsigned short <a href="#dom-domexception-no_data_allowed_err" title="dom-DOMException-NO_DATA_ALLOWED_ERR">NO_DATA_ALLOWED_ERR</a> = 6; // historical
  const unsigned short <a href="#dom-domexception-no_modification_allowed_err" title="dom-DOMException-NO_MODIFICATION_ALLOWED_ERR">NO_MODIFICATION_ALLOWED_ERR</a> = 7;
  const unsigned short <a href="#dom-domexception-not_found_err" title="dom-DOMException-NOT_FOUND_ERR">NOT_FOUND_ERR</a> = 8;
  const unsigned short <a href="#dom-domexception-not_supported_err" title="dom-DOMException-NOT_SUPPORTED_ERR">NOT_SUPPORTED_ERR</a> = 9;
  const unsigned short <a href="#dom-domexception-inuse_attribute_err" title="dom-DOMException-INUSE_ATTRIBUTE_ERR">INUSE_ATTRIBUTE_ERR</a> = 10; // historical
  const unsigned short <a href="#dom-domexception-invalid_state_err" title="dom-DOMException-INVALID_STATE_ERR">INVALID_STATE_ERR</a> = 11;
  const unsigned short <a href="#dom-domexception-syntax_err" title="dom-DOMException-SYNTAX_ERR">SYNTAX_ERR</a> = 12;
  const unsigned short <a href="#dom-domexception-invalid_modification_err" title="dom-DOMException-INVALID_MODIFICATION_ERR">INVALID_MODIFICATION_ERR</a> = 13;
  const unsigned short <a href="#dom-domexception-namespace_err" title="dom-DOMException-NAMESPACE_ERR">NAMESPACE_ERR</a> = 14;
  const unsigned short <a href="#dom-domexception-invalid_access_err" title="dom-DOMException-INVALID_ACCESS_ERR">INVALID_ACCESS_ERR</a> = 15;
  const unsigned short <a href="#dom-domexception-validation_err" title="dom-DOMException-VALIDATION_ERR">VALIDATION_ERR</a> = 16; // historical
  const unsigned short <a href="#dom-domexception-type_mismatch_err" title="dom-DOMException-TYPE_MISMATCH_ERR">TYPE_MISMATCH_ERR</a> = 17;
  const unsigned short <a href="#dom-domexception-security_err" title="dom-DOMException-SECURITY_ERR">SECURITY_ERR</a> = 18;
  const unsigned short <a href="#dom-domexception-network_err" title="dom-DOMException-NETWORK_ERR">NETWORK_ERR</a> = 19;
  const unsigned short <a href="#dom-domexception-abort_err" title="dom-DOMException-ABORT_ERR">ABORT_ERR</a> = 20;
  const unsigned short <a href="#dom-domexception-url_mismatch_err" title="dom-DOMException-URL_MISMATCH_ERR">URL_MISMATCH_ERR</a> = 21;
  const unsigned short <a href="#dom-domexception-quota_exceeded_err" title="dom-DOMException-QUOTA_EXCEEDED_ERR">QUOTA_EXCEEDED_ERR</a> = 22;
  const unsigned short <a href="#dom-domexception-timeout_err" title="dom-DOMException-TIMEOUT_ERR">TIMEOUT_ERR</a> = 23;
  const unsigned short <a href="#dom-domexception-data_clone_err" title="dom-DOMException-DATA_CLONE_ERR">DATA_CLONE_ERR</a> = 25;
  unsigned short <a href="#dom-domexception-code" title="dom-DOMException-code">code</a>;
  DOMString <a href="#dom-domexception-name" title="dom-DOMException-name">name</a>;
};</pre>

<p>The <dfn id="dom-domexception-code" title="dom-DOMException-code"><code>code</code></dfn> exception
field must return the code for the exception, which must be one of the
following:

<ul class="brief">
 <li><dfn id="dom-domexception-index_size_err" title="dom-DOMException-INDEX_SIZE_ERR"><code>INDEX_SIZE_ERR</code></dfn> (1):
 the index is not in the allowed range;
 <li><dfn id="dom-domexception-domstring_size_err" title="dom-DOMException-DOMSTRING_SIZE_ERR"><code>DOMSTRING_SIZE_ERR</code></dfn> (2):
 the text does not fit in a <code class="external"><a href="#domstring">DOMString</a></code>
 (historical);
 <li><dfn id="dom-domexception-hierarchy_request_err" title="dom-DOMException-HIERARCHY_REQUEST_ERR"><code>HIERARCHY_REQUEST_ERR</code></dfn> (3):
 the operation would yield an incorrect nodes model; <!-- XXXhierarchy -->
 <li><dfn id="dom-domexception-wrong_document_err" title="dom-DOMException-WRONG_DOCUMENT_ERR"><code>WRONG_DOCUMENT_ERR</code></dfn> (4):
 the object is in the wrong <code><a href="#document">Document</a></code>, a call to <code title="dom-Document-importNode"><a href="#dom-document-importnode">importNode</a></code> is required;
 <li><dfn id="dom-domexception-invalid_character_err" title="dom-DOMException-INVALID_CHARACTER_ERR"><code>INVALID_CHARACTER_ERR</code></dfn> (5):
 the string contains invalid characters;
 <li><dfn id="dom-domexception-no_data_allowed_err" title="dom-DOMException-NO_DATA_ALLOWED_ERR"><code>NO_DATA_ALLOWED_ERR</code></dfn> (6):
 data is specified for an object that does not support it (historical);
 <li><dfn id="dom-domexception-no_modification_allowed_err" title="dom-DOMException-NO_MODIFICATION_ALLOWED_ERR"><code>NO_MODIFICATION_ALLOWED_ERR</code></dfn> (7):
 the object can not be modified;
 <li><dfn id="dom-domexception-not_found_err" title="dom-DOMException-NOT_FOUND_ERR"><code>NOT_FOUND_ERR</code></dfn> (8):
 the object can not be found here;
 <li><dfn id="dom-domexception-not_supported_err" title="dom-DOMException-NOT_SUPPORTED_ERR"><code>NOT_SUPPORTED_ERR</code></dfn> (9):
 this operation is not supported;
 <li><dfn id="dom-domexception-inuse_attribute_err" title="dom-DOMException-INUSE_ATTRIBUTE_ERR"><code>INUSE_ATTRIBUTE_ERR</code></dfn> (10):
 the attribute is in use (historical)<!--createAttribute-->;
 <li><dfn id="dom-domexception-invalid_state_err" title="dom-DOMException-INVALID_STATE_ERR"><code>INVALID_STATE_ERR</code></dfn> (11):
 the object is in an invalid state;
 <li><dfn id="dom-domexception-syntax_err" title="dom-DOMException-SYNTAX_ERR"><code>SYNTAX_ERR</code></dfn> (12):
 the string did not match the expected pattern;
 <li><dfn id="dom-domexception-invalid_modification_err" title="dom-DOMException-INVALID_MODIFICATION_ERR"><code>INVALID_MODIFICATION_ERR</code></dfn> (13):
 the object can not be modified in this way;
 <li><dfn id="dom-domexception-namespace_err" title="dom-DOMException-NAMESPACE_ERR"><code>NAMESPACE_ERR</code></dfn> (14):
 the operation is not allowed by <cite>Namespaces in XML</cite>; <a href="#refsXMLNS">[XMLNS]</a>
 <li><dfn id="dom-domexception-invalid_access_err" title="dom-DOMException-INVALID_ACCESS_ERR"><code>INVALID_ACCESS_ERR</code></dfn> (15):
 the object does not support the operation or argument;
 <li><dfn id="dom-domexception-validation_err" title="dom-DOMException-VALIDATION_ERR"><code>VALIDATION_ERR</code></dfn> (16):
 the operation is invalid (historical);
 <li><dfn id="dom-domexception-type_mismatch_err" title="dom-DOMException-TYPE_MISMATCH_ERR"><code>TYPE_MISMATCH_ERR</code></dfn> (17):
 the type of the object does not match the expected type;
 <!-- XHR -->
 <li><dfn id="dom-domexception-security_err" title="dom-DOMException-SECURITY_ERR"><code>SECURITY_ERR</code></dfn> (18):
 the operation is insecure;
 <!-- XHR -->
 <li><dfn id="dom-domexception-network_err" title="dom-DOMException-NETWORK_ERR"><code>NETWORK_ERR</code></dfn> (19):
 a network error occurred;
 <!-- XHR -->
 <li><dfn id="dom-domexception-abort_err" title="dom-DOMException-ABORT_ERR"><code>ABORT_ERR</code></dfn> (20):
 the user aborted an operation;
 <!-- Workers -->
 <li><dfn id="dom-domexception-url_mismatch_err" title="dom-DOMException-URL_MISMATCH_ERR"><code>URL_MISMATCH_ERR</code></dfn> (21):
 the given URL does not match another URL;
 <!-- HTML -->
 <li><dfn id="dom-domexception-quota_exceeded_err" title="dom-DOMException-QUOTA_EXCEEDED_ERR"><code>QUOTA_EXCEEDED_ERR</code></dfn> (22):
 the quota has been exceeded;
 <!-- XHR2 -->
 <li><dfn id="dom-domexception-timeout_err" title="dom-DOMException-TIMEOUT_ERR"><code>TIMEOUT_ERR</code></dfn> (23):
 a timeout occurred;
 <!-- HTML -->
 <li><dfn id="dom-domexception-data_clone_err" title="dom-DOMException-DATA_CLONE_ERR"><code>DATA_CLONE_ERR</code></dfn> (25):
 the object can not be cloned;
</ul>

<p>The <dfn id="dom-domexception-name" title="dom-DOMException-name"><code>name</code></dfn> exception
field must return the name of the exception constant as a string.


<h2 id="events"><span class="secno">4 </span>Events</h2>

<p class="XXX">This chapter provides an alternative definition for the
"DOM Event Architecture" and "Basic Event Interfaces" chapters of
DOM Level 3 Events. We would appreciate your input on which approach you
prefer.

<h3 id="interface-event"><span class="secno">4.1 </span>Interface <code><a href="#event">Event</a></code></h3>

<pre class="idl">interface <dfn id="event">Event</dfn> {
  readonly attribute DOMString <a href="#dom-event-type" title="dom-Event-type">type</a>;
  readonly attribute <a href="#eventtarget">EventTarget</a> <a href="#dom-event-target" title="dom-Event-target">target</a>;
  readonly attribute <a href="#eventtarget">EventTarget</a> <a href="#dom-event-currenttarget" title="dom-Event-currentTarget">currentTarget</a>;

  const unsigned short <a href="#dom-event-capturing_phase" title="dom-Event-CAPTURING_PHASE">CAPTURING_PHASE</a> = 1;
  const unsigned short <a href="#dom-event-at_target" title="dom-Event-AT_TARGET">AT_TARGET</a> = 2;
  const unsigned short <a href="#dom-event-bubbling_phase" title="dom-Event-BUBBLING_PHASE">BUBBLING_PHASE</a> = 3;
  readonly attribute unsigned short <a href="#dom-event-eventphase" title="dom-Event-eventPhase">eventPhase</a>;

  void <a href="#dom-event-stoppropagation" title="dom-Event-stopPropagation">stopPropagation</a>();
  void <a href="#dom-event-stopimmediatepropagation" title="dom-Event-stopImmediatePropagation">stopImmediatePropagation</a>();

  readonly attribute boolean <a href="#dom-event-bubbles" title="dom-Event-bubbles">bubbles</a>;
  readonly attribute boolean <a href="#dom-event-cancelable" title="dom-Event-cancelable">cancelable</a>;
  void <a href="#dom-event-preventdefault" title="dom-Event-preventDefault">preventDefault</a>();
  readonly attribute boolean <a href="#dom-event-defaultprevented" title="dom-Event-defaultPrevented">defaultPrevented</a>;

  readonly attribute boolean <a href="#dom-event-istrusted" title="dom-Event-isTrusted">isTrusted</a>;
  readonly attribute DOMTimeStamp <a href="#dom-event-timestamp" title="dom-Event-timeStamp">timeStamp</a>;

  void <a href="#dom-event-initevent" title="dom-Event-initEvent">initEvent</a>(DOMString <var title="">type</var>, boolean <var title="">bubbles</var>, boolean <var title="">cancelable</var>);
};</pre>

<p>An <dfn id="concept-event" title="concept-event">event</dfn> allows for signaling that something has occurred. E.g. that an image has completed downloading.</p>

<p>Each <a href="#concept-event" title="concept-event">event</a> has a <dfn id="concept-event-type" title="concept-event-type">type</dfn> which is initially the empty string. The
<dfn id="dom-event-type" title="dom-Event-type"><code>type</code></dfn> attribute must
return the <a href="#concept-event-type" title="concept-event-type">type</a>.</p>

<p>Each <a href="#concept-event" title="concept-event">event</a> has an associated
<dfn id="concept-event-target" title="concept-event-target">target</dfn> and
<dfn id="concept-event-current-target" title="concept-event-current-target">current target</dfn> which are both
initially null and then set while
<a href="#concept-event-dispatch" title="concept-event-dispatch">dispatching</a> the
<a href="#concept-event" title="concept-event">event</a>. The
<dfn id="dom-event-target" title="dom-Event-target"><code>target</code></dfn> attribute must return
the <a href="#concept-event-target" title="concept-event-target">target</a> and the
<dfn id="dom-event-currenttarget" title="dom-Event-currentTarget"><code>currentTarget</code></dfn>
attribute must return the
<a href="#concept-event-current-target" title="concept-event-current-target">current target</a>.

<p>Each <a href="#concept-event" title="concept-event">event</a> has a
<dfn id="concept-event-phase" title="concept-event-phase">phase</dfn>. The
<dfn id="dom-event-eventphase" title="dom-Event-eventPhase"><code>eventPhase</code></dfn> attribute must
return the current <a href="#concept-event-phase" title="concept-event-phase">phase</a>, which must
be one of the following:</p>
<dl>
 <dt><dfn id="dom-event-capturing_phase" title="dom-Event-CAPTURING_PHASE"><code>CAPTURING_PHASE</code></dfn> (numeric value 1)</dt>
 <dd><p>When an <a href="#concept-event" title="concept-event">event</a> is
 <a href="#concept-event-dispatch" title="concept-event-dispatch">dispatched</a> on an object that
 <a href="#concept-tree-participate" title="concept-tree-participate">participates</a> in a
 <a href="#concept-tree" title="concept-tree">tree</a> it will be in this phase before it
 reaches its <a href="#concept-event-target" title="concept-event-target">target</a>.
 <dt><dfn id="dom-event-at_target" title="dom-Event-AT_TARGET"><code>AT_TARGET</code></dfn> (numeric value 2)
 <dd><p>When an <a href="#concept-event" title="concept-event">event</a> is <a href="#concept-event-dispatch" title="concept-event-dispatch">dispatched</a> it will be in this phase on its <a href="#concept-event-target" title="concept-event-target">target</a>.
 <dt><dfn id="dom-event-bubbling_phase" title="dom-Event-BUBBLING_PHASE"><code>BUBBLING_PHASE</code></dfn> (numeric value 3)
 <dd><p>When an <a href="#concept-event" title="concept-event">event</a> is
 <a href="#concept-event-dispatch" title="concept-event-dispatch">dispatched</a> on an object that
 <a href="#concept-tree-participate" title="concept-tree-participate">participates</a> in a
 <a href="#concept-tree" title="concept-tree">tree</a> it will be in this phase after it
 reaches its <a href="#concept-event-target" title="concept-event-target">target</a>.
</dl>
<p>Initially the <a href="#concept-event-phase" title="concept-event-phase">phase</a> is
<a href="#dom-event-at_target" title="dom-Event-AT_TARGET">AT_TARGET</a>.

<p>Each <a href="#concept-event" title="concept-event">event</a> has the following associated
flags that are all initially unset:</p>
<ul>
 <li><dfn id="stop-propagation-flag">stop propagation flag</dfn>
 <li><dfn id="stop-immediate-propagation-flag">stop immediate propagation flag</dfn>
 <li><dfn id="bubble-flag">bubble flag</dfn>
 <li><dfn id="cancel-flag">cancel flag</dfn>
 <li><dfn id="canceled-flag">canceled flag</dfn>
 <li><dfn id="trusted-flag">trusted flag</dfn>
 <li><dfn id="dispatch-flag">dispatch flag</dfn>
</ul>
<p>When the
<dfn id="dom-event-stoppropagation" title="dom-Event-stopPropagation"><code>stopPropagation()</code></dfn>
method is invoked the <a href="#stop-propagation-flag">stop propagation flag</a> must be set.
<p>When the
<dfn id="dom-event-stopimmediatepropagation" title="dom-Event-stopImmediatePropagation"><code>stopImmediatePropagation()</code></dfn>
method is invoked both the <a href="#stop-propagation-flag">stop propagation flag</a> and
<a href="#stop-immediate-propagation-flag">stop immediate propagation flag</a> must be set.
<p>The <dfn id="dom-event-bubbles" title="dom-Event-bubbles"><code>bubbles</code></dfn> attribute
must return true if the <a href="#bubble-flag">bubble flag</a> is set and false otherwise.
<p>The <dfn id="dom-event-cancelable" title="dom-Event-cancelable"><code>cancelable</code></dfn>
attribute must return true if the <a href="#cancel-flag">cancel flag</a> is set and false
otherwise.
<p>When the
<dfn id="dom-event-preventdefault" title="dom-Event-preventDefault"><code>preventDefault()</code></dfn>
method is invoked and the <a href="#cancel-flag">cancel flag</a> is set, the
<a href="#canceled-flag">canceled flag</a> must be set.
<p>The <dfn id="dom-event-defaultprevented" title="dom-Event-defaultPrevented"><code>defaultPrevented</code></dfn>
attribute must return true if the <a href="#canceled-flag">canceled flag</a> is set and
false otherwise.

<p>The <dfn id="dom-event-istrusted" title="dom-Event-isTrusted"><code>isTrusted</code></dfn> attribute
must return true if the <a href="#trusted-flag">trusted flag</a> is set and false
otherwise.

<p class="XXX">The <dfn id="dom-event-timestamp" title="dom-Event-timeStamp"><code>timeStamp</code></dfn>
attribute ... <a href="http://www.w3.org/2008/webapps/track/issues/172">More information.</a>

<p>When the <dfn id="dom-event-initevent" title="dom-Event-initEvent"><code>initEvent(<var title="">type</var>, <var title="">bubbles</var>, <var title="">cancelable</var>)</code></dfn>
method is invoked these steps must be run:</p>

<ol>
 <li><p>If the <a href="#dispatch-flag">dispatch flag</a> is set, terminate these steps.
 <li><p>Unset the <a href="#stop-propagation-flag">stop propagation flag</a>,
 <a href="#stop-immediate-propagation-flag">stop immediate propagation flag</a>, <a href="#canceled-flag">canceled flag</a>,
 and <a href="#trusted-flag">trusted flag</a>.
 <li><p>Set <a href="#concept-event-target" title="concept-event-target">target</a> to null.
 <li><p>Set <a href="#concept-event-type" title="concept-event-type">type</a> to the
 <var title="">type</var> argument.
 <li><p>If the <var title="">bubbles</var> argument is true, set the
 <a href="#bubble-flag">bubble flag</a>.
 <li><p>If the <var title="">cancelable</var> argument is true, set the
 <a href="#cancel-flag">cancel flag</a>.
</ol>


<h3 id="interface-customevent"><span class="secno">4.2 </span>Interface <code><a href="#customevent">CustomEvent</a></code></h3>

<pre class="idl">interface <dfn id="customevent">CustomEvent</dfn> : <a href="#event">Event</a> {
  readonly attribute object <a href="#dom-customevent-detail" title="dom-CustomEvent-detail">detail</a>;
  void <a href="#dom-customevent-initcustomevent" title="dom-CustomEvent-initCustomEvent">initCustomEvent</a>(DOMString <var title="">type</var>, boolean <var title="">bubbles</var>, boolean <var title="">cancelable</var>, object <var title="">detail</var>);
};</pre>

<p><a href="#concept-event" title="concept-event">Events</a> using the
<code><a href="#customevent">CustomEvent</a></code> interface can be used for synthetic events that
need to carry data.</p>

<p><a href="#concept-event" title="concept-event">Events</a> using the
<code><a href="#customevent">CustomEvent</a></code> interface have an associated
<dfn id="concept-customevent-detail" title="concept-CustomEvent-detail">detail</dfn> variable. The
<dfn id="dom-customevent-detail" title="dom-CustomEvent-detail"><code>detail</code></dfn> attribute must
return <a href="#concept-customevent-detail" title="concept-CustomEvent-detail">detail</a>, if it is set,
and null otherwise.

<p>When the <dfn id="dom-customevent-initcustomevent" title="dom-CustomEvent-initCustomEvent"><code>initCustomEvent(<var title="">type</var>, <var title="">bubbles</var>, <var title="">cancelable</var>, <var title="">detail</var>)</code></dfn>
method is invoked these steps must be run:</p>

<ol>
 <li><p>If the <a href="#dispatch-flag">dispatch flag</a> is set, terminate these steps.
 <li><p>Invoke <code title="dom-Event-initEvent"><a href="#dom-event-initevent">initEvent()</a></code> with the
 first three arguments.</li>
 <li><p>Set <a href="#concept-customevent-detail" title="concept-CustomEvent-detail">detail</a> to the
 <var title="">detail</var> argument.
</ol>


<h3 id="interface-eventtarget"><span class="secno">4.3 </span>Interface <code><a href="#eventtarget">EventTarget</a></code></h3>

<pre class="idl">interface <dfn id="eventtarget">EventTarget</dfn> {
  void <a href="#dom-eventtarget-addeventlistener" title="dom-EventTarget-addEventListener">addEventListener</a>(DOMString <var title="">type</var>, <a href="#eventlistener">EventListener</a> <var title="">listener</var>, optional boolean <var title="">capture</var>);
  void <a href="#dom-eventtarget-removeeventlistener" title="dom-EventTarget-removeEventListener">removeEventListener</a>(DOMString <var title="">type</var>, <a href="#eventlistener">EventListener</a> <var title="">listener</var>, optional boolean <var title="">capture</var>);
  boolean <a href="#dom-eventtarget-dispatchevent" title="dom-EventTarget-dispatchEvent">dispatchEvent</a>(<a href="#event">Event</a> <var title="">event</var>);
};

[Callback] interface <dfn id="eventlistener">EventListener</dfn> {
  void <span title="dom-EventListener-handleEvent">handleEvent</span>(<a href="#event">Event</a> <var title="">event</var>);
};</pre>

<p><code><a href="#eventtarget">EventTarget</a></code> is an object upon which an
<a href="#concept-event" title="concept-event">event</a> is <span>dispatched</span>
when something has occurred. Each <code><a href="#eventtarget">EventTarget</a></code> has an associated
list of <a href="#concept-event-listener" title="concept-event-listener">event listeners</a>.

<p>An <dfn id="concept-event-listener" title="concept-event-listener">event listener</dfn> is a handler
for a specific <a href="#concept-event" title="concept-event">event</a>. Each
<a href="#concept-event-listener" title="concept-event-listener">event listener</a> consists of a
<b>name</b> (of the <a href="#concept-event" title="concept-event">event</a>),
<b>listener</b>, and <b>capture</b> variable.

<p>When the
<dfn id="dom-eventtarget-addeventlistener" title="dom-EventTarget-addEventListener"><code>addEventListener(<var title="">type</var>, <var title="">listener</var>, <var title="">capture</var>)</code></dfn>
method is invoked these steps must be run:
<ol>
 <li><p>If <var title="">listener</var> is null terminate these steps.
 <li><p>If <var title="">capture</var> is omitted let <var title="">capture</var> be false.
 <li><p>Append an <a href="#concept-event-listener" title="concept-event-listener">event listener</a>
 to the associated list of
 <a href="#concept-event-listener" title="concept-event-listener">event listeners</a> with <b>name</b>
 set to <var title="">type</var>, <b>listener</b> set to <var title="">listener</var>, and
 <b>capture</b> set to <var title="">capture</var>, unless there
 already is an <a href="#concept-event-listener" title="concept-event-listener">event listener</a> in
 that list with the same <b>name</b>, <b>listener</b>, and <b>capture</b>.
</ol>

<p>When the <dfn id="dom-eventtarget-removeeventlistener" title="dom-EventTarget-removeEventListener"><code>removeEventListener(<var title="">type</var>, <var title="">listener</var>, <var title="">capture</var>)</code></dfn> method is invoked these steps must be run:
<ol>
 <li><p>If <var title="">capture</var> is omitted let <var title="">capture</var> be false.
 <li><p>Remove an <a href="#concept-event-listener" title="concept-event-listener">event listener</a>
 from the associated list of
 <a href="#concept-event-listener" title="concept-event-listener">event listeners</a>, whose
 <b>name</b> is <var title="">name</var>, <b>listener</b> is <var title="">listener</var>, and
 <b>capture</b> is <var title="">capture</var>.</p>
</ol>

<p>When the
<dfn id="dom-eventtarget-dispatchevent" title="dom-EventTarget-dispatchEvent"><code>dispatchEvent(<var title="">event</var>)</code></dfn> method is invoked these steps must be run:
<ol>
 <li><p>If <var title="">event</var>'s <a href="#dispatch-flag">dispatch flag</a> is set throw
 an <code title="dom-DOMException-INVALID_STATE_ERR"><a href="#dom-domexception-invalid_state_err">INVALID_STATE_ERR</a></code>
 exception and terminate these steps.
 <li><p>Unset <var title="">event</var>'s <a href="#trusted-flag">trusted flag</a>.
 <li><p><a href="#concept-event-dispatch" title="concept-event-dispatch">Dispatch</a> the
 <var title="">event</var> and return the value that returns.
</ol>


<h3 id="creating-events"><span class="secno">4.4 </span>Creating Events</h3>

<p class="note">Although the <code><a href="#document">Document</a></code> object is introduced later
it was thought better to describe its
<code title="dom-Document-createEvent"><a href="#dom-document-createevent">createEvent()</a></code> method here.

<p>When the <dfn id="dom-document-createevent" title="dom-Document-createEvent"><code>createEvent(<var title="">interface</var>)</code></dfn> methed is invoked these steps must be run:

<ol>
 <li>
  <p>If <var title="">interface</var> is an <a href="#ascii-case-insensitive">ASCII case-insensitive</a>
  match for any of the strings in the first column in the following table
  let <var title="">interface</var> be the string in the second column on the same
  row as the matching string:</p>
  <table>
  <thead>
   <tr><th>Input interface <th>Replacement interface
  <tbody>
   <tr><td>"<code title="">htmlevents</code>"<td>"<code title="">event</code>"
   <tr><td>"<code title="">mouseevents</code>"<td>"<code title="">mouseevent</code>"
   <tr><td>"<code title="">mutationevents</code>"<td>"<code title="">mutationevent</code>"
   <tr><td>"<code title="">uievents</code>"<td>"<code title="">uievent</code>"
  </table>
  <!-- XXX WebKit/Gecko (IE?) support "events" -> "event". Add it or make sure it's not supported? -->
 </li>
 <li><p>If <var title="">interface</var> is <em>not</em> an
 <a href="#ascii-case-insensitive">ASCII case-insensitive</a> match for "<code title="">event</code>" or
 for the name of an interface that inherits from the <code><a href="#event">Event</a></code>
 interface and is supported by the user agent, throw a
 <code title="dom-DOMException-NOT_SUPPORTED_ERR"><a href="#dom-domexception-not_supported_err">NOT_SUPPORTED_ERR</a></code> and
 terminate these steps.
 <li><p>Create an <a href="#concept-event" title="concept-event">event</a> implementing the
 interface whose name <var title="">interface</var> is an
 <a href="#ascii-case-insensitive">ASCII case-insensitive</a> match for and return it.
</ol>

<p class="note">Because <code title="dom-Document-createEvent"><a href="#dom-document-createevent">createEvent()</a></code> is located on the <code><a href="#document">Document</a></code> object it cannot be used by Web Workers. Please let us know if this bothers you.


<h3 id="dispatching-events"><span class="secno">4.5 </span>Dispatching Events</h3>

<p>To <dfn id="concept-event-dispatch" title="concept-event-dispatch">dispatch</dfn> an
<a href="#concept-event" title="concept-event">event</a> on a given object run these
steps:</p>
<!-- other specifications turn this into a requirement  -->

<ol>
 <li><p>Let <var title="">event</var> be the
 <a href="#concept-event" title="concept-event">event</a> that is dispatched.
 <li><p>Set <var title="">event</var>'s <a href="#dispatch-flag">dispatch flag</a>.
 <li><p>Set <var title="">event</var>'s
 <a href="#concept-event-target" title="concept-event-target">target</a> to the object on which
 <var title="">event</var> is dispatched.
 <li>
  <dl>
   <dt>If <var title="">event</var>'s
   <a href="#concept-event-target" title="concept-event-target">target</a> is
   <a href="#concept-tree-participate" title="concept-tree-participate">participating</a> in a
   <a href="#concept-tree" title="concept-tree">tree</a>
   <dd>
    <ol>
     <li><p>Let <var title="">event path</var> be a static ordered list of all
     <a href="#concept-tree-ancestor" title="concept-tree-ancestor">ancestors</a> of
     <var title="">event</var>'s <a href="#concept-event-target" title="concept-event-target">target</a>
     in <a href="#tree-order">tree order</a>.</li>
     <li><p>Set <var title="">event</var>'s <a href="#concept-event-phase" title="concept-event-phase">phase</a> to <a href="#dom-event-capturing_phase" title="dom-Event-CAPTURING_PHASE">CAPTURING_PHASE</a>.
     <li><p>For each object in the <var title="">event path</var>
     <a href="#concept-event-listener-invoke" title="concept-event-listener-invoke">invoke</a> its
     <a href="#concept-event-listener" title="concept-event-listener">event listeners</a>, as long as
     <var title="">event</var>'s <a href="#stop-propagation-flag">stop propagation flag</a> is unset.
     <li><p>Set <var title="">event</var>'s <a href="#concept-event-phase" title="concept-event-phase">phase</a> to <a href="#dom-event-at_target" title="dom-Event-AT_TARGET">AT_TARGET</a>.
     <li><p><a href="#concept-event-listener-invoke" title="concept-event-listener-invoke">Invoke</a> the
     <a href="#concept-event-listener" title="concept-event-listener">event listeners</a> of
     <var title="">event</var>'s
     <a href="#concept-event-target" title="concept-event-target">target</a>, if
     <var title="">event</var>'s <a href="#stop-propagation-flag">stop propagation flag</a> is unset.
     <li>
      <p>If <var title="">event</var>'s <a href="#bubble-flag">bubble flag</a> is set run
      these substeps:</p>
      <ol>
       <li><p>Reverse the order of <var title="">event path</var>.
       <li><p>Set <var title="">event</var>'s <a href="#concept-event-phase" title="concept-event-phase">phase</a> to <a href="#dom-event-bubbling_phase" title="dom-Event-BUBBLING_PHASE">BUBBLING_PHASE</a>.
       <li><p>For each object in the <var title="">event path</var>
       <a href="#concept-event-listener-invoke" title="concept-event-listener-invoke">invoke</a> its
       <a href="#concept-event-listener" title="concept-event-listener">event listeners</a>, as long as
       <var title="">event</var>'s <a href="#stop-propagation-flag">stop propagation flag</a> is unset.
      </ol>
    </ol>
   </dd>
   <dt>Otherwise
   <dd><p><a href="#concept-event-listener-invoke" title="concept-event-listener-invoke">Invoke</a> the
   <a href="#concept-event-listener" title="concept-event-listener">event listeners</a> of
   <var title="">event</var>'s <a href="#concept-event-target" title="concept-event-target">target</a>.
  </dl>
  <!-- XXX This could be flattened by just letting "event path" be empty for
           objects not participating in a tree. -->
 </li>
 <li><p>Unset <var title="">event</var>'s <a href="#dispatch-flag">dispatch flag</a>.
 <li><p>Set <var title="">event</var>'s <a href="#concept-event-phase" title="concept-event-phase">phase</a> to <a href="#dom-event-at_target" title="dom-Event-AT_TARGET">AT_TARGET</a>.
 <li><p>Set <var title="">event</var>'s <a href="#concept-event-current-target" title="concept-event-current-target">current target</a> to null.
 <li><p>Return false if <var title="">event</var>'s <a href="#canceled-flag">canceled flag</a>
 is set and true otherwise.
</ol>


<p>To <dfn id="concept-event-listener-invoke" title="concept-event-listener-invoke">invoke</dfn> the <a href="#concept-event-listener" title="concept-event-listener">event listeners</a> for an object run these steps:</p>
<ol>
 <li><p>Let <var title="">event</var> be the <a href="#concept-event" title="concept-event">event</a>
 for which the <a href="#concept-event-listener" title="concept-event-listener">event listeners</a> are
 invoked.
 <li><p>Let <var title="">listeners</var> be a static list of the
 <a href="#concept-event-listener" title="concept-event-listener">event listeners</a> associated with
 the object for which these steps are run.
 <li><p>Set <var title="">event</var>'s
 <a href="#concept-event-current-target" title="concept-event-current-target">current target</a> to the
 object for which these steps are run.
 <li>
  <p>Then run these substeps for each
  <a href="#concept-event-listener" title="concept-event-listener">event listener</a> in
  <var title="">listeners</var>:</p>
  <ol>
   <li><p>If <var title="">event</var>'s
   <a href="#stop-immediate-propagation-flag">stop immediate propagation flag</a> is set, terminate the
   <a href="#concept-event-listener-invoke" title="concept-event-listener-invoke">invoke</a> algorithm.
   <li><p>Let <var title="">listener</var> be the
   <a href="#concept-event-listener" title="concept-event-listener">event listener</a>.
   <li><p>If <var title="">event</var>'s
   <a href="#concept-event-type" title="concept-event-type">type</a> is not
   <var title="">listener</var>'s <b>name</b>, terminate these substeps (and
   run them for the next
   <a href="#concept-event-listener" title="concept-event-listener">event listener</a>).
   <li><p>If <var title="">event</var>'s
   <a href="#concept-event-phase" title="concept-event-phase">phase</a> is
   <a href="#dom-event-capturing_phase" title="dom-Event-CAPTURING_PHASE">CAPTURING_PHASE</a> and
   <var title="">listener</var>'s <b>capture</b> is false, terminate these
   substeps (and run them for the next
   <a href="#concept-event-listener" title="concept-event-listener">event listener</a>).
   <li><p>If <var title="">event</var>'s
   <a href="#concept-event-phase" title="concept-event-phase">phase</a> is
   <a href="#dom-event-bubbling_phase" title="dom-Event-BUBBLING_PHASE">BUBBLING_PHASE</a> and
   <var title="">listener</var>'s <b>capture</b> is true, terminate these
   substeps (and run them for the next
   <a href="#concept-event-listener" title="concept-event-listener">event listener</a>).
   <li><p>Run <var title="">listener</var>'s <b>listener</b>.
  </ol>
 </li>
</ol>


<h3 id="firing-events"><span class="secno">4.6 </span>Firing Events</h3>
<p>To
<dfn id="concept-event-fire" title="concept-event-fire">fire an event named <var title="">e</var></dfn>
means that an <a href="#concept-event" title="concept-event">event</a> using the
<code><a href="#event">Event</a></code> interface, with its
<a href="#concept-event-type" title="concept-event-type">type</a> set to <var title="">e</var>, and
its <a href="#trusted-flag">trusted flag</a> set, is to be
<a href="#concept-event-dispatch" title="concept-event-dispatch">dispatched</a> at the indicated
object.</p>

<p class="note">Fire is short for initializing and
<a href="#concept-event-dispatch" title="concept-event-dispatch">dispatching</a> an
<a href="#concept-event" title="concept-event">event</a>.

<p class="note"><a href="#concept-event-fire" title="concept-event-fire">Fire an event</a> is a
concept to make initializing and
<a href="#concept-event-dispatch" title="concept-event-dispatch">dispatching</a> an
<a href="#concept-event" title="concept-event">event</a> easier to write down. If the
<a href="#concept-event" title="concept-event">event</a> needs its <a href="#bubble-flag">bubble flag</a> or
<a href="#cancel-flag">cancel flag</a> set, one would write e.g.
"<a href="#concept-event-fire" title="concept-event-fire">fire an event</a> named
<code title="">submit</code> with its <a href="#cancel-flag">cancel flag</a> set".



<h2 id="nodes"><span class="secno">5 </span>Nodes</h2>
<h3 id="nodes-model"><span class="secno">5.1 </span>Nodes Model</h3>

<p><code><a href="#node">Node</a></code> objects (simply called
<dfn id="concept-node" title="concept-node">nodes</dfn>)
<a href="#concept-tree-participate" title="concept-tree-participate">participate</a> in a
<a href="#concept-tree" title="concept-tree">tree</a>.

<p>The <a href="#concept-tree" title="concept-tree">tree</a> of
<a href="#concept-node" title="concept-node">nodes</a> is constrained as follows, expressed
as a relationship between the type of <a href="#concept-node" title="concept-node">node</a>
and its allowed <a href="#concept-tree-child" title="concept-tree-child">children</a>:
<dl>
 <dt><code><a href="#document">Document</a></code>
 <dd>
  <p>In <a href="#tree-order">tree order</a>:
  <ol>
   <li><p>Zero or more nodes each of which is either
   <code><a href="#processinginstruction">ProcessingInstruction</a></code> or <code><a href="#comment">Comment</a></code>.
   <li><p>Optionally one <code><a href="#documenttype">DocumentType</a></code> node.
   <li><p>Zero or more nodes each of which is either
   <code><a href="#processinginstruction">ProcessingInstruction</a></code> or <code><a href="#comment">Comment</a></code>.
   <li><p>Optionally one <code><a href="#element">Element</a></code> node.
   <li><p>Zero or more nodes each of which is either
   <code><a href="#processinginstruction">ProcessingInstruction</a></code> or <code><a href="#comment">Comment</a></code>.
  </ol>
 <dt><code><a href="#documentfragment">DocumentFragment</a></code>
 <dt><code><a href="#element">Element</a></code>
 <dd><p>Zero or more nodes each of which is one of <code><a href="#element">Element</a></code>,
 <code><a href="#processinginstruction">ProcessingInstruction</a></code>, <code><a href="#comment">Comment</a></code>, or
 <code><a href="#text">Text</a></code>.
 <dt><code><a href="#documenttype">DocumentType</a></code>
 <dt><code><a href="#processinginstruction">ProcessingInstruction</a></code>
 <dt><code><a href="#comment">Comment</a></code>
 <dt><code><a href="#text">Text</a></code>
 <dd><p>None.
</dl>

<p>A <a href="#concept-node" title="concept-node">node</a>, or its
<a href="#concept-tree-child" title="concept-tree-child">children</a> in case of a
<code><a href="#documentfragment">DocumentFragment</a></code> object, are said to
<dfn id="violate-the-node-hierarchy">violate the node hierarchy</dfn> of another
<a href="#concept-node" title="concept-node">node</a> if inserting them within the other
<a href="#concept-node" title="concept-node">node</a>'s <a href="#concept-tree" title="concept-tree">tree</a>
would violate the constraints listed above.

<p class="note">Operations that would cause a node to <a href="#violate-the-node-hierarchy">violate the node hierarchy</a> of another node will throw a <code title="dom-DOMException-HIERARCHY_REQUEST_ERR"><a href="#dom-domexception-hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code>.

<!--AttrExodus -->

<!-- XXXhierarchy - make sure to expand DocumentFragment before checking -->


<h3 id="cloning-nodes"><span class="secno">5.2 </span>Cloning nodes</h3>
<p>To <dfn id="clone">clone</dfn> a <var title="">node</var>, with a
<var title="">new ownerDocument</var> and with a
<dfn id="clone-children-flag"><i>clone children flag</i></dfn>, these steps must be run:

<ol>
 <li><p>If <var title="">node</var> is a <code><a href="#document">Document</a></code> or
 <code><a href="#documenttype">DocumentType</a></code> node, throw a
 <code title="dom-DOMException-DATA_CLONE_ERR"><a href="#dom-domexception-data_clone_err">DATA_CLONE_ERR</a></code> exception
 and terminate these steps. <!--XXX wrong? -->
 <li>
  <p>Let <var title="">copy</var> be a new <code><a href="#node">Node</a></code> that implements the same interfaces as <var title="">node</var>, with <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to
  <var title="">new ownerDocument</var>. Also copy the following, depending on the
  <var title="">node</var>:
  <dl class="switch">
   <dt><code><a href="#element">Element</a></code>
   <dd><p>Its <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a>,
   <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a>,
   <a href="#concept-element-local-name" title="concept-element-local-name">local name</a>, and its
   associated collection of <code><a href="#attr">Attr</a></code> objects.

   <!--AttrExodus
   <dt><code>Attr</code>
   <dd><p><code title=dom-Attr-value>value</code>
   -->

   <dt><code><a href="#text">Text</a></code>
   <dt><code><a href="#comment">Comment</a></code>
   <dd><p>Its <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code>.

   <dt><code><a href="#processinginstruction">ProcessingInstruction</a></code>

   <dd><p>Its <a href="#concept-pi-target" title="concept-PI-target">target</a> and
   <a href="#concept-pi-data" title="concept-PI-data">data</a>.

   <dt>Any other node
   <dd><p>&mdash;
  </dl>
 <li><p>If the <i><a href="#clone-children-flag">clone children flag</a></i> is set, <a href="#clone">clone</a> all the children of <var title="">node</var> and append them to <var title="">copy</var>, with the same <var title="">new ownerDocument</var> and the <i><a href="#clone-children-flag">clone children flag</a></i> being set.
 <li><p>Return <var title="">copy</var>.
</ol>


<h3 id="interface-node"><span class="secno">5.3 </span>Interface <code><a href="#node">Node</a></code></h3>
<pre class="idl">interface <dfn id="node">Node</dfn> : <a href="#eventtarget">EventTarget</a> {
  const unsigned short <a href="#dom-node-element_node" title="dom-Node-ELEMENT_NODE">ELEMENT_NODE</a> = 1;
  const unsigned short <a href="#dom-node-attribute_node" title="dom-Node-ATTRIBUTE_NODE">ATTRIBUTE_NODE</a> = 2; // historical
  const unsigned short <a href="#dom-node-text_node" title="dom-Node-TEXT_NODE">TEXT_NODE</a> = 3;
  const unsigned short <a href="#dom-node-cdata_section_node" title="dom-Node-CDATA_SECTION_NODE">CDATA_SECTION_NODE</a> = 4; // historical
  const unsigned short <a href="#dom-node-entity_reference_node" title="dom-Node-ENTITY_REFERENCE_NODE">ENTITY_REFERENCE_NODE</a> = 5; // historical
  const unsigned short <a href="#dom-node-entity_node" title="dom-Node-ENTITY_NODE">ENTITY_NODE</a> = 6; // historical
  const unsigned short <a href="#dom-node-processing_instruction_node" title="dom-Node-PROCESSING_INSTRUCTION_NODE">PROCESSING_INSTRUCTION_NODE</a> = 7;
  const unsigned short <a href="#dom-node-comment_node" title="dom-Node-COMMENT_NODE">COMMENT_NODE</a> = 8;
  const unsigned short <a href="#dom-node-document_node" title="dom-Node-DOCUMENT_NODE">DOCUMENT_NODE</a> = 9;
  const unsigned short <a href="#dom-node-document_type_node" title="dom-Node-DOCUMENT_TYPE_NODE">DOCUMENT_TYPE_NODE</a> = 10;
  const unsigned short <a href="#dom-node-document_fragment_node" title="dom-Node-DOCUMENT_FRAGMENT_NODE">DOCUMENT_FRAGMENT_NODE</a> = 11;
  const unsigned short <a href="#dom-node-notation_node" title="dom-Node-NOTATION_NODE">NOTATION_NODE</a> = 12; // historical
  readonly attribute unsigned short <a href="#dom-node-nodetype" title="dom-Node-nodeType">nodeType</a>;<!-- NodeExodus

  readonly attribute DOMString <span title=dom-Node-namespaceURI>namespaceURI</span>;
  readonly attribute DOMString <span title=dom-Node-prefix>prefix</span>;
  readonly attribute DOMString <span title=dom-Node-localName>localName</span>;-->
  readonly attribute DOMString <a href="#dom-node-nodename" title="dom-Node-nodeName">nodeName</a>;

  readonly attribute DOMString <a href="#dom-node-baseuri" title="dom-Node-baseURI">baseURI</a>;

  <!--AttrExodus
  boolean <span title=dom-Node-hasAttributes>hasAttributes</span>();
  readonly attribute <span>NamedNodeMap</span> <span title=dom-Node-attributes>attributes</span>;

  -->readonly attribute <a href="#document">Document</a> <a href="#dom-node-ownerdocument" title="dom-Node-ownerDocument">ownerDocument</a>;
  readonly attribute <a href="#node">Node</a> <a href="#dom-node-parentnode" title="dom-Node-parentNode">parentNode</a>;
  readonly attribute <a href="#element">Element</a> <a href="#dom-node-parentelement" title="dom-Node-parentElement">parentElement</a>;
  boolean <a href="#dom-node-haschildnodes" title="dom-Node-hasChildNodes">hasChildNodes</a>();
  readonly attribute <a href="#nodelist">NodeList</a> <a href="#dom-node-childnodes" title="dom-Node-childNodes">childNodes</a>;
  readonly attribute <a href="#node">Node</a> <a href="#dom-node-firstchild" title="dom-Node-firstChild">firstChild</a>;
  readonly attribute <a href="#node">Node</a> <a href="#dom-node-lastchild" title="dom-Node-lastChild">lastChild</a>;
  readonly attribute <a href="#node">Node</a> <a href="#dom-node-previoussibling" title="dom-Node-previousSibling">previousSibling</a>;
  readonly attribute <a href="#node">Node</a> <a href="#dom-node-nextsibling" title="dom-Node-nextSibling">nextSibling</a>;

  const unsigned short <a href="#dom-node-document_position_disconnected" title="dom-Node-DOCUMENT_POSITION_DISCONNECTED">DOCUMENT_POSITION_DISCONNECTED</a> = 0x01;
  const unsigned short <a href="#dom-node-document_position_preceding" title="dom-Node-DOCUMENT_POSITION_PRECEDING">DOCUMENT_POSITION_PRECEDING</a> = 0x02;
  const unsigned short <a href="#dom-node-document_position_following" title="dom-Node-DOCUMENT_POSITION_FOLLOWING">DOCUMENT_POSITION_FOLLOWING</a> = 0x04;
  const unsigned short <a href="#dom-node-document_position_contains" title="dom-Node-DOCUMENT_POSITION_CONTAINS">DOCUMENT_POSITION_CONTAINS</a> = 0x08;
  const unsigned short <a href="#dom-node-document_position_contained_by" title="dom-Node-DOCUMENT_POSITION_CONTAINED_BY">DOCUMENT_POSITION_CONTAINED_BY</a> = 0x10;
  const unsigned short <a href="#dom-node-document_position_implementation_specific" title="dom-Node-DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC">DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</a> = 0x20;
  unsigned short <a href="#dom-node-comparedocumentposition" title="dom-Node-compareDocumentPosition">compareDocumentPosition</a>(<a href="#node">Node</a> <var title="">other</var>);

           attribute DOMString <a href="#dom-node-nodevalue" title="dom-Node-nodeValue">nodeValue</a>;
           attribute DOMString <a href="#dom-node-textcontent" title="dom-Node-textContent">textContent</a>;
  <a href="#node">Node</a> <a href="#dom-node-insertbefore" title="dom-Node-insertBefore">insertBefore</a>([NoNull] <a href="#node">Node</a> <var title="">newChild</var>, <a href="#node">Node</a> <var title="">refChild</var>);
  <a href="#node">Node</a> <a href="#dom-node-replacechild" title="dom-Node-replaceChild">replaceChild</a>([NoNull] <a href="#node">Node</a> <var title="">newChild</var>, [NoNull] <a href="#node">Node</a> <var title="">oldChild</var>);
  <a href="#node">Node</a> <a href="#dom-node-removechild" title="dom-Node-removeChild">removeChild</a>([NoNull] <a href="#node">Node</a> <var title="">oldChild</var>);
  <a href="#node">Node</a> <a href="#dom-node-appendchild" title="dom-Node-appendChild">appendChild</a>([NoNull] <a href="#node">Node</a> <var title="">newChild</var>);<!--
  void normalize();-->

  <a href="#node">Node</a> <a href="#dom-node-clonenode" title="dom-Node-cloneNode">cloneNode</a>(boolean <var title="">deep</var>);
  boolean <a href="#dom-node-issamenode" title="dom-Node-isSameNode">isSameNode</a>(<a href="#node">Node</a> <var title="">node</var>);
  boolean <a href="#dom-node-isequalnode" title="dom-Node-isEqualNode">isEqualNode</a>(<a href="#node">Node</a> <var title="">node</var>);

  DOMString <a href="#dom-node-lookupprefix" title="dom-Node-lookupPrefix">lookupPrefix</a>([TreatNullAs=EmptyString] DOMString <var title="">namespace</var>);
  DOMString <a href="#dom-node-lookupnamespaceuri" title="dom-Node-lookupNamespaceURI">lookupNamespaceURI</a>(DOMString? <var title="">prefix</var>);
  boolean <a href="#dom-node-isdefaultnamespace" title="dom-Node-isDefaultNamespace">isDefaultNamespace</a>([TreatNullAs=EmptyString] DOMString <var title="">namespace</var>);<!--
  DOMObject getFeature(DOMString feature, DOMString version);
  DOMUserData setUserData(DOMString key, DOMUserData data, UserDataHandler handler);
  DOMUserData getUserData(DOMString key);-->
};</pre>

<p>The <dfn id="dom-node-nodetype" title="dom-Node-nodeType"><code>nodeType</code></dfn> attribute
must return the type of the node, which must be one of the following:

<ul>
 <li><dfn id="dom-node-element_node" title="dom-Node-ELEMENT_NODE"><code>ELEMENT_NODE</code></dfn> (1);

 <li><dfn id="dom-node-attribute_node" title="dom-Node-ATTRIBUTE_NODE"><code>ATTRIBUTE_NODE</code></dfn> (2, historical);

 <li><dfn id="dom-node-text_node" title="dom-Node-TEXT_NODE"><code>TEXT_NODE</code></dfn> (3);

 <li><dfn id="dom-node-cdata_section_node" title="dom-Node-CDATA_SECTION_NODE"><code>CDATA_SECTION_NODE</code></dfn> (4, historical);

 <li><dfn id="dom-node-entity_reference_node" title="dom-Node-ENTITY_REFERENCE_NODE"><code>ENTITY_REFERENCE_NODE</code></dfn> (5, historical);

 <li><dfn id="dom-node-entity_node" title="dom-Node-ENTITY_NODE"><code>ENTITY_NODE</code></dfn> (6, historical);

 <li><dfn id="dom-node-processing_instruction_node" title="dom-Node-PROCESSING_INSTRUCTION_NODE"><code>PROCESSING_INSTRUCTION_NODE</code></dfn> (7);

 <li><dfn id="dom-node-comment_node" title="dom-Node-COMMENT_NODE"><code>COMMENT_NODE</code></dfn> (8);

 <li><dfn id="dom-node-document_node" title="dom-Node-DOCUMENT_NODE"><code>DOCUMENT_NODE</code></dfn> (9);

 <li><dfn id="dom-node-document_type_node" title="dom-Node-DOCUMENT_TYPE_NODE"><code>DOCUMENT_TYPE_NODE</code></dfn> (10);

 <li><dfn id="dom-node-document_fragment_node" title="dom-Node-DOCUMENT_FRAGMENT_NODE"><code>DOCUMENT_FRAGMENT_NODE</code></dfn> (11);

 <li><dfn id="dom-node-notation_node" title="dom-Node-NOTATION_NODE"><code>NOTATION_NODE</code></dfn> (12, historical).
</ul>

<p class="note">The constants marked historical can no longer be returned, but
are still exposed on the interface.

<!-- NodeExodus
<hr>

<p>The <dfn title=dom-Node-namespaceURI><code>namespaceURI</code></dfn> attribute must return the namespace that is associated with the node, if there is one and it's not the empty string, or null otherwise.

<p>The <dfn title=dom-Node-prefix><code>prefix</code></dfn> attribute must return the prefix that is associated with the node, if there is one and it's not the empty string, or null otherwise.
<!- - support setting? - - On setting, it must run the following steps:

<ol>
 <li><p>Let <var title>prefix</var> be the value being assigned.
 <li>
  <p>If <var title>prefix</var> is not null, run the following substeps:
  <ol>
   <li><p>If <var title>prefix</var> does not match the
   <code data-anolis-spec=xml>Name</code> production in XML, throw an
   <code title=dom-DOMException-INVALID_CHARACTER_ERR>INVALID_CHARACTER_ERR</code>
   exception and terminate these steps.
   <li><p>If <var title>prefix</var> does not match the <code
   data-anolis-spec=xmlns>NCName</code> production in Namespaces in XML, throw a
   <code title=dom-DOMException-NAMESPACE_ERR>NAMESPACE_ERR</code> exception and
   terminate these steps.
  </ol>
 <li><p>Actually this does not match any browser. Let's try to drop it instead.
</ol>- ->

<p>The <dfn title=dom-Node-localName><code>localName</code></dfn> attribute
must return the local name that is associated with the node, if it has one,
and null otherwise.-->

<p>The <dfn id="dom-node-nodename" title="dom-Node-nodeName"><code>nodeName</code></dfn> attribute
must return the following, depending on the <a href="#context-object">context object</a>:

<dl class="switch">
 <dt><code><a href="#element">Element</a></code>
 <dd><p>The <a href="#context-object">context object</a>'s
 <code title="dom-Element-tagName"><a href="#dom-element-tagname">tagName</a></code> attribute.

 <!--AttrExodus
 <dt><code>Attr</code>
 <dd><p>The <span>context object</span>'s
 <code title=dom-Attr-name>name</code> attribute.
 -->

 <dt><code><a href="#text">Text</a></code>
 <dd><p>"<code title="">#text</code>".

 <dt><code><a href="#processinginstruction">ProcessingInstruction</a></code>
 <dd><p>The <a href="#context-object">context object</a>'s
 <code title="dom-ProcessingInstruction-target"><a href="#dom-processinginstruction-target">target</a></code> attribute.

 <dt><code><a href="#comment">Comment</a></code>
 <dd><p>"<code title="">#comment</code>".

 <dt><code><a href="#document">Document</a></code>
 <dd><p>"<code title="">#document</code>".

 <dt><code><a href="#documenttype">DocumentType</a></code>
 <dd><p>The <a href="#context-object">context object</a>'s
 <code title="dom-DocumentType-name"><a href="#dom-documenttype-name">name</a></code> attribute.

 <dt><code><a href="#documentfragment">DocumentFragment</a></code>
 <dd><p>"<code title="">#document-fragment</code>".
</dl>

<hr>

<p>The <dfn id="dom-node-baseuri" title="dom-Node-baseURI"><code>baseURI</code></dfn> attribute must <span class="XXX" title="">...</span>

<!--AttrExodus
<hr>

<p>The <dfn title=dom-Node-hasAttributes><code>hasAttributes()</code></dfn>
method must return true if there are any attributes associated with the
<span>context object</span>, if it is an <code>Element</code> node, and false
otherwise.

<p>The <dfn title=dom-Node-attributes><code>attributes</code></dfn> attribute must return a <code>NamedNodeMap</code> of all the <code>Attr</code> nodes associated with the node of the <span>context object</span>, if it is an <code>Element</code> node, or null otherwise.
-->

<hr>

<p>The <dfn id="dom-node-ownerdocument" title="dom-Node-ownerDocument"><code>ownerDocument</code></dfn> attribute must return the <code><a href="#document">Document</a></code> node that the <a href="#context-object">context object</a> is associated with, or null if there is none.

<p>The <dfn id="dom-node-parentnode" title="dom-Node-parentNode"><code>parentNode</code></dfn>
attribute must return the <a href="#concept-tree-parent" title="concept-tree-parent">parent</a>.
<!-- AttrExodus
<li><p>If the <span>context object</span> is an <code>Attr</code> node,
return null and terminate these steps.
-->

<!-- XXX needed? Minefield does not have this -->
<p>The <dfn id="dom-node-parentelement" title="dom-Node-parentElement"><code>parentElement</code></dfn>
attribute must return the <a href="#parent-element">parent element</a>.

<p>The <dfn id="dom-node-haschildnodes" title="dom-Node-hasChildNodes"><code>hasChildNodes()</code></dfn>
method must return false if the <a href="#context-object">context object</a> has no
<a href="#concept-tree-child" title="concept-tree-child">children</a>, or true otherwise.

<p>The <dfn id="dom-node-childnodes" title="dom-Node-childNodes"><code>childNodes</code></dfn>
attribute must return a <code><a href="#nodelist">NodeList</a></code> rooted at the
<a href="#context-object">context object</a> matching only
<a href="#concept-tree-child" title="concept-tree-child">children</a>.

<p>The <dfn id="dom-node-firstchild" title="dom-Node-firstChild"><code>firstChild</code></dfn> attribute must return the first <a href="#concept-tree-child" title="concept-tree-child">child</a>
of the <a href="#context-object">context object</a>, or null if there is none.

<p>The <dfn id="dom-node-lastchild" title="dom-Node-lastChild"><code>lastChild</code></dfn> attribute must return the last <a href="#concept-tree-child" title="concept-tree-child">child</a> of the
<a href="#context-object">context object</a>, or null if there is none.

<p>The
<dfn id="dom-node-previoussibling" title="dom-Node-previousSibling"><code>previousSibling</code></dfn>
attribute must return the first
<span title="concept-tree-previous-sibling">previous sibling</span> of the
<a href="#context-object">context object</a>, or null if there is none.
<!-- AttrExodus
 <li><p>If the <span>context object</span> is an <code>Attr</code> node,
 return null and terminate these steps.
-->

<p>The <dfn id="dom-node-nextsibling" title="dom-Node-nextSibling"><code>nextSibling</code></dfn> attribute must return the  first
<span title="concept-tree-next-sibling">next sibling</span> of the
<a href="#context-object">context object</a>, or null if there is none.
<!-- AttrExodus
 <li><p>If the <span>context object</span> is an <code>Attr</code> node,
 return null and terminate these steps.
-->

<hr>

<p>These are the constants
<code title="dom-Node-compareDocumentPosition"><a href="#dom-node-comparedocumentposition">compareDocumentPosition()</a></code>
returns.

<ul>
 <li><dfn id="dom-node-document_position_disconnected" title="dom-Node-DOCUMENT_POSITION_DISCONNECTED"><code>DOCUMENT_POSITION_DISCONNECTED</code></dfn> (1);

 <li><dfn id="dom-node-document_position_preceding" title="dom-Node-DOCUMENT_POSITION_PRECEDING"><code>DOCUMENT_POSITION_PRECEDING</code></dfn> (2);

 <li><dfn id="dom-node-document_position_following" title="dom-Node-DOCUMENT_POSITION_FOLLOWING"><code>DOCUMENT_POSITION_FOLLOWING</code></dfn> (4);

 <li><dfn id="dom-node-document_position_contains" title="dom-Node-DOCUMENT_POSITION_CONTAINS"><code>DOCUMENT_POSITION_CONTAINS</code></dfn> (8);

 <li><dfn id="dom-node-document_position_contained_by" title="dom-Node-DOCUMENT_POSITION_CONTAINED_BY"><code>DOCUMENT_POSITION_CONTAINED_BY</code></dfn> (16);

 <li><dfn id="dom-node-document_position_implementation_specific" title="dom-Node-DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC"><code>DOCUMENT_POSITION_IMPLEMENTATION_SPECIFIC</code></dfn> (32).
</ul>

<p>The <dfn id="dom-node-comparedocumentposition" title="dom-Node-compareDocumentPosition"><code>compareDocumentPosition(<var title="">other</var>)</code></dfn> method must <span class="XXX" title="">...</span>
<!-- XXX @beverloo might figure this out; remove impl specific? -->

<hr>

<p>The <dfn id="dom-node-nodevalue" title="dom-Node-nodeValue"><code>nodeValue</code></dfn> attribute
must return the following, depending on the <a href="#context-object">context object</a>:

<dl class="switch">
 <!--AttrExodus <dt><code>Attr</code> -->
 <dt><code><a href="#text">Text</a></code>
 <dt><code><a href="#comment">Comment</a></code>
 <dt><code><a href="#processinginstruction">ProcessingInstruction</a></code>
 <dd><p>The <a href="#context-object">context object</a>'s
 <code title="dom-Node-textContent"><a href="#dom-node-textcontent">textContent</a></code> attribute.

 <dt>Any other node
 <dd><p>Null.
</dl>

<p>Setting the <code title="dom-Node-nodeValue"><a href="#dom-node-nodevalue">nodeValue</a></code> attribute
must do as described below, depending on the <a href="#context-object">context object</a>:

<dl class="switch">
 <!--AttrExodus <dt><code>Attr</code> -->
 <dt><code><a href="#text">Text</a></code>
 <dt><code><a href="#comment">Comment</a></code>
 <dt><code><a href="#processinginstruction">ProcessingInstruction</a></code>
 <dd><p>Set the <a href="#context-object">context object</a>'s
 <code title="dom-Node-textContent"><a href="#dom-node-textcontent">textContent</a></code> attribute to the given
 value.

 <dt>Any other node
 <dd><p>Do nothing.
</dl>

<p>The <dfn id="dom-node-textcontent" title="dom-Node-textContent"><code>textContent</code></dfn>
attribute must return the following, depending on the
<a href="#context-object">context object</a>:

<dl class="switch">
 <dt><code><a href="#documentfragment">DocumentFragment</a></code>
 <dt><code><a href="#element">Element</a></code>
 <!--AttrExodus <dt><code>Attr</code> -->
 <dd><p>The concatenation of the
 <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> attributes of all the
 <code><a href="#text">Text</a></code> object
 <a href="#concept-tree-descendant" title="concept-tree-descendant">descendants</a> of the
 <a href="#context-object">context object</a>, in <a href="#tree-order">tree order</a>.

 <dt><code><a href="#text">Text</a></code>
 <dt><code><a href="#comment">Comment</a></code>
 <dd><p>The <a href="#context-object">context object</a>'s
 <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> attribute.

 <dt><code><a href="#processinginstruction">ProcessingInstruction</a></code>
 <dd><p>The <a href="#context-object">context object</a>'s
 <code title="dom-ProcessingInstruction-data"><a href="#dom-processinginstruction-data">data</a></code> attribute.

 <dt>Any other node
 <dd>Null.
</dl>

<p>Setting the <code title="dom-Node-textContent"><a href="#dom-node-textcontent">textContent</a></code>
attribute must do as described below, depending on the
<a href="#context-object">context object</a>:

<dl class="switch">
 <dt><code><a href="#documentfragment">DocumentFragment</a></code>
 <dt><code><a href="#element">Element</a></code>
 <!--AttrExodus <dt><code>Attr</code> -->
 <dd>
  <ol>
   <li><p>Remove all the
   <a href="#concept-tree-descendant" title="concept-tree-descendant">descendants</a> of the <a href="#context-object">context object</a>.
   <li><p>Let <var title="">data</var> be the given value.
   <li><p>If <var title="">data</var> is not the empty string, append a new
   <code><a href="#text">Text</a></code> node to the <a href="#context-object">context object</a> whose
   <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> is set to <var title="">data</var>.
  </ol>

 <dt><code><a href="#text">Text</a></code>
 <dt><code><a href="#comment">Comment</a></code>
 <dd><p>Set <a href="#context-object">context object</a>'s
 <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> attribute to the given
 value.

 <dt><code><a href="#processinginstruction">ProcessingInstruction</a></code>
 <dd><p>Set the <a href="#context-object">context object</a>'s
 <code title="dom-ProcessingInstruction-data"><a href="#dom-processinginstruction-data">data</a></code> attribute to the
 given value.

 <dt>Any other node
 <dd>Do nothing.
</dl>

<p>The
<dfn id="dom-node-insertbefore" title="dom-Node-insertBefore"><code>insertBefore(<var title="">newChild</var>, <var title="">refChild</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If the <a href="#context-object">context object</a> is not a <code><a href="#document">Document</a></code>,
 <code><a href="#documentfragment">DocumentFragment</a></code> or <code><a href="#element">Element</a></code>, throw a
 <code title="dom-DOMException-HIERARCHY_REQUEST_ERR"><a href="#dom-domexception-hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code>
 and terminate these steps.

 <li><p>If <var title="">refChild</var> is null, return the result of invoking
 <a href="#context-object">context object</a>'s
 <code title="dom-Node-appendChild"><a href="#dom-node-appendchild">appendChild</a></code> with
 <var title="">newChild</var> as argument and terminate these steps.

 <li><p>If <var title="">refChild</var> is not a child of the
 <a href="#context-object">context object</a>, then throw a
 <code title="dom-DOMException-NOT_FOUND_ERR"><a href="#dom-domexception-not_found_err">NOT_FOUND_ERR</a></code> exception
 and terminate these steps.

 <li><p>If <var title="">newChild</var> is the <a href="#context-object">context object</a> or an
 <a href="#concept-tree-ancestor" title="concept-tree-ancestor">ancestor</a> of the
 <a href="#context-object">context object</a> throw a
 <code title="dom-DOMException-HIERARCHY_REQUEST_ERR"><a href="#dom-domexception-hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code>
 and terminate these steps.

 <!-- XXXhierarchy -->

 <li><p>If <var title="">newChild</var> is a <code><a href="#documenttype">DocumentType</a></code> node and its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is not null throw a
 <code title="dom-DOMException-NOT_SUPPORTED_ERR"><a href="#dom-domexception-not_supported_err">NOT_SUPPORTED_ERR</a></code>
 exception and terminate these steps.

 <li><p>If <var title="">newChild</var> is a <code><a href="#documenttype">DocumentType</a></code> node set its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> to the
 <a href="#context-object">context object</a>'s
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>.

 <li><p>If <var title="">newChild</var> is not a <code><a href="#documenttype">DocumentType</a></code> node let
 <var title="">newChild</var> be the result of invoking the
 <a href="#context-object">context object</a>'s
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>
 <code title="dom-Document-adoptNode"><a href="#dom-document-adoptnode">adoptNode</a></code> method with
 <var title="">newChild</var> as its argument.

 <li><p>If <var title="">newChild</var> is a <code><a href="#documentfragment">DocumentFragment</a></code> node,
 insert the children of <var title="">newChild</var> in the
 <a href="#context-object">context object</a>, in <a href="#tree-order">tree order</a>, so that the last
 child becomes the previous sibling of <var title="">refChild</var>.

 <li><p>Otherwise insert <var title="">newChild</var> in the
 <a href="#context-object">context object</a> as the previous sibling of <var title="">refChild</var>.

 <li><p>Return <var title="">newChild</var>.
</ol>

<p>The
<dfn id="dom-node-replacechild" title="dom-Node-replaceChild"><code>replaceChild(<var title="">newChild</var>, <var title="">oldChild</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If the <a href="#context-object">context object</a> is not a <code><a href="#document">Document</a></code>,
 <code><a href="#documentfragment">DocumentFragment</a></code> or <code><a href="#element">Element</a></code>, throw a
 <code title="dom-DOMException-HIERARCHY_REQUEST_ERR"><a href="#dom-domexception-hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code>
 and terminate these steps.

 <li><p>If <var title="">oldChild</var> is not a child of the
 <a href="#context-object">context object</a>, then throw a
 <code title="dom-DOMException-NOT_FOUND_ERR"><a href="#dom-domexception-not_found_err">NOT_FOUND_ERR</a></code> exception
 and terminate these steps.

 <li><p>If <var title="">newChild</var> is the <a href="#context-object">context object</a> or an
 <a href="#concept-tree-ancestor" title="concept-tree-ancestor">ancestor</a> of the
 <a href="#context-object">context object</a> throw a
 <code title="dom-DOMException-HIERARCHY_REQUEST_ERR"><a href="#dom-domexception-hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code>
 and terminate these steps.

 <!-- XXXhierarchy -->

 <li><p>If <var title="">newChild</var> is a <code><a href="#documenttype">DocumentType</a></code> node and its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is not null throw a
 <code title="dom-DOMException-NOT_SUPPORTED_ERR"><a href="#dom-domexception-not_supported_err">NOT_SUPPORTED_ERR</a></code>
 exception and terminate these steps.

 <li><p>If <var title="">newChild</var> is a <code><a href="#documenttype">DocumentType</a></code> node set its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> to the
 <a href="#context-object">context object</a>'s
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>.

 <li><p>If <var title="">newChild</var> is not a <code><a href="#documenttype">DocumentType</a></code> node let
 <var title="">newChild</var> be the result of invoking the
 <a href="#context-object">context object</a>'s
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>
 <code title="dom-Document-adoptNode"><a href="#dom-document-adoptnode">adoptNode</a></code> method with
 <var title="">newChild</var> as its argument.

 <li><p>Let <var title="">refChild</var> be <var title="">oldChild</var>'s
 first <span title="concept-tree-next-sibling">next sibling</span>.

 <li><p>Remove <var title="">oldChild</var> from the <a href="#context-object">context object</a>.

 <li><p>Return the result of invoking the <a href="#context-object">context object</a>'s
 <code title="dom-Node-insertBefore"><a href="#dom-node-insertbefore">insertBefore</a></code> method with
 <var title="">newChild</var> and <var title="">refChild</var> as arguments.
</ol>

<p>The
<dfn id="dom-node-removechild" title="dom-Node-removeChild"><code>removeChild(<var title="">oldChild</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If the <a href="#context-object">context object</a> is not a <code><a href="#document">Document</a></code>,
 <code><a href="#documentfragment">DocumentFragment</a></code> or <code><a href="#element">Element</a></code>, throw a
 <code title="dom-DOMException-HIERARCHY_REQUEST_ERR"><a href="#dom-domexception-hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code>
 and terminate these steps.

 <li><p>If <var title="">oldChild</var> is not a child of the
 <a href="#context-object">context object</a>, then throw a
 <code title="dom-DOMException-NOT_FOUND_ERR"><a href="#dom-domexception-not_found_err">NOT_FOUND_ERR</a></code> exception
 and terminate these steps.
 <!-- Including other documents. -->

 <li><p>Remove <var title="">oldChild</var> from the <a href="#context-object">context object</a>.

 <li><p>Return <var title="">oldChild</var>.
</ol>

<p>The
<dfn id="dom-node-appendchild" title="dom-Node-appendChild"><code>appendChild(<var title="">newChild</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If the <a href="#context-object">context object</a> is not a <code><a href="#document">Document</a></code>,
 <code><a href="#documentfragment">DocumentFragment</a></code> or <code><a href="#element">Element</a></code>, throw a
 <code title="dom-DOMException-HIERARCHY_REQUEST_ERR"><a href="#dom-domexception-hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code>
 and terminate these steps.

 <li><p>If <var title="">newChild</var> is the <a href="#context-object">context object</a> or an
 <a href="#concept-tree-ancestor" title="concept-tree-ancestor">ancestor</a> of the
 <a href="#context-object">context object</a> throw a
 <code title="dom-DOMException-HIERARCHY_REQUEST_ERR"><a href="#dom-domexception-hierarchy_request_err">HIERARCHY_REQUEST_ERR</a></code>
 and terminate these steps.

 <!-- XXXhierarchy -->

 <li><p>If <var title="">newChild</var> is a <code><a href="#documenttype">DocumentType</a></code> node and its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is not null throw a
 <code title="dom-DOMException-NOT_SUPPORTED_ERR"><a href="#dom-domexception-not_supported_err">NOT_SUPPORTED_ERR</a></code>
 exception and terminate these steps.

 <li><p>If <var title="">newChild</var> is a <code><a href="#documenttype">DocumentType</a></code> node set its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> to the
 <a href="#context-object">context object</a>'s
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>.

 <li><p>If <var title="">newChild</var> is not a <code><a href="#documenttype">DocumentType</a></code> node let
 <var title="">newChild</var> be the result of invoking the
 <a href="#context-object">context object</a>'s
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>
 <code title="dom-Document-adoptNode"><a href="#dom-document-adoptnode">adoptNode</a></code> method with
 <var title="">newChild</var> as its argument.

 <li><p>Append <var title="">newChild</var> to the <a href="#context-object">context object</a>.

 <li><p>Return <var title="">newChild</var>.
</ol>

<hr>

<dl class="domintro">
 <dt><var title="">new node</var> = <var title="">node</var> .
 <code title="dom-Node-cloneNode"><a href="#dom-node-clonenode">cloneNode</a></code>(<var title="">deep</var>)
 <dd>
  <p>Returns a copy of the node, with its relevant node-specific data. If
  <var title="">deep</var> is true, the copy also includes the node's children.

 <dt><var title="">same</var> = <var title="">node</var> .
 <code title="dom-Node-isSameNode"><a href="#dom-node-issamenode">isSameNode</a></code>(<var title="">other</var>)
 <dd>
  <p>Returns whether <var title="">node</var> and <var title="">other</var> are the
  exact same node.

 <dt><var title="">similar</var> = <var title="">node</var> .
 <code title="dom-Node-isEqualNode"><a href="#dom-node-isequalnode">isEqualNode</a></code>(<var title="">other</var>)
 <dd>
  <p>Returns whether <var title="">node</var> and <var title="">other</var> have the
  same properties.
</dl>

<div class="impl">

<p>The
<dfn id="dom-node-clonenode" title="dom-Node-cloneNode"><code>cloneNode(<var title="">deep</var>)</code></dfn>
method must return a <a href="#clone">clone</a> of the <a href="#context-object">context object</a>,
with <var title="">new ownerDocument</var> being the <a href="#context-object">context object</a>'s
<code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code>, and the
<i><a href="#clone-children-flag">clone children flag</a></i> set if <var title="">deep</var> is true.

<p>The
<dfn id="dom-node-issamenode" title="dom-Node-isSameNode"><code>isSameNode(<var title="">node</var>)</code></dfn>
method must return true if <var title="">node</var> is a reference to the same
object as the <a href="#context-object">context object</a>, and false otherwise.

<p>The
<dfn id="dom-node-isequalnode" title="dom-Node-isEqualNode"><code>isEqualNode(<var title="">node</var>)</code></dfn>
method must return true if all of the following conditions are true, and
false otherwise:

<ul>
 <li><p><var title="">node</var> is not null.
 <li><p><var title="">node</var>'s <code title="dom-Node-nodeType"><a href="#dom-node-nodetype">nodeType</a></code> is the same as the <a href="#context-object">context object</a>'s <code title="dom-Node-nodeType"><a href="#dom-node-nodetype">nodeType</a></code>.
 <li><p><var title="">node</var>'s <code title="dom-Node-nodeName"><a href="#dom-node-nodename">nodeName</a></code> is the same as the <a href="#context-object">context object</a>'s <code title="dom-Node-nodeName"><a href="#dom-node-nodename">nodeName</a></code>.
 <li><p><var title="">node</var>'s <code title="dom-Node-nodeValue"><a href="#dom-node-nodevalue">nodeValue</a></code> is the same as the <a href="#context-object">context object</a>'s <code title="dom-Node-nodeValue"><a href="#dom-node-nodevalue">nodeValue</a></code>.
 <li>
  <p>The following are also equal, depending on <var title="">node</var>:
  <dl class="switch">
   <dt><code><a href="#documenttype">DocumentType</a></code>
   <dd><p>Its <a href="#concept-doctype-name" title="concept-doctype-name">name</a>,
   <a href="#concept-doctype-publicid" title="concept-doctype-publicid">public ID</a>, and
   <a href="#concept-doctype-systemid" title="concept-doctype-systemid">system ID</a>.

   <dt><code><a href="#element">Element</a></code>
   <dd><p>Its <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a>,
   <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a>,
   <a href="#concept-element-local-name" title="concept-element-local-name">local name</a>, and its
   associated collection of <code><a href="#attr">Attr</a></code> objects. <!-- XXX def -->

   <!--AttrExodus
   <dt><code>Attr</code>
   <dd><p><code title=dom-Attr-value>value</code>
   -->

   <dt><code><a href="#text">Text</a></code>
   <dt><code><a href="#comment">Comment</a></code>
   <dd><p>Its <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code>.

   <dt><code><a href="#processinginstruction">ProcessingInstruction</a></code>

   <dd><p>Its <a href="#concept-pi-target" title="concept-PI-target">target</a> and
   <a href="#concept-pi-data" title="concept-PI-data">data</a>.

   <dt>Any other node
   <dd><p>&mdash;
  </dl>
 <li><p><var title="">node</var>'s <code title="dom-Node-childNodes"><a href="#dom-node-childnodes">childNodes</a></code>' <code title="dom-NodeList-length"><a href="#dom-nodelist-length">length</a></code> is the same as the <a href="#context-object">context object</a>'s <code title="dom-Node-childNodes"><a href="#dom-node-childnodes">childNodes</a></code>' <code title="dom-NodeList-length"><a href="#dom-nodelist-length">length</a></code>.
 <li><p>Calling <code title="dom-Node-isEqualNode"><a href="#dom-node-isequalnode">isEqualNode</a></code> on each child node of the <a href="#context-object">context object</a>, with the child node of the same index in <var title="">node</var> as argument returns true for every child node.
</ul>

</div>

<hr>

<p>To <dfn id="locate-a-namespace-prefix">locate a namespace prefix</dfn> for an <var title="">element</var> using
<var title="">namespace</var> run these steps:

<ol>
 <li><p>If <var title="">element</var>'s
 <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> is
 <var title="">namespace</var> and its
 <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a> is not
 null return its
 <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a> and
 terminate these steps.

 <li><p>If, in <var title="">element</var>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code>, there is an
 <code><a href="#attr">Attr</a></code> whose
 <a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a> is
 "<code title="">xmlns</code>" and <a href="#concept-attr-value" title="concept-attr-value">value</a>
 is <var title="">namespace</var> then return its
 <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> and terminate these
 steps.

 <li><p>Return the result of running <a href="#locate-a-namespace-prefix">locate a namespace prefix</a>
 on its <a href="#parent-element">parent element</a> using <var title="">namespace</var>, if
 that is not null, or null otherwise.
</ol>

<p>To <dfn id="locate-a-namespace">locate a namespace</dfn> for a <var title="">node</var> using
<var title="">prefix</var> depends on the <var title="">node</var>:

<dl class="switch">
 <dt><code><a href="#element">Element</a></code>
 <dd>
  <ol>
   <li><p>If its <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> is
   not null and its
   <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a> is
   <var title="">prefix</var> return
   <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> and terminate
   these steps.

   <li><p>If, in its <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code>, there
   is an <code><a href="#attr">Attr</a></code>

   whose <a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a>
   is "<code title="">xmlns</code>" and
   <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
   <var title="">prefix</var> or

   whose <a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a>
   is null and <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
   "<code title="">xmlns</code>":

    <ol>
     <li><p>Let <var title="">value</var> be its
     <a href="#concept-attr-value" title="concept-attr-value">value</a> if it is not the empty
     string, or null otherwise.

     <li><p>Return <var title="">value</var> and terminate these steps.
    </ol>

   <li><p>Return the result of running <a href="#locate-a-namespace">locate a namespace</a> on
   its <a href="#parent-element">parent element</a> using <var title="">prefix</var>, if that is
   not null, or null otherwise.
  </ol>

 <!--AttrExodus <code>Attr</code> -->
 <dt><code><a href="#document">Document</a></code>
 <dd><p>Return the result of running <a href="#locate-a-namespace">locate a namespace</a> on its
 <code title="dom-Document-documentElement"><a href="#dom-document-documentelement">documentElement</a></code> using
 <var title="">prefix</var>, if
 <code title="dom-Document-documentElement"><a href="#dom-document-documentelement">documentElement</a></code> is
 not null, or null otherwise.

 <dt><code><a href="#documenttype">DocumentType</a></code>
 <dt><code><a href="#documentfragment">DocumentFragment</a></code>
 <dd><p>Return null.

 <dt>Any other node
 <dd><p>Return the result of running <a href="#locate-a-namespace">locate a namespace</a> on its
 <a href="#parent-element">parent element</a> using <var title="">prefix</var>, if that is not
 null, or null otherwise.
</dl>

<p>The
<dfn id="dom-node-lookupprefix" title="dom-Node-lookupPrefix"><code>lookupPrefix(<var title="">namespace</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If <var title="">namespace</var> is the empty string return null.

 <li>
  <p>Otherwise it depends on the <a href="#context-object">context object</a>:

  <dl class="switch">
   <dt><code><a href="#element">Element</a></code>
   <dd><p>Return the result of
   <a href="#locate-a-namespace-prefix" title="locate a namespace prefix">locating a namespace prefix</a>
   for the node using <var title="">namespace</var>.

   <!--AttrExodus <code>Attr</code> -->
   <dt><code><a href="#document">Document</a></code>
   <dd><p>Return the result of
   <a href="#locate-a-namespace-prefix" title="locate a namespace prefix">locating a namespace prefix</a>
   for its <code title="dom-Document-documentElement"><a href="#dom-document-documentelement">documentElement</a></code>, if
   that is not null, or null otherwise.

   <dt><code><a href="#documenttype">DocumentType</a></code>
   <dt><code><a href="#documentfragment">DocumentFragment</a></code>
   <dd><p>Return null.

   <dt>Any other node
   <dd><p>Return the result of
   <a href="#locate-a-namespace-prefix" title="locate a namespace prefix">locating a namespace prefix</a>
   for its <a href="#parent-element">parent element</a>, or if that is null, null.
  </dl>
</ol>

<p>The
<dfn id="dom-node-lookupnamespaceuri" title="dom-Node-lookupNamespaceURI"><code>lookupNamespaceURI(<var title="">prefix</var>)</code></dfn>
method must return the result of running <a href="#locate-a-namespace">locate a namespace</a> for
the <a href="#context-object">context object</a> using <var title="">prefix</var>.

<p>The
<dfn id="dom-node-isdefaultnamespace" title="dom-Node-isDefaultNamespace"><code>isDefaultNamespace(<var title="">namespace</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>Let <var title="">defaultNamespace</var> be the result of invoking
 <code title="dom-Node-lookupNamespaceURI"><a href="#dom-node-lookupnamespaceuri">lookupNamespaceURI</a></code> with null
 as argument on the <a href="#context-object">context object</a>.

 <li><p>If <var title="">defaultNamespace</var> is null let it be the empty
 string.

 <li><p>Return true if <var title="">defaultNamespace</var> is <var title="">namespace</var>,
 or false otherwise.
</ol>


<h3 id="interface-documentfragment"><span class="secno">5.4 </span>Interface <code><a href="#documentfragment">DocumentFragment</a></code></h3>
<pre class="idl">interface <dfn id="documentfragment">DocumentFragment</dfn> : <a href="#node">Node</a> {
};</pre>


<h3 id="interface-document"><span class="secno">5.5 </span>Interface <code><a href="#document">Document</a></code></h3>
<pre class="idl">interface <dfn id="document">Document</dfn> : <a href="#node">Node</a> {
  readonly attribute <a href="#domimplementation">DOMImplementation</a> <a href="#dom-document-implementation" title="dom-Document-implementation">implementation</a>;
           attribute DOMString <a href="#dom-document-documenturi" title="dom-Document-documentURI">documentURI</a>;
  readonly attribute DOMString <a href="#dom-document-compatmode" title="dom-Document-compatMode">compatMode</a>;

  readonly attribute <a href="#documenttype">DocumentType</a> <a href="#dom-document-doctype" title="dom-Document-doctype">doctype</a>;
  readonly attribute <a href="#element">Element</a> <a href="#dom-document-documentelement" title="dom-Document-documentElement">documentElement</a>;
  <a href="#nodelist">NodeList</a> <a href="#dom-document-getelementsbytagname" title="dom-Document-getElementsByTagName">getElementsByTagName</a>(DOMString <var title="">qualifiedName</var>);
  <a href="#nodelist">NodeList</a> <a href="#dom-document-getelementsbytagnamens" title="dom-Document-getElementsByTagNameNS">getElementsByTagNameNS</a>(DOMString <var title="">namespace</var>, DOMString <var title="">localName</var>);
  <a href="#nodelist">NodeList</a> <a href="#dom-document-getelementsbyclassname" title="dom-Document-getElementsByClassName">getElementsByClassName</a>(DOMString <var title="">classNames</var>);
  <a href="#element">Element</a> <a href="#dom-document-getelementbyid" title="dom-Document-getElementById">getElementById</a>(DOMString <var title="">elementId</var>);

  <a href="#element">Element</a> <a href="#dom-document-createelement" title="dom-Document-createElement">createElement</a>([TreatNullAs=EmptyString] DOMString <var title="">localName</var>);
  <a href="#element">Element</a> <a href="#dom-document-createelementns" title="dom-Document-createElementNS">createElementNS</a>(DOMString <var title="">namespace</var>, DOMString <var title="">qualifiedName</var>);
  <a href="#documentfragment">DocumentFragment</a> <a href="#dom-document-createdocumentfragment" title="dom-Document-createDocumentFragment">createDocumentFragment</a>();
  <a href="#text">Text</a> <a href="#dom-document-createtextnode" title="dom-Document-createTextNode">createTextNode</a>(DOMString <var title="">data</var>);
  <a href="#comment">Comment</a> <a href="#dom-document-createcomment" title="dom-Document-createComment">createComment</a>(DOMString <var title="">data</var>);
  <a href="#processinginstruction">ProcessingInstruction</a> <a href="#dom-document-createprocessinginstruction" title="dom-Document-createProcessingInstruction">createProcessingInstruction</a>(DOMString <var title="">target</var>, DOMString <var title="">data</var>);<!--
  CDATASection createCDATASection(DOMString data);
  EntityReference createEntityReference(DOMString name);
  <span>Attr</span> <span title=dom-Document-createAttribute>createAttribute</span>(DOMString name);
  <span>Attr</span> <span title=dom-Document-createAttributeNS>createAttributeNS</span>(DOMString namespace, DOMString qualifiedName);
    If adding this, search for [createAttribute]-->

  <a href="#node">Node</a> <a href="#dom-document-importnode" title="dom-Document-importNode">importNode</a>(<a href="#node">Node</a> <var title="">node</var>, boolean <var title="">deep</var>);
  <a href="#node">Node</a> <a href="#dom-document-adoptnode" title="dom-Document-adoptNode">adoptNode</a>(<a href="#node">Node</a> <var title="">node</var>);<!--
  readonly attribute DOMString xmlEncoding;
           attribute boolean xmlStandalone;
           attribute DOMString <span title=dom-Document-xmlVersion>xmlVersion</span>;
           attribute boolean strictErrorChecking;
  readonly attribute DOMConfiguration domConfig;
  void normalizeDocument();
  Node renameNode(Node n, DOMString namespace, DOMString qualifiedName);-->

  <a href="#event">Event</a> <a href="#dom-document-createevent" title="dom-Document-createEvent">createEvent</a>(DOMString <var title="">interface</var>);
};</pre>

<p>A <code><a href="#document">Document</a></code> node is assumed to be an <dfn id="xml-document">XML document</dfn>
unless it is flagged as being an <dfn id="html-document">HTML document</dfn>. Whether a
document is an <a href="#html-document">HTML document</a> or an <a href="#xml-document">XML document</a>
affects the behavior of certain APIs.

<p>A <code><a href="#document">Document</a></code> node is always set to one of three modes:
<dfn id="concept-no-quirks-mode" title="concept-no-quirks-mode">no-quirks mode</dfn>, the default;
<dfn id="concept-quirks-mode" title="concept-quirks-mode">quirks mode</dfn>, used typically for legacy
documents; and
<dfn id="concept-limited-quirks-mode" title="concept-limited-quirks-mode">limited-quirks mode</dfn>, also known
as "almost standards" mode. Unless
<a href="#other-applicable-specifications">other applicable specifications</a> define otherwise, the
<code><a href="#document">Document</a></code> must be in
<a href="#concept-no-quirks-mode" title="concept-no-quirks-mode">no-quirks mode</a>.

<p class="note">The mode is only ever changed from the default if the
<code><a href="#document">Document</a></code> node is created by the
<a class="external" href="http://www.whatwg.org/html/#html-parser">HTML parser</a>, based on the presence,
absence, or value of the DOCTYPE string.
<a class="informative" href="#refsHTML">[HTML]</a>

<hr>

<dl class="domintro">
 <dt><var title="">document</var> . <code title="dom-Document-compatMode"><a href="#dom-document-compatmode">compatMode</a></code>
 <dd>
  <p>Returns the string "<code title="">CSS1Compat</code>" if the
  <a href="#context-object">context object</a> is in
  <a href="#concept-no-quirks-mode" title="concept-no-quirks-mode">no-quirks mode</a> or
  <a href="#concept-limited-quirks-mode" title="concept-limited-quirks-mode">limited-quirks mode</a>, and
  "<code title="">BackCompat</code>", if the <code><a href="#document">Document</a></code> is in
  <a href="#concept-quirks-mode" title="concept-quirks-mode">quirks mode</a>.
</dl>

<p>The <dfn id="dom-document-implementation" title="dom-Document-implementation"><code>implementation</code></dfn> attribute must return the <code><a href="#domimplementation">DOMImplementation</a></code> object that is associated with the <code><a href="#document">Document</a></code> node.

<p class="XXX"><dfn id="dom-document-documenturi" title="dom-Document-documentURI">documentURI</dfn>
Should document.documentURI really exist? be readonly?

<p>The <dfn id="dom-document-compatmode" title="dom-Document-compatMode"><code>compatMode</code></dfn> IDL
attribute must return the literal string "<code title="">CSS1Compat</code>" unless
the <a href="#context-object">context object</a> is in <a href="#concept-quirks-mode" title="concept-quirks-mode">quirks mode</a>, in which case it must instead
return the literal string "<code title="">BackCompat</code>".

<!-- <dfn title=dom-Document-xmlVersion>xmlVersion</dfn>
http://lists.w3.org/Archives/Public/www-dom/2003JulSep/0049.html -->

<hr>

<dl class="domintro">
 <dt><var title="">collection</var> = <var title="">document</var> . <code title="dom-Document-getElementsByClassName"><a href="#dom-document-getelementsbyclassname">getElementsByClassName(<var title="">classes</var>)</a></code>
 <dt><var title="">collection</var> = <var title="">element</var> . <code title="dom-Element-getElementsByClassName"><a href="#dom-element-getelementsbyclassname">getElementsByClassName(<var title="">classes</var>)</a></code>
 <dd>
  <p>Returns a <code><a href="#nodelist">NodeList</a></code> of the elements in the object on which the
  method was invoked (a <code><a href="#document">Document</a></code> or an <code><a href="#element">Element</a></code>) that
  have all the classes given by <var title="">classes</var>.
  <p>The <var title="">classes</var> argument is interpreted as a space-separated
  list of classes.
</dl>

<p>The <dfn id="dom-document-doctype" title="dom-Document-doctype"><code>doctype</code></dfn> attribute must return the child of the <code><a href="#document">Document</a></code> node that is a <code><a href="#documenttype">DocumentType</a></code> node, if there is one, or null otherwise.

<p>The
<dfn id="dom-document-documentelement" title="dom-Document-documentElement"><code>documentElement</code></dfn>
attribute must return the <a href="#document-element">document element</a>.

<p>The <dfn id="dom-document-getelementsbytagname" title="dom-Document-getElementsByTagName"><code>getElementsByTagName(<var title="">localName</var>)</code></dfn> method must run these steps:

<ol>
 <li><p>If <var title="">localName</var> is "<code>*</code>" (U+002A),
 return a <code><a href="#nodelist">NodeList</a></code> rooted at the <a href="#context-object">context object</a>,
 whose filter matches only <code><a href="#element">Element</a></code> nodes.

 <li>
  <p>Otherwise, if the <a href="#context-object">context object</a> is an
  <a href="#html-document">HTML document</a>, return a <code><a href="#nodelist">NodeList</a></code> rooted at the
  <a href="#context-object">context object</a>, whose filter matches only the following nodes:

  <ul>
   <li><code><a href="#element">Element</a></code> nodes in the <a href="#html-namespace">HTML namespace</a> whose <a href="#concept-element-local-name" title="concept-element-local-name">local name</a> is
   <var title="">localName</var> <a href="#converted-to-lowercase">converted to lowercase</a>.

   <li><code><a href="#element">Element</a></code> nodes, <em>not</em> in the
   <a href="#html-namespace">HTML namespace</a>, whose
   <a href="#concept-element-local-name" title="concept-element-local-name">local name</a> is
   <var title="">localName</var>.
  </ul>

 <li><p>Otherwise, return a <code><a href="#nodelist">NodeList</a></code> rooted at the
 <a href="#context-object">context object</a>, whose filter matches only <a href="#concept-element" title="concept-element">elements</a> whose <a href="#concept-element-local-name" title="concept-element-local-name">local name</a> is
 <var title="">localName</var>.
</ol>
<p>When invoked with the same argument the same <code><a href="#nodelist">NodeList</a></code> object may be returned as returned by an earlier call.

<p class="note">Thus, in an <a href="#html-document">HTML document</a>,
<code title="">document.getElementsByTagName("FOO")</code> will match
<code title="">FOO</code> elements that are not in the
<a href="#html-namespace">HTML namespace</a>, and <code title="">foo</code> elements that are in
the <a href="#html-namespace">HTML namespace</a>, but not <code title="">FOO</code> elements
that are in the <a href="#html-namespace">HTML namespace</a>.


<p>The <dfn id="dom-document-getelementsbytagnamens" title="dom-Document-getElementsByTagNameNS"><code>getElementsByTagNameNS(<var title="">namespace</var>, <var title="">localName</var>)</code></dfn> method must run these steps:
<ol>
 <li><p>If both <var title="">namespace</var> and <var title="">localName</var> are
 "<code>*</code>" (U+002A) return a <code><a href="#nodelist">NodeList</a></code> rooted at the
 <a href="#context-object">context object</a>, whose filter matches only <a href="#concept-element" title="concept-element">elements</a>.
 <li><p>Otherwise, if just <var title="">namespace</var> is "<code>*</code>"
 (U+002A), return a <code><a href="#nodelist">NodeList</a></code> rooted at the
 <a href="#context-object">context object</a>, whose filter matches only <a href="#concept-element" title="concept-element">elements</a> whose <a href="#concept-element-local-name" title="concept-element-local-name">local name</a> is
 <var title="">localName</var>.
 <li><p>Otherwise, if just <var title="">localName</var> is "<code>*</code>"
 (U+002A), return a <code><a href="#nodelist">NodeList</a></code> rooted at the
 <a href="#context-object">context object</a>, whose filter matches only <a href="#concept-element" title="concept-element">elements</a> whose <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> is
 <var title="">namespace</var>.
 <li><p>Otherwise, return a <code><a href="#nodelist">NodeList</a></code> rooted at the
 <a href="#context-object">context object</a>, whose filter matches only <a href="#concept-element" title="concept-element">elements</a> whose <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> is
 <var title="">namespace</var> and
 <a href="#concept-element-local-name" title="concept-element-local-name">local name</a> is
 <var title="">localName</var>.
</ol>
<p>When invoked with the same argument the same <code><a href="#nodelist">NodeList</a></code> object may be returned as returned by an earlier call.



<p>The <dfn id="dom-document-getelementsbyclassname" title="dom-Document-getElementsByClassName"><code>getElementsByClassName(<var title="">classNames</var>)</code></dfn> method takes a string that contains a
<a href="#set-of-space-separated-tokens">set of space-separated tokens</a> representing <a href="#concept-class" title="concept-class">classes</a>. When called, the method must return a <a href="#concept-collection-live" title="concept-collection-live">live</a> <code><a href="#nodelist">NodeList</a></code> object
containing all the elements in the <a href="#context-object">context object</a>, in <a href="#tree-order">tree
order</a>, that have all the <a href="#concept-class" title="concept-class">classes</a>
specified in the <var title="">classNames</var> argument, having obtained the
<a href="#concept-class" title="concept-class">classes</a> by <a href="#split-a-string-on-spaces" title="split a string on
spaces">splitting the string on spaces</a>. (Duplicates are ignored.) If
there are no tokens specified in the argument, then the method must return an
empty <code><a href="#nodelist">NodeList</a></code>. If the document is in <a href="#concept-quirks-mode" title="concept-quirks-mode">quirks mode</a>, then the comparisons for the <a href="#concept-class" title="concept-class">classes</a> must be done in an <a href="#ascii-case-insensitive">ASCII
case-insensitive</a> manner, otherwise, the comparisons must be done in a
<a href="#case-sensitive">case-sensitive</a> manner.
<p>When invoked with the same argument the same <code><a href="#nodelist">NodeList</a></code> object may be returned as returned by an earlier call.

<div class="example">
 <p>Given the following XHTML fragment:

 <pre>&lt;div id="example"&gt;
  &lt;p id="p1" class="aaa bbb"/&gt;
  &lt;p id="p2" class="aaa ccc"/&gt;
  &lt;p id="p3" class="bbb ccc"/&gt;
&lt;/div&gt;</pre>

 <p>A call to
 <code title="dom-Element-getElementsByClassName"><a href="#dom-element-getelementsbyclassname">document.getElementById('example').getElementsByClassName('aaa')</a></code>
 would return a <code><a href="#nodelist">NodeList</a></code> with the two paragraphs
 <code title="">p1</code> and <code title="">p2</code> in it.

 <p>A call to
 <code title="dom-Element-getElementsByClassName"><a href="#dom-element-getelementsbyclassname">getElementsByClassName('ccc&nbsp;bbb')</a></code>
 would only return one node, however, namely <code title="">p3</code>. A call to
 <code title="dom-Element-getElementsByClassName"><a href="#dom-element-getelementsbyclassname">document.getElementById('example').getElementsByClassName('bbb&nbsp;&nbsp;ccc&nbsp;')</a></code>
 would return the same thing.

 <p>A call to
 <code title="dom-Element-getElementsByClassName"><a href="#dom-element-getelementsbyclassname">getElementsByClassName('aaa,bbb')</a></code>
 would return no nodes; none of the elements above are in the
 <code title="">aaa,bbb</code> class.
</div>

<!-- v2:
>         * xGetParentElementByClassName(rootElement, className, tagName) -
> Navigates upwards until we hit a parent element with the given class name and
> optional tag name.
-->

<p>The
<dfn id="dom-document-getelementbyid" title="dom-Document-getElementById"><code>getElementById(<var title="">elementId</var>)</code></dfn>
method must return the first <a href="#concept-element" title="concept-element">element</a>, in
<a href="#tree-order">tree order</a>, within the <a href="#context-object">context object</a>'s
<a href="#concept-tree" title="concept-tree">tree</a>, whose <a href="#concept-id" title="concept-ID">ID</a>
is <var title="">elementId</var>, or null if there is none.

<hr>

<p>The <dfn id="dom-document-createelement" title="dom-Document-createElement"><code>createElement(<var title="">localName</var>)</code></dfn> method must run the these steps:

<ol>
 <li><p>If <var title="">localName</var> does not match the <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Name">Name</a></code> production in XML, throw an
 <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.

 <li><p>If the <a href="#context-object">context object</a> is an <a href="#html-document">HTML document</a>,
 let <var title="">localName</var> be <a href="#converted-to-lowercase">converted to lowercase</a>.
 <!-- XXX why restrict this to HTML documents? -->

 <li><p>Return a new <a href="#concept-element" title="concept-element">element</a> with no
 attributes,
 <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> set to the
 <a href="#html-namespace">HTML namespace</a>,
 <a href="#concept-element-local-name" title="concept-element-local-name">local name</a> set to
 <var title="">localName</var>, and
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to the
 <a href="#context-object">context object</a>.
</ol>

<p>The
<dfn id="dom-document-createelementns" title="dom-Document-createElementNS"><code>createElementNS(<var title="">namespace</var>, <var title="">qualifiedName</var>)</code></dfn>
method must run these steps:
<ol>
 <li><p>If <var title="">qualifiedName</var> does not match the
 <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Name">Name</a></code> production in XML, throw an
 <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.
 <li><p>If <var title="">qualifiedName</var> does not match the
 <code class="external"><a href="http://www.w3.org/TR/xml-names/#NT-QName">QName</a></code> production in Namespaces in XML,
 throw a <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code>
 exception and terminate these steps.
 <li><p>If <var title="">qualifiedName</var> contains a "<code>:</code>" (U+003E),
 then split the string on it and let <var title="">prefix</var> be the part before
 and <var title="">localName</var> the part after. Otherwise, let <var title="">prefix</var>
 be null and <var title="">localName</var> be <var title="">qualifiedName</var>.
 <li><p>If <var title="">prefix</var> is not null and <var title="">namespace</var> is an
 empty string, throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception
 and terminate these steps.
 <li><p>If <var title="">prefix</var> is "<code title="">xml</code>" and
 <var title="">namespace</var> is not the <a href="#xml-namespace">XML namespace</a>, throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception
 and terminate these steps.
 <li><p>If <var title="">qualifiedName</var> or <var title="">prefix</var> is
 "<code title="">xmlns</code>" and <var title="">namespace</var> is not the
 <a href="#xmlns-namespace">XMLNS namespace</a>, throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception
 and terminate these steps.
 <li><p>If <var title="">namespace</var> is the <a href="#xmlns-namespace">XMLNS namespace</a> and
 neither <var title="">qualifiedName</var> nor <var title="">prefix</var> is
 "<code title="">xmlns</code>", throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception
 and terminate these steps.
 <li><p>Return a new <a href="#concept-element" title="concept-element">element</a> with no attributes,
 <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> set to <var title="">namespace</var>,
 <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a> set to
 <var title="">prefix</var>, <a href="#concept-element-local-name" title="concept-element-local-name">local name</a>
 set to <var title="">localName</var>, and
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to the
 <a href="#context-object">context object</a>.
</ol>

<p>The
<dfn id="dom-document-createdocumentfragment" title="dom-Document-createDocumentFragment"><code>createDocumentFragment()</code></dfn>
method must return a new <code><a href="#documentfragment">DocumentFragment</a></code> node with its
<code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to the
<a href="#context-object">context object</a>.

<p>The <dfn id="dom-document-createtextnode" title="dom-Document-createTextNode"><code>createTextNode(<var title="">data</var>)</code></dfn> method must return a new <code><a href="#text">Text</a></code> node with its <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> attribute set to <var title="">data</var> and <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to the <a href="#context-object">context object</a>.
<p class="note">No check is performed that the text node contains characters that
match the <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Char">Char</a></code> production in XML.

<p>The <dfn id="dom-document-createcomment" title="dom-Document-createComment"><code>createComment(<var title="">data</var>)</code></dfn> method must return a new <code><a href="#comment">Comment</a></code> node with its <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> attribute set to <var title="">data</var> and <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to the <a href="#context-object">context object</a>.
<p class="note">No check is performed that the comment contains characters that
match the <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Char">Char</a></code> production in XML or that it
contains two adjacent hyphens or ends with a hyphen.

<p>The <dfn id="dom-document-createprocessinginstruction" title="dom-Document-createProcessingInstruction"><code>createProcessingInstruction(<var title="">target</var>, <var title="">data</var>)</code></dfn> method must run these steps:

<ol>
 <li><p>If the <a href="#context-object">context object</a> is an <a href="#html-document">HTML document</a>, throw
 a <code title="dom-DOMException-NOT_SUPPORTED_ERR"><a href="#dom-domexception-not_supported_err">NOT_SUPPORTED_ERR</a></code>
 exception and terminate these steps.

 <li><p>If <var title="">target</var> does not match the <!--<code
 data-anolis-spec=xml>PITarget</code>--> <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Name">Name</a></code>
 production in XML, throw an <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps. <!-- DOM3 didn't check for "xml" -->

 <li><p>If <var title="">data</var> contains the string "<code title="">?&gt;</code>",
 throw an <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps. <!-- Gecko does this. -->

 <!--<li><p>If <var title>target</var> contains a U+003A COLON (":") character, throw a <code title=dom-DOMException-NAMESPACE_ERR>NAMESPACE_ERR</code> exception and terminate these steps.--> <!-- DOM3 didn't check this -->

 <li><p>Return a new <code><a href="#processinginstruction">ProcessingInstruction</a></code>, with
 <a href="#concept-pi-target" title="concept-PI-target">target</a> set to <var title="">target</var>,
 <a href="#concept-pi-data" title="concept-PI-data">data</a> set to <var title="">data</var>, and
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to the
 <a href="#context-object">context object</a>.
</ol>

<p class="note">No check is performed that the processing instruction target
contains "xml" or the colon, or that the data contains characters that match the
<code class="external"><a href="http://www.w3.org/TR/xml/#NT-Char">Char</a></code> production in XML.

<!--
[createAttribute]
<p>The <dfn title=dom-Document-createAttribute><code>createAttribute(<var title>name</var>)</code></dfn> method must run these steps:
<ol>
 <li><p>If <var title>name</var> does not match the <code data-anolis-spec=xml>Name</code> production in XML, throw an
 <code title=dom-DOMException-INVALID_CHARACTER_ERR>INVALID_CHARACTER_ERR</code>
 exception and terminate these steps.
 <li><p>Return a new <code>Attr</code> node with its <code title=dom-Node-namespaceURI>namespaceURI</code> set to null, <code title=dom-Node-prefix>prefix</code> set to null, <code title=dom-Node-localName>localName</code> set to <var title>name</var>, and <code title=dom-Node-ownerDocument>ownerDocument</code> set to the <span>context object</span>.
</ol>-->
<!-- this is different from DOM3 -->
<!--<p class=note>No check is performed that the local name will match the <code
data-anolis-spec=xmlns>NCName</code> production in Namespaces in XML.-->

<hr>

<p>The
<dfn id="dom-document-importnode" title="dom-Document-importNode"><code>importNode(<var title="">node</var>, <var title="">deep</var>)</code></dfn>
method must return a <a href="#clone">clone</a> of <var title="">node</var>, with
<var title="">new ownerDocument</var> being the <a href="#context-object">context object</a>, and the
<i><a href="#clone-children-flag">clone children flag</a></i> set if <var title="">deep</var> is true.

<p>The
<dfn id="dom-document-adoptnode" title="dom-Document-adoptNode"><code>adoptNode(<var title="">node</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If <var title="">node</var> is of type <code><a href="#document">Document</a></code> or
 <code><a href="#documenttype">DocumentType</a></code>, throw a
 <code title="dom-DOMException-NOT_SUPPORTED_ERR"><a href="#dom-domexception-not_supported_err">NOT_SUPPORTED_ERR</a></code>
 exception and terminate these steps.

 <li><p>If <var title="">node</var> is of type <code><a href="#element">Element</a></code>, it is
 <a href="#affected-by-a-base-url-change">affected by a base URL change</a>.

 <li><p>If <var title="">node</var>'s
 <a href="#concept-tree-parent" title="concept-tree-parent">parent</a> is not null, remove
 <var title="">node</var> from its
 <a href="#concept-tree-parent" title="concept-tree-parent">parent</a>.

 <li><p>Set <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> for
 <var title="">node</var> and all its <a href="#concept-tree-descendant" title="concept-tree-descendant">descendants</a><!--AttrExodus as well as any associated
 <code>Attr</code> nodes--> to the <a href="#context-object">context object</a>.

 <li><p>Return <var title="">node</var>.
</ol>


<h4 id="interface-domimplementation"><span class="secno">5.5.1 </span>Interface <code><a href="#domimplementation">DOMImplementation</a></code></h4>
<p>User agents must create a new <code><a href="#domimplementation">DOMImplementation</a></code> object
whenever a new <code><a href="#document">Document</a></code> object is created and associate it with
that <code><a href="#document">Document</a></code> object.

<pre class="idl">interface <dfn id="domimplementation">DOMImplementation</dfn> {
  boolean <a href="#dom-domimplementation-hasfeature" title="dom-DOMImplementation-hasFeature">hasFeature</a>(DOMString feature, [TreatNullAs=EmptyString] DOMString version);

  <a href="#documenttype">DocumentType</a> <a href="#dom-domimplementation-createdocumenttype" title="dom-DOMImplementation-createDocumentType">createDocumentType</a>([TreatNullAs=EmptyString] DOMString qualifiedName, DOMString publicId, DOMString systemId);
  <a href="#document">Document</a> <a href="#dom-domimplementation-createdocument" title="dom-DOMImplementation-createDocument">createDocument</a>([TreatNullAs=EmptyString] DOMString namespace, [TreatNullAs=EmptyString] DOMString qualifiedName, <a href="#documenttype">DocumentType</a> doctype);<!--
  DOMObject getFeature(DOMString feature, DOMString version);-->
  <a href="#document">Document</a> <a href="#dom-domimplementation-createhtmldocument" title="dom-DOMImplementation-createHTMLDocument">createHTMLDocument</a>(DOMString title);
};</pre>

<dl class="domintro">
 <dt><var title="">hasSupport</var> = <var title="">document</var> . <code title="dom-Document-implementation"><a href="#dom-document-implementation">implementation</a></code> . <code title="dom-DOMImplementation-hasFeature"><a href="#dom-domimplementation-hasfeature">hasFeature</a></code>(
 <var title="">feature</var>, <var title="">version</var> )

 <dd>
  <p>Returns whether the user agent supports the version <var title="">version</var> of <var title="">feature</var>. The empty string means any
  version.
</dl>

<div class="impl">

<p>The <dfn id="dom-domimplementation-hasfeature" title="dom-DOMImplementation-hasFeature"><code>hasFeature(<var title="">feature</var>, <var title="">version</var>)</code></dfn> method must return
true if the user agent <a href="#concept-support-domfeatureversion" title="concept-support-DOMfeatureversion">supports</a>
the (<var title="">feature</var>, <var title="">version</var>) tuple and false
otherwise.

</div>

<hr>

<dl class="domintro">
 <dt><var title="">doctype</var> = <var title="">document</var> . <code title="dom-Document-implementation"><a href="#dom-document-implementation">implementation</a></code> . <code title="dom-DOMImplementation-createDocumentType"><a href="#dom-domimplementation-createdocumenttype">createDocumentType</a></code>(
 <var title="">qualifiedName</var>, <var title="">publicId</var>, <var title="">systemId</var> )

 <dd>
  <p>Returns a new <code><a href="#documenttype">DocumentType</a></code>, with the given <var title="">qualifiedName</var>, <var title="">publicId</var>, and <var title="">systemId</var>. If <var title="">qualifiedName</var> does not match the <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Name">Name</a></code> production in XML, an <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
  exception is thrown, and if it does not match the <code class="external"><a href="http://www.w3.org/TR/xml-names/#NT-NCName">NCName</a></code> production in Namespaces in XML, a <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception is thrown.


 <dt><var title="">doc</var> = <var title="">document</var> . <code title="dom-Document-implementation"><a href="#dom-document-implementation">implementation</a></code> . <code title="dom-DOMImplementation-createDocument"><a href="#dom-domimplementation-createdocument">createDocument</a></code>( <var title="">namespace</var>, <var title="">qualifiedName</var>, <var title="">doctype</var> )

 <dd>
  <p>Returns a new <code><a href="#document">Document</a></code>, with a new root
  <code><a href="#element">Element</a></code> whose
  <a href="#concept-element-local-name" title="concept-element-local-name">local name</a> is
  <var title="">qualifiedName</var> and whose
  <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> is
  <var title="">namespace</var> (unless <var title="">qualifiedName</var> is the
  empty string), and with <var title="">doctype</var>, if it is given, as its
  <code><a href="#documenttype">DocumentType</a></code>.

  <p>This method throws the same exceptions as the <code title="dom-Document-createElementNS"><a href="#dom-document-createelementns">createElementNS</a></code> method, when
  invoked with the same arguments. If <var title="">doctype</var> comes from
  another <code><a href="#document">Document</a></code>, a
  <code title="dom-DOMException-WRONG_DOCUMENT_ERR"><a href="#dom-domexception-wrong_document_err">WRONG_DOCUMENT_ERR</a></code> exception is thrown.


 <dt><var title="">doc</var> = <var title="">document</var> . <code title="dom-Document-implementation"><a href="#dom-document-implementation">implementation</a></code> . <code title="dom-DOMImplementation-createHTMLDocument"><a href="#dom-domimplementation-createhtmldocument">createHTMLDocument</a></code>(
 <var title="">title</var> )

 <dd>
  <p>Returns a new <code><a href="#document">Document</a></code>, with a basic DOM already
  constructed with an appropriate <code title="">title</code> element.
</dl>

<div class="impl">

<p>The <dfn id="dom-domimplementation-createdocumenttype" title="dom-DOMImplementation-createDocumentType"><code>createDocumentType(<var title="">qualifiedName</var>, <var title="">publicId</var>, <var title="">systemId</var>)</code></dfn> method must run the following steps:

<ol>
 <li><p>If <var title="">qualifiedName</var> does not match the <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Name">Name</a></code> production in XML, throw an <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.
 <li><p>If <var title="">qualifiedName</var> does not match the <code class="external"><a href="http://www.w3.org/TR/xml-names/#NT-NCName">NCName</a></code> production in Namespaces in XML, throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception and
 terminate these steps.
 <!--<li><p>If <var title>publicId</var> contains a character that does not match the <code data-anolis-spec=xml>PubidChar</code> production in XML, throw an
 <code title=dom-DOMException-INVALID_CHARACTER_ERR>INVALID_CHARACTER_ERR</code>
 exception and terminate these steps. --> <!-- DOM3 didn't check this -->
 <!--<li><p>If <var title>systemId</var> contains both a U+0022 QUOTATION MARK ('"') and a U+0027 APOSTROPHE ("'") character, throw an
 <code title=dom-DOMException-INVALID_CHARACTER_ERR>INVALID_CHARACTER_ERR</code>
 exception and terminate these steps.--> <!-- DOM3 didn't check this -->
 <li><p>Return a new <code><a href="#documenttype">DocumentType</a></code>, with <var title="">qualifiedName</var> as its <a href="#concept-doctype-name" title="concept-doctype-name">name</a>, <var title="">publicId</var> as its <a href="#concept-doctype-publicid" title="concept-doctype-publicid">public ID</a>, and <var title="">systemId</var>
 as its <a href="#concept-doctype-systemid" title="concept-doctype-systemid">system ID</a>, and with its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to null.
</ol>
<p class="note">No check is performed that the <var title="">publicId</var> matches the <code title="">PublicChar</code> production in XML or that the <var title="">systemId</var> does not contain both a quotation mark (") and an apostrophe (').

<p>The <dfn id="dom-domimplementation-createdocument" title="dom-DOMImplementation-createDocument"><code>createDocument(<var title="">namespace</var>, <var title="">qualifiedName</var>, <var title="">doctype</var>)</code></dfn> method must run the following steps:

<ol>
 <li><p>Let <var title="">document</var> be a new <code><a href="#document">Document</a></code> node.

 <li><p>Let <var title="">element</var> be null.

 <li><p>If <var title="">qualifiedName</var> is not the empty string, set
 <var title="">element</var> to the result of invoking the
 <code title="dom-Document-createElementNS"><a href="#dom-document-createelementns">createElementNS</a></code> method with the
 arguments <var title="">namespace</var> and <var title="">qualifiedName</var> on
 <var title="">document</var>. If that threw an exception, terminate these steps.

 <li>
  <p>If <var title="">doctype</var> is not null, run the following substeps:

  <ol>
   <li><p>If the <var title="">doctype</var>'s
   <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is not null, throw a
   <code title="dom-DOMException-WRONG_DOCUMENT_ERR"><a href="#dom-domexception-wrong_document_err">WRONG_DOCUMENT_ERR</a></code>
   exception and terminate the overall set of steps.

   <li><p>Set the <var title="">doctype</var>'s
   <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> to
   <var title="">document</var>.

   <li><p>Append <var title="">doctype</var> to <var title="">document</var>.
  </ol>

 <li><p>If <var title="">element</var> is not null, append <var title="">element</var>
 to <var title="">document</var>.

 <li><p>Return <var title="">document</var>.
</ol>

<p>The <dfn id="dom-domimplementation-createhtmldocument" title="dom-DOMImplementation-createHTMLDocument"><code>createHTMLDocument(<var title="">title</var>)</code></dfn> method, when invoked, must run the following
steps:

<ol>
 <li><p>Let <var title="">doc</var> be a newly created <code><a href="#document">Document</a></code>
 object.

 <li><p>Mark <var title="">doc</var> as being an <a href="#html-document">HTML document</a>.

 <li><p>Create a new <code><a href="#documenttype">DocumentType</a></code>, with "<code title="">html</code>" as its <a href="#concept-doctype-name" title="concept-doctype-name">name</a> and with its <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> set to <var title="">doc</var>. Append the newly created node to <var title="">doc</var>.

 <li><p>Create an <code title="">html</code> element in the <a href="#html-namespace">HTML
 namespace</a>, and append it to <var title="">doc</var>.

 <li><p>Create a <code title="">head</code> element in the <a href="#html-namespace">HTML
 namespace</a>, and append it to the <code title="">html</code> element created in the previous step.

 <li><p>Create a <code title="">title</code> element in the <a href="#html-namespace">HTML
 namespace</a>, and append it to the <code title="">head</code> element created in the previous step.

 <li><p>Create a <code><a href="#text">Text</a></code> node, and set its <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> attribute to the string given by the
 method's argument (which could be the empty string). Append it to the
 <code title="">title</code> element created in the previous step.

 <li><p>Create a <code title="">body</code> element in the <a href="#html-namespace">HTML
 namespace</a>, and append it to the <code title="">html</code> element created
 in the earlier step.

 <li><p>Return <var title="">doc</var>.
</ol>

</div>

<!-- AttrExodus
<h3>Interface <code>Attr</code></h3>

<p>The tentative plan is to let <code>Attr</code> no longer have
child nodes and turn it into a very lightweight object that no longer
inherits from <code>Node</code> &mdash;
<a href=http://lists.w3.org/Archives/Public/public-webapps/2010JulSep/0797.html>http://lists.w3.org/Archives/Public/public-webapps/2010JulSep/0797.html</a>

<pre class=idl>interface <dfn>Attr</dfn> : <span>Node</span> {
  readonly attribute DOMString <span title=dom-Attr-name>name</span>;
  readonly attribute boolean <span title=dom-Attr-specified>specified</span>;
           attribute DOMString <span title=dom-Attr-value>value</span>;
  readonly attribute <span>Element</span> <span title=dom-Attr-ownerElement>ownerElement</span>;<!- -
  readonly attribute TypeInfo schemaTypeInfo;
  readonly attribute boolean isId;- ->
};</pre>

<p><code>Attr</code> nodes represent <dfn
title=concept-attribute>attributes</dfn>. They have a <dfn
title=concept-attribute-name>name</dfn> and an <dfn
title=concept-attribute-element>element</dfn> associated with them when they are
created<!- -, or when they are passed as the argument to the <code
title=dom-Element-setAttributeNode>setAttributeNode</code> method.
[createAttribute]- ->. <code>Attr</code> nodes are not considered part of the
document tree, so their <code title=dom-Node-parentNode>parentNode</code>, <code
title=dom-Node-previousSibling>previousSibling</code> and <code
title=dom-Node-nextSibling>nextSibling</code> attributes return null. Also, its
child nodes can not be manipulated directly through the <code
title=dom-Node-insertBefore>insertBefore</code>, <code
title=dom-Node-replaceChild>replaceChild</code> and <code
title=dom-Node-appendChild>appendChild</code> methods.

<p>The <dfn title=dom-Attr-name><code>name</code></dfn> attribute must return
the <span title=concept-attribute-name>name</span> associated with the
<span>context object</span>.

<p>The <dfn title=dom-Attr-specified><code>specified</code></dfn> attribute must
return true.

<p>The <dfn title=dom-Attr-value><code>value</code></dfn> attribute must return the value of the <span>context object</span>'s
<code title=dom-Node-textContent>textContent</code> attribute and on
setting, must set the <span>context object</span>'s
<code title=dom-Node-textContent>textContent</code> attribute to the given
value.

<p>The <dfn title=dom-Attr-ownerElement><code>ownerElement</code></dfn>
attribute must return the <span title=concept-attribute-element>element</span>
associated with the <span>context object</span><!- -, if there is one, or null
otherwise [createAttribute]- ->.
-->


<h3 id="interface-element"><span class="secno">5.6 </span>Interface <code><a href="#element">Element</a></code></h3>
<pre class="idl">interface <dfn id="element">Element</dfn> : <a href="#node">Node</a> {
  readonly attribute DOMString <a href="#dom-element-namespaceuri" title="dom-Element-namespaceURI">namespaceURI</a>;
  readonly attribute DOMString <a href="#dom-element-prefix" title="dom-Element-prefix">prefix</a>;
  readonly attribute DOMString <a href="#dom-element-localname" title="dom-Element-localName">localName</a>;
  readonly attribute DOMString <a href="#dom-element-tagname" title="dom-Element-tagName">tagName</a>;

  readonly attribute <a href="#attr">Attr</a>[] <a href="#dom-element-attributes" title="dom-Element-attributes">attributes</a>;
  DOMString? <a href="#dom-element-getattribute" title="dom-Element-getAttribute">getAttribute</a>(DOMString <var title="">qualifiedName</var>);
  DOMString? <a href="#dom-element-getattributens" title="dom-Element-getAttributeNS">getAttributeNS</a>(DOMString <var title="">namespace</var>, DOMString <var title="">localName</var>);
  void <a href="#dom-element-setattribute" title="dom-Element-setAttribute">setAttribute</a>(DOMString <var title="">qualifiedName</var>, DOMString <var title="">value</var>);
  void <a href="#dom-element-setattributens" title="dom-Element-setAttributeNS">setAttributeNS</a>(DOMString <var title="">namespace</var>, DOMString <var title="">qualifiedName</var>, DOMString <var title="">value</var>);
  void <a href="#dom-element-removeattribute" title="dom-Element-removeAttribute">removeAttribute</a>(DOMString <var title="">qualifiedName</var>);
  void <a href="#dom-element-removeattributens" title="dom-Element-removeAttributeNS">removeAttributeNS</a>(DOMString <var title="">namespace</var>, DOMString <var title="">localName</var>);
  boolean <a href="#dom-element-hasattribute" title="dom-Element-hasAttribute">hasAttribute</a>(DOMString <var title="">qualifiedName</var>);
  boolean <a href="#dom-element-hasattributens" title="dom-Element-hasAttributeNS">hasAttributeNS</a>(DOMString <var title="">namespace</var>, DOMString <var title="">localName</var>);
<!--
  <span>Attr</span> <span title=dom-Element-getAttributeNode>getAttributeNode</span>(DOMString name);
  <span>Attr</span> <span title=dom-Element-getAttributeNodeNS>getAttributeNodeNS</span>(DOMString namespace, DOMString localName);
  <span>Attr</span> <span title=dom-Element-setAttributeNode>setAttributeNode</span>(Attr newAttr);
  <span>Attr</span> <span title=dom-Element-removeAttributeNode>removeAttributeNode</span>(Attr oldAttr);

  childElementCount - kill it?!
-->
  readonly attribute <a href="#htmlcollection">HTMLCollection</a> <a href="#dom-element-children" title="dom-Element-children">children</a>;
  <a href="#nodelist">NodeList</a> <a href="#dom-element-getelementsbytagname" title="dom-Element-getElementsByTagName">getElementsByTagName</a>(DOMString <var title="">qualifiedName</var>);
  <a href="#nodelist">NodeList</a> <a href="#dom-element-getelementsbytagnamens" title="dom-Element-getElementsByTagNameNS">getElementsByTagNameNS</a>(DOMString <var title="">namespace</var>, DOMString <var title="">localName</var>);
  <a href="#nodelist">NodeList</a> <a href="#dom-element-getelementsbyclassname" title="dom-Element-getElementsByClassName">getElementsByClassName</a>(DOMString <var title="">classNames</var>);
  readonly attribute <a href="#element">Element</a> <a href="#dom-element-firstelementchild" title="dom-Element-firstElementChild">firstElementChild</a>;
  readonly attribute <a href="#element">Element</a> <a href="#dom-element-lastelementchild" title="dom-Element-lastElementChild">lastElementChild</a>;
  readonly attribute <a href="#element">Element</a> <a href="#dom-element-previouselementsibling" title="dom-Element-previousElementSibling">previousElementSibling</a>;
  readonly attribute <a href="#element">Element</a> <a href="#dom-element-nextelementsibling" title="dom-Element-nextElementSibling">nextElementSibling</a>;<!--

  readonly attribute TypeInfo schemaTypeInfo;
  void setIdAttribute(DOMString name, boolean isId);
  void setIdAttributeNS(DOMString namespace, DOMString localName, boolean isId);
  void setIdAttributeNode(Attr idAttr, boolean isId);-->
};</pre>

<p><code><a href="#element">Element</a></code> objects are simply known as
<dfn id="concept-element" title="concept-element">elements</dfn>.</p>

<p><a href="#concept-element" title="concept-element">Elements</a> have an associated <dfn id="concept-element-namespace" title="concept-element-namespace">namespace</dfn>, <dfn id="concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</dfn>, <dfn id="concept-element-local-name" title="concept-element-local-name">local name</dfn>.

<p>When an <a href="#concept-element" title="concept-element">element</a> is created, its <a href="#concept-element-local-name" title="concept-element-local-name">local name</a> is always given. Unless explicitly given when an <a href="#concept-element" title="concept-element">element</a> is created, its <a href="#concept-element-namespace" title="concept-element-namespace">namespace</a> and <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a> are null.

<p><a href="#concept-element" title="concept-element">Elements</a> also have an associated
collection of <code><a href="#attr">Attr</a></code> objects, often called attributes.

<p><a href="#concept-element" title="concept-element">Elements</a> can have a
<dfn id="concept-id" title="concept-id">unique identifier (ID)</dfn> and
<dfn id="concept-class" title="concept-class">classes</dfn> associated with them.

<p class="XXX">I think rather than leaving this up to markup specifications we
should just state that id="" sets the ID and class="" sets the classes. We
can then also define Element.id, Element.className, and Element.classList
here. It would simplify a lot of stuff.

<hr>

<p>A <a href="#concept-node" title="concept-node">node</a>'s
<a href="#concept-tree-parent" title="concept-tree-parent">parent</a> of type
<code><a href="#element">Element</a></code> is known as a <dfn id="parent-element">parent element</dfn>. If the
<a href="#concept-node" title="concept-node">node</a> has a
<a href="#concept-tree-parent" title="concept-tree-parent">parent</a> of a different type, its
<a href="#parent-element">parent element</a> is null.</p>

<p>An <a href="#concept-element" title="concept-element">element</a> is known as the
<dfn id="document-element">document element</dfn> when its
<a href="#concept-tree-parent" title="concept-tree-parent">parent</a> is of type
<code><a href="#document">Document</a></code>.</p>

<p>When an <a href="#concept-element" title="concept-element">element</a> or one of its
<a href="#concept-tree-ancestor" title="concept-tree-ancestor">ancestors</a> is the
<a href="#document-element">document element</a>, it is <dfn id="in-a-document">in a <code>Document</code></dfn>.

<hr>

<p>Specifications may define <dfn id="base-url-change-steps">base URL change steps</dfn>.

<p>When an <a href="#concept-element" title="concept-element">element</a> is
<dfn id="affected-by-a-base-url-change">affected by a base URL change</dfn>, the user agent must run the
<a href="#base-url-change-steps">base URL change steps</a>, as defined in
<a href="#other-applicable-specifications">other applicable specifications</a>.

<hr>

<p>The <dfn id="dom-element-namespaceuri" title="dom-Element-namespaceURI"><code>namespaceURI</code></dfn>
attribute must return the <a href="#context-object">context object</a>'s
<a href="#concept-element-namespace" title="concept-element-namespace">namespace</a>.

<p>The <dfn id="dom-element-prefix" title="dom-Element-prefix"><code>prefix</code></dfn> attribute must return the <a href="#context-object">context object</a>'s
<a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a>.

<p>The <dfn id="dom-element-localname" title="dom-Element-localName"><code>localName</code></dfn>
attribute must return the <a href="#context-object">context object</a>'s
<a href="#concept-element-local-name" title="concept-element-local-name">local name</a>.

<p>The <dfn id="dom-element-tagname" title="dom-Element-tagName"><code>tagName</code></dfn> attribute
must run these steps:
<ol>
 <li><p>If <a href="#context-object">context object</a>'s
 <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a> is not
 null, let <var title="">qualified name</var> be its
 <a href="#concept-element-namespace-prefix" title="concept-element-namespace-prefix">namespace prefix</a>, followed
 by a "<code>:</code>" (U+003A), followed by its
 <a href="#concept-element-local-name" title="concept-element-local-name">local name</a>. Otherwise, let
 <var title="">qualified name</var> be its
 <a href="#concept-element-local-name" title="concept-element-local-name">local name</a>.

 <li><p>If the <a href="#context-object">context object</a> is in the <a href="#html-namespace">HTML namespace</a> and
 its <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is an
 <a href="#html-document">HTML document</a>, let <var title="">qualified name</var> be
 <a href="#converted-to-uppercase">converted to uppercase</a>.

 <li><p>Return <var title="">qualified name</var>.
</ol>

<hr>

<!-- all members in this subsection are affected by AttrExodus -->

<p>The <dfn id="dom-element-attributes" title="dom-Element-attributes"><code>attributes</code></dfn>
attribute must return a read only array<!--XXX WebIDL--> of the
<a href="#context-object">context object</a>'s associated <code><a href="#attr">Attr</a></code> objects.

<p>The <dfn id="dom-element-getattribute" title="dom-Element-getAttribute"><code>getAttribute(<var title="">name</var>)</code></dfn> method must run these steps:
<ol>
 <li><p>If the <a href="#context-object">context object</a> is in the
 <a href="#html-namespace">HTML namespace</a> and its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is an
 <a href="#html-document">HTML document</a>, let <var title="">name</var> be <a href="#converted-to-lowercase">converted to lowercase</a>.

 <li><p>Return the <a href="#concept-attr-value" title="concept-attr-value">value</a> of the first
 <code><a href="#attr">Attr</a></code> in the <a href="#context-object">context object</a>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> whose
 <a href="#concept-attr-qualified-name" title="concept-attr-qualified-name">qualified name</a> is
 <var title="">name</var>, if the <code><a href="#attr">Attr</a></code> is present, or null otherwise.
</ol>

<p>The
<dfn id="dom-element-getattributens" title="dom-Element-getAttributeNS"><code>getAttributeNS(<var title="">namespace</var>, <var title="">localName</var>)</code></dfn>
method must return the <a href="#concept-attr-value" title="concept-attr-value">value</a> of the
<code><a href="#attr">Attr</a></code> in the <a href="#context-object">context object</a>'s
<code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> whose
<a href="#concept-attr-namespace" title="concept-attr-namespace">namespace</a> is
<var title="">namespace</var> and
<a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
<var title="">localName</var>, if the <code><a href="#attr">Attr</a></code> is present, or null
otherwise.

<p>The
<dfn id="dom-element-setattribute" title="dom-Element-setAttribute"><code>setAttribute(<var title="">qualifiedName</var>, <var title="">value</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If <var title="">qualifiedName</var> does not match the
 <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Name">Name</a></code> production in XML, throw an
 <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.

 <li><p>If the <a href="#context-object">context object</a> is in the <a href="#html-namespace">HTML namespace</a>
 and its <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is an
 <a href="#html-document">HTML document</a>, let <var title="">qualifiedName</var> be
 <a href="#converted-to-lowercase">converted to lowercase</a>.

 <!-- https://bugzilla.mozilla.org/show_bug.cgi?id=315805 -->
 <li><p>If "<code title="">xmlns</code>" is a <a href="#prefix-match">prefix match</a> for
 <var title="">qualifiedName</var>, throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> and
 terminate these steps.

 <li><p>If the <a href="#context-object">context object</a> does not have an <code><a href="#attr">Attr</a></code>
 object whose <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
 <var title="">qualifiedName</var>, create an <code><a href="#attr">Attr</a></code> object, whose
 <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
 <var title="">qualifiedName</var> and <a href="#concept-attr-value" title="concept-attr-value">value</a>
 is <var title="">value</var>. Append this object to the
 <a href="#context-object">context object</a>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code>.

 <li><p>Otherwise, set the <a href="#concept-attr-value" title="concept-attr-value">value</a> of
 the first <code><a href="#attr">Attr</a></code> object in the <a href="#context-object">context object</a>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> whose
 <a href="#concept-attr-qualified-name" title="concept-attr-qualified-name">qualified name</a> is
 <var title="">qualifiedName</var>, to <var title="">value</var>.
</ol>

<p>The
<dfn id="dom-element-setattributens" title="dom-Element-setAttributeNS"><code>setAttributeNS(<var title="">namespace</var>, <var title="">qualifiedName</var>, <var title="">value</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If <var title="">qualifiedName</var> does not match the
 <code class="external"><a href="http://www.w3.org/TR/xml/#NT-Name">Name</a></code> production in XML, throw an
 <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.

 <li><p>If <var title="">qualifiedName</var> does not match the
 <code class="external"><a href="http://www.w3.org/TR/xml-names/#NT-QName">QName</a></code> production in Namespaces in XML,
 throw a <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code>
 exception and terminate these steps.

 <li><p>If <var title="">qualifiedName</var> contains a "<code>:</code>" (U+003E),
 then split the string on it and let <var title="">prefix</var> be the part before
 and <var title="">localName</var> the part after. Otherwise, let
 <var title="">prefix</var> be null and <var title="">localName</var> be
 <var title="">qualifiedName</var>.

 <li><p>If <var title="">namespace</var> is the empty string, let
 <var title="">namespace</var> be null.

 <li><p>If <var title="">prefix</var> is not null and <var title="">namespace</var> is
 null, throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception
 and terminate these steps.

 <li><p>If <var title="">prefix</var> is "<code title="">xml</code>" and
 <var title="">namespace</var> is not the <a href="#xml-namespace">XML namespace</a>, throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception
 and terminate these steps.

 <li><p>If <var title="">qualifiedName</var> or <var title="">prefix</var> is
 "<code title="">xmlns</code>" and <var title="">namespace</var> is not the
 <a href="#xmlns-namespace">XMLNS namespace</a>, throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception
 and terminate these steps.

 <li><p>If <var title="">namespace</var> is the <a href="#xmlns-namespace">XMLNS namespace</a> and
 neither <var title="">qualifiedName</var> nor <var title="">prefix</var> is
 "<code title="">xmlns</code>", throw a
 <code title="dom-DOMException-NAMESPACE_ERR"><a href="#dom-domexception-namespace_err">NAMESPACE_ERR</a></code> exception
 and terminate these steps.

 <li><p>If the <a href="#context-object">context object</a>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> does not contain an
 <code><a href="#attr">Attr</a></code> object whose
 <a href="#concept-attr-namespace" title="concept-attr-namespace">namespace</a> is
 <var title="">namespace</var> and
 <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
 <var title="">localName</var>, create an <code><a href="#attr">Attr</a></code> object, whose
 <a href="#concept-attr-namespace" title="concept-attr-namespace">namespace</a> is
 <var title="">namespace</var>,
 <a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a> is
 <var title="">prefix</var>, <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a>
 is <var title="">localName</var>, and <a href="#concept-attr-value" title="concept-attr-value">value</a>
 is <var title="">value</var>. Append this object to the
 <a href="#context-object">context object</a>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code>.

 <li><p>Otherwise, set the <a href="#concept-attr-value" title="concept-attr-value">value</a> of
 the <code><a href="#attr">Attr</a></code> object in the <a href="#context-object">context object</a>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> whose
 <a href="#concept-attr-namespace" title="concept-attr-namespace">namespace</a> is
 <var title="">namespace</var>, and
 <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
 <var title="">localName</var>, to <var title="">value</var>, and set its
 <a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a> to
 <var title="">prefix</var>.
</ol>

<p>The
<dfn id="dom-element-removeattribute" title="dom-Element-removeAttribute"><code>removeAttribute(<var title="">qualifiedName</var>)</code></dfn>
method must run the following steps:
<ol>
 <li><p>If the <a href="#context-object">context object</a> is in the <a href="#html-namespace">HTML namespace</a>
 and its <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is an
 <a href="#html-document">HTML document</a>, let <var title="">qualifiedName</var> be
 <a href="#converted-to-lowercase">converted to lowercase</a>.

 <li><p>Remove the first <code><a href="#attr">Attr</a></code> object in the
 <a href="#context-object">context object</a>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> whose
 <a href="#concept-attr-qualified-name" title="concept-attr-qualified-name">qualified name</a> is
 <var title="">qualifiedName</var>.
</ol>

<p>The
<dfn id="dom-element-removeattributens" title="dom-Element-removeAttributeNS"><code>removeAttributeNS(<var title="">namespace</var>, <var title="">localName</var>)</code></dfn>
method must remove the <code><a href="#attr">Attr</a></code> object in the
<a href="#context-object">context object</a>'s
<code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> whose
<a href="#concept-attr-namespace" title="concept-attr-namespace">namespace</a> is
<var title="">namespace</var> and
<a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
<var title="">localName</var>

<p>The
<dfn id="dom-element-hasattribute" title="dom-Element-hasAttribute"><code>hasAttribute(<var title="">qualifiedName</var>)</code></dfn>
method must run these steps:
<ol>
 <li><p>If the <a href="#context-object">context object</a> is in the
 <a href="#html-namespace">HTML namespace</a> and its
 <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> is an
 <a href="#html-document">HTML document</a>, let <var title="">qualifiedName</var> be
 <a href="#converted-to-lowercase">converted to lowercase</a>.

 <li><p>Return true if <a href="#context-object">context object</a>'s
 <code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> contains an
 <code><a href="#attr">Attr</a></code> whose
 <a href="#concept-attr-qualified-name" title="concept-attr-qualified-name">qualified name</a> is
 <var title="">qualifiedName</var>, or false otherwise.
</ol>

<p>The
<dfn id="dom-element-hasattributens" title="dom-Element-hasAttributeNS"><code>hasAttributeNS(<var title="">namespace</var>, <var title="">localName</var>)</code></dfn>
method must return true if <a href="#context-object">context object</a>'s
<code title="dom-Element-attributes"><a href="#dom-element-attributes">attributes</a></code> contains an
<code><a href="#attr">Attr</a></code> whose <a href="#concept-attr-namespace" title="concept-attr-namespace">namespace</a>
is <var title="">namespace</var> and
<a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is
<var title="">localName</var>, or false otherwise.

<!--<dfn title=dom-Element-getAttributeNode>getAttributeNode</dfn>: when the
Element.getAttributeNode() method is invoked on an HTML element, the name
argument must be converted to ASCII lowercase before the element's attributes
are examined. (In HTML documents.) -->

<!-- <dfn title=dom-Element-setAttributeNode>setAttributeNode</dfn>: when an
Attr node is set on an HTML element using Element.setAttributeNode(), it must
have its name converted to ASCII lowercase before the element is affected.
(In HTML documents.) -->

<hr>

<p>The <dfn id="dom-element-children" title="dom-Element-children"><code>children</code></dfn> attribute
must return an <code><a href="#htmlcollection">HTMLCollection</a></code>
<a href="#concept-collection" title="concept-collection">collection</a>, rooted at the
<a href="#context-object">context object</a>, whose filter matches only
<a href="#concept-element" title="concept-element">elements</a> whose <a href="#concept-tree-parent" title="concept-tree-parent">parent</a> is the
<a href="#context-object">context object</a>.

<p>When the
<dfn id="dom-element-getelementsbytagname" title="dom-Element-getElementsByTagName"><code>getElementsByTagName(<var title="">qualifiedName</var>)</code></dfn>
method is invoked it must return a
<a href="#concept-collection-live" title="concept-collection-live">live</a> <code><a href="#nodelist">NodeList</a></code> with
the <a href="#concept-element" title="concept-element">elements</a> that the
<code title="dom-Document-getElementsByTagName"><a href="#dom-document-getelementsbytagname">getElementsByTagName</a></code>
method would return when called on the <a href="#context-object">context object</a>'s
<code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> and passed the same
argument, excluding any <a href="#concept-element" title="concept-element">elements</a> that are
not <a href="#concept-tree-descendant" title="concept-tree-descendant">descendants</a> of the
<a href="#context-object">context object</a> on which the method was invoked.
<p>When invoked with the same argument the same <code><a href="#nodelist">NodeList</a></code> object
may be returned as returned by an earlier call.


<p>When the
<dfn id="dom-element-getelementsbytagnamens" title="dom-Element-getElementsByTagNameNS"><code>getElementsByTagNameNS(<var title="">namespace</var>, <var title="">localName</var>)</code></dfn>
method is invoked it must return a
<a href="#concept-collection-live" title="concept-collection-live">live</a> <code><a href="#nodelist">NodeList</a></code> with
the <a href="#concept-element" title="concept-element">elements</a> that the
<code title="dom-Document-getElementsByTagNameNS"><a href="#dom-document-getelementsbytagnamens">getElementsByTagNameNS</a></code>
method would return when called on the <a href="#context-object">context object</a>'s
<code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> and
passed the same arguments, excluding any
<a href="#concept-element" title="concept-element">elements</a> that are
not <a href="#concept-tree-descendant" title="concept-tree-descendant">descendants</a> of the
<a href="#context-object">context object</a> on which the method was invoked.
<p>When invoked with the same argument the same <code><a href="#nodelist">NodeList</a></code> object
may be returned as returned by an earlier call.


<p>When the
<dfn id="dom-element-getelementsbyclassname" title="dom-Element-getElementsByClassName"><code>getElementsByClassName(<var title="">classNames</var>)</code></dfn>
method is invoked it must return a <a href="#concept-collection-live" title="concept-collection-live">live</a>
<code><a href="#nodelist">NodeList</a></code> with the <a href="#concept-element" title="concept-element">elements</a>
that the <code title="dom-Document-getElementsByClassName"><a href="#dom-document-getelementsbyclassname">getElementsByClassName</a></code>
method would return when called on the <a href="#context-object">context object</a>'s
<code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> and
passed the same argument, excluding any
<a href="#concept-element" title="concept-element">elements</a> that are not
<a href="#concept-tree-descendant" title="concept-tree-descendant">descendants</a> of the
<a href="#context-object">context object</a> on which the method was invoked.
<p>When invoked with the same argument the same <code><a href="#nodelist">NodeList</a></code> object
may be returned as returned by an earlier call.

<p>The
<dfn id="dom-element-firstelementchild" title="dom-Element-firstElementChild"><code>firstElementChild</code></dfn>
attribute must return the first <a href="#concept-tree-child" title="concept-tree-child">child</a>
of the <a href="#context-object">context object</a> that is of type <code><a href="#element">Element</a></code> or
null if there is no such <a href="#concept-node" title="concept-node">node</a>.

<p>The
<dfn id="dom-element-lastelementchild" title="dom-Element-lastElementChild"><code>lastElementChild</code></dfn>
attribute must return the last <a href="#concept-tree-child" title="concept-tree-child">child</a>
of the <a href="#context-object">context object</a> that is of type <code><a href="#element">Element</a></code> or
null if there is no such <a href="#concept-node" title="concept-node">node</a>.

<p>The
<dfn id="dom-element-previouselementsibling" title="dom-Element-previousElementSibling"><code>previousElementSibling</code></dfn>
attribute must return the first
<a href="#concept-tree-preceding-sibling" title="concept-tree-preceding-sibling">preceding sibling</a> of the
<a href="#context-object">context object</a> that is of type <code><a href="#element">Element</a></code> or null if
there is no such <a href="#concept-node" title="concept-node">node</a>.

<p>The
<dfn id="dom-element-nextelementsibling" title="dom-Element-nextElementSibling"><code>nextElementSibling</code></dfn>
attribute must return the first
<a href="#concept-tree-following-sibling" title="concept-tree-following-sibling">following sibling</a> of the
<a href="#context-object">context object</a> that is of type <code><a href="#element">Element</a></code> or null if
there is no such <a href="#concept-node" title="concept-node">node</a>.


<h4 id="interface-attr"><span class="secno">5.6.1 </span>Interface <code><a href="#attr">Attr</a></code></h4>
<pre class="idl">interface <dfn id="attr">Attr</dfn> {
  readonly attribute DOMString? <a href="#dom-attr-namespaceuri" title="dom-Attr-namespaceURI">namespaceURI</a>;
  readonly attribute DOMString? <a href="#dom-attr-prefix" title="dom-Attr-prefix">prefix</a>;
  readonly attribute DOMString <a href="#dom-attr-localname" title="dom-Attr-localName">localName</a>;
  readonly attribute DOMString <a href="#dom-attr-name" title="dom-Attr-name">name</a>;
           attribute DOMString <a href="#dom-attr-value" title="dom-Attr-value">value</a>;
};</pre>

<p>Just like <a href="#concept-element" title="concept-element">elements</a>, <code><a href="#attr">Attr</a></code> objects have an associated <dfn id="concept-attr-namespace" title="concept-attr-namespace">namespace</dfn>, <dfn id="concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</dfn>, <dfn id="concept-attr-local-name" title="concept-attr-local-name">local name</dfn>, and <dfn id="concept-attr-qualified-name" title="concept-attr-qualified-name">qualified name</dfn>.

<p>When an <code><a href="#attr">Attr</a></code> object is created its <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a> is always given. Unless explicitly given when an <code><a href="#attr">Attr</a></code> object is created, its <a href="#concept-attr-namespace" title="concept-attr-namespace">namespace</a> and <a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a> are null and its <a href="#concept-attr-qualified-name" title="concept-attr-qualified-name">qualified name</a> is its <a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a>, followed by a "<code>:</code>" (U+003A), followed by its <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a>, if its <a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a> is not null, or otherwise <a href="#concept-attr-qualified-name" title="concept-attr-qualified-name">qualified name</a> is just its <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a>.

<p><code><a href="#attr">Attr</a></code> objects also have an associated
<dfn id="concept-attr-value" title="concept-attr-value">value</dfn>, which is always given when an
<code><a href="#attr">Attr</a></code> object is created.

<hr>

<p>The <dfn id="dom-attr-namespaceuri" title="dom-Attr-namespaceURI"><code>namespaceURI</code></dfn>
attribute must return the
<a href="#concept-attr-namespace" title="concept-attr-namespace">namespace</a>.

<p>The <dfn id="dom-attr-prefix" title="dom-Attr-prefix"><code>prefix</code></dfn> attribute must
return the
<a href="#concept-attr-namespace-prefix" title="concept-attr-namespace-prefix">namespace prefix</a>.

<p>The <dfn id="dom-attr-localname" title="dom-Attr-localName"><code>localName</code></dfn> attribute
must return the <a href="#concept-attr-local-name" title="concept-attr-local-name">local name</a>.

<p>The <dfn id="dom-attr-name" title="dom-Attr-name"><code>name</code></dfn> attribute must
return the <a href="#concept-attr-qualified-name" title="concept-attr-qualified-name">qualified name</a>.

<p>The <dfn id="dom-attr-value" title="dom-Attr-value"><code>value</code></dfn> attribute must
return the <a href="#concept-attr-value" title="concept-attr-value">value</a>.

<p>Setting the <code title="dom-Attr-value"><a href="#dom-attr-value">value</a></code> attribute must set
<a href="#concept-attr-value" title="concept-attr-value">value</a> to the given value.

<h3 id="interface-documenttype"><span class="secno">5.7 </span>Interface <code><a href="#documenttype">DocumentType</a></code></h3>
<pre class="idl">interface <dfn id="documenttype">DocumentType</dfn> : <a href="#node">Node</a> {
  readonly attribute DOMString <a href="#dom-documenttype-name" title="dom-DocumentType-name">name</a>;<!--
  readonly attribute NamedNodeMap entities;
  readonly attribute NamedNodeMap notations;-->
  readonly attribute DOMString <a href="#dom-documenttype-publicid" title="dom-DocumentType-publicId">publicId</a>;
  readonly attribute DOMString <a href="#dom-documenttype-systemid" title="dom-DocumentType-systemId">systemId</a>;<!--
  readonly attribute DOMString internalSubset;-->
};</pre>

<p><code><a href="#documenttype">DocumentType</a></code> nodes have an associated <dfn id="concept-doctype-name" title="concept-doctype-name">name</dfn>, <dfn id="concept-doctype-publicid" title="concept-doctype-publicid">public ID</dfn>, and <dfn id="concept-doctype-systemid" title="concept-doctype-systemid">system ID</dfn>.

<p>When a <code><a href="#documenttype">DocumentType</a></code> node is created, its <a href="#concept-doctype-name" title="concept-doctype-name">name</a> is always given. Unless explicitly given when a <code><a href="#documenttype">DocumentType</a></code> node is created, its <a href="#concept-doctype-publicid" title="concept-doctype-publicid">public ID</a> and <a href="#concept-doctype-systemid" title="concept-doctype-systemid">system ID</a> are the empty string.

<p>The <dfn id="dom-documenttype-name" title="dom-DocumentType-name"><code>name</code></dfn> attribute must return the <a href="#context-object">context object</a>'s <a href="#concept-doctype-name" title="concept-doctype-name">name</a>.

<p>The <dfn id="dom-documenttype-publicid" title="dom-DocumentType-publicId"><code>publicId</code></dfn>
attribute must return the <a href="#context-object">context object</a>'s <a href="#concept-doctype-publicid" title="concept-doctype-publicid">public ID</a>.

<p>The <dfn id="dom-documenttype-systemid" title="dom-DocumentType-systemId"><code>systemId</code></dfn>
attribute must return the <a href="#context-object">context object</a>'s <a href="#concept-doctype-systemid" title="concept-doctype-systemid">system ID</a>.


<h3 id="interface-processinginstruction"><span class="secno">5.8 </span>Interface <code><a href="#processinginstruction">ProcessingInstruction</a></code></h3>
<pre class="idl">interface <dfn id="processinginstruction">ProcessingInstruction</dfn> : <a href="#node">Node</a> {
  readonly attribute DOMString <a href="#dom-processinginstruction-target" title="dom-ProcessingInstruction-target">target</a>;
           attribute DOMString <a href="#dom-processinginstruction-data" title="dom-ProcessingInstruction-data">data</a>;
};</pre>

<p><code><a href="#processinginstruction">ProcessingInstruction</a></code> nodes have an associated <dfn id="concept-pi-target" title="concept-PI-target">target</dfn> and <dfn id="concept-pi-data" title="concept-PI-data">data</dfn>. When a <code><a href="#processinginstruction">ProcessingInstruction</a></code> node is created both are given.

<p>The <dfn id="dom-processinginstruction-target" title="dom-ProcessingInstruction-target"><code>target</code></dfn>
attribute must return the <a href="#context-object">context object</a>'s <a href="#concept-pi-target" title="concept-PI-target">target</a>.

<p>The <dfn id="dom-processinginstruction-data" title="dom-ProcessingInstruction-data"><code>data</code></dfn>
attribute must return the <a href="#context-object">context object</a>'s <a href="#concept-pi-data" title="concept-PI-data">data</a>, and on setting, set the
<a href="#context-object">context object</a>'s <a href="#concept-pi-data" title="concept-PI-data">data</a> to the new value.


<h3 id="interface-characterdata"><span class="secno">5.9 </span>Interface <code><a href="#characterdata">CharacterData</a></code></h3>
<pre class="idl">interface <dfn id="characterdata">CharacterData</dfn> : <a href="#node">Node</a> {
  [TreatNullAs=EmptyString] attribute DOMString <a href="#dom-characterdata-data" title="dom-CharacterData-data">data</a>;
  readonly attribute unsigned long <a href="#dom-characterdata-length" title="dom-CharacterData-length">length</a>;
  DOMString <a href="#dom-characterdata-substringdata" title="dom-CharacterData-substringData">substringData</a>(unsigned long <var title="">offset</var>, unsigned long <var title="">count</var>);
  void <a href="#dom-characterdata-appenddata" title="dom-CharacterData-appendData">appendData</a>(DOMString <var title="">data</var>);
  void <a href="#dom-characterdata-insertdata" title="dom-CharacterData-insertData">insertData</a>(unsigned long <var title="">offset</var>, DOMString <var title="">data</var>);
  void <a href="#dom-characterdata-deletedata" title="dom-CharacterData-deleteData">deleteData</a>(unsigned long <var title="">offset</var>, unsigned long <var title="">count</var>);
  void <a href="#dom-characterdata-replacedata" title="dom-CharacterData-replaceData">replaceData</a>(unsigned long <var title="">offset</var>, unsigned long <var title="">count</var>, DOMString <var title="">data</var>);
};</pre>

<p>The <dfn id="dom-characterdata-data" title="dom-CharacterData-data"><code>data</code></dfn> attribute must return the data of the node, and on setting, must change the node's data to the new value.

<p>The <dfn id="dom-characterdata-length" title="dom-CharacterData-length"><code>length</code></dfn> attribute must return the number of UTF-16 code units represented by the node's data.

<p>The
<dfn id="dom-characterdata-substringdata" title="dom-CharacterData-substringData"><code>substringData(<var title="">offset</var>, <var title="">count</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>If <var title="">offset</var> is greater than the
 <a href="#context-object">context object</a>'s <code title="dom-CharacterData-length"><a href="#dom-characterdata-length">length</a></code>,
 throw an <code title="dom-DOMException-INDEX_SIZE_ERR"><a href="#dom-domexception-index_size_err">INDEX_SIZE_ERR</a></code>
 exception and terminate these steps.

 <li><p>If <span title=""><var title="">offset</var>+<var title="">count</var></span> is
 greater than the <a href="#context-object">context object</a>'s <code title="dom-CharacterData-length"><a href="#dom-characterdata-length">length</a></code>, return a <code class="external"><a href="#domstring">DOMString</a></code> whose value is the UTF-16 code units
 from the <var title="">offset</var>th UTF-16 code unit to the end of <var title="">data</var>.

 <li><p>Return a <code class="external"><a href="#domstring">DOMString</a></code> whose value is
 the UTF-16 code units from the <var title="">offset</var>th UTF-16 code unit to
 the <span title=""><var title="">offset</var>+<var title="">count</var></span>th UTF-16
 code unit in <var title="">data</var>.
</ol>

<p>The <dfn id="dom-characterdata-appenddata" title="dom-CharacterData-appendData"><code>appendData(<var title="">data</var>)</code></dfn> method must append <var title="">data</var> to the <a href="#context-object">context object</a>'s data.

<p>The <dfn id="dom-characterdata-insertdata" title="dom-CharacterData-insertData"><code>insertData(<var title="">offset</var>, <var title="">data</var>)</code></dfn> method must run these steps:

<ol>
 <li><p>If <var title="">offset</var> is greater than the <a href="#context-object">context object</a>'s
 <code title="dom-CharacterData-length"><a href="#dom-characterdata-length">length</a></code>, throw an
 <code title="dom-DOMException-INDEX_SIZE_ERR"><a href="#dom-domexception-index_size_err">INDEX_SIZE_ERR</a></code> exception
 and terminate these steps.

 <li><p>Insert <var title="">data</var> into the <a href="#context-object">context object</a>'s data
 after <var title="">offset</var> UTF-16 code units.
</ol>

<p>The <dfn id="dom-characterdata-deletedata" title="dom-CharacterData-deleteData"><code>deleteData(<var title="">offset</var>, <var title="">count</var>)</code></dfn> method must run these steps:

<ol>
 <li><p>If <var title="">offset</var> is greater than the <a href="#context-object">context object</a>'s
 <code title="dom-CharacterData-length"><a href="#dom-characterdata-length">length</a></code>, throw an
 <code title="dom-DOMException-INDEX_SIZE_ERR"><a href="#dom-domexception-index_size_err">INDEX_SIZE_ERR</a></code> exception
 and terminate these steps.

 <li><p>If <var title="">offset</var>+<var title="">count</var> is greater than the
 <a href="#context-object">context object</a>'s
 <code title="dom-CharacterData-length"><a href="#dom-characterdata-length">length</a></code> let <var title="">count</var> be
 <code title="dom-CharacterData-length"><a href="#dom-characterdata-length">length</a></code>-<var title="">offset</var>.

 <li><p>Starting from <var title="">offset</var> UTF-16 code units remove
 <var title="">count</var> UTF-16 code units from the <a href="#context-object">context object</a>'s
 data.
</ol>

<p>The
<dfn id="dom-characterdata-replacedata" title="dom-CharacterData-replaceData"><code>replaceData(<var title="">offset</var>, <var title="">count</var>, <var title="">data</var>)</code></dfn>
method must act as if the
<code title="dom-CharacterData-deleteData"><a href="#dom-characterdata-deletedata">deleteData()</a></code> method is invoked
with <var title="">offset</var> and <var title="">count</var> as arguments followed by
the <code title="dom-CharacterData-insertData"><a href="#dom-characterdata-insertdata">insertData()</a></code> method with
<var title="">offset</var> and <var title="">data</var> as arguments and re-throw any
exceptions these methods might have thrown.


<h3 id="interface-text"><span class="secno">5.10 </span>Interface <code><a href="#text">Text</a></code></h3>
<pre class="idl">interface <dfn id="text">Text</dfn> : <a href="#characterdata">CharacterData</a> {
  <a href="#text">Text</a> <a href="#dom-text-splittext" title="dom-Text-splitText">splitText</a>(unsigned long <var title="">offset</var>);<!--
  readonly attribute boolean isElementContentWhitespace;-->
  readonly attribute DOMString <a href="#dom-text-wholetext" title="dom-Text-wholeText">wholeText</a>;
  <a href="#text">Text</a> <a href="#dom-text-replacewholetext" title="dom-Text-replaceWholeText">replaceWholeText</a>(DOMString <var title="">data</var>);
};</pre>

<p>The
<dfn id="dom-text-splittext" title="dom-Text-splitText"><code>splitText(<var title="">offset</var>)</code></dfn>
method must run the following steps:

<ol>
  <li>If <var title="">offset</var> is greater than the <a href="#context-object">context object</a>'s
  <code title="dom-CharacterData-length"><a href="#dom-characterdata-length">length</a></code>, throw an
  <code title="dom-DOMException-INDEX_SIZE_ERR"><a href="#dom-domexception-index_size_err">INDEX_SIZE_ERR</a></code> exception
  and terminate these steps.

  <li>Let <var title="">length</var> be the <a href="#context-object">context object</a>'s
  <span title=""><code title="dom-CharacterData-length"><a href="#dom-characterdata-length">length</a></code> &minus;
  <var title="">offset</var></span>.

  <li>Call the <a href="#context-object">context object</a>'s
  <code title="dom-CharacterData-substringData"><a href="#dom-characterdata-substringdata">substringData</a></code> method with
  <var title="">offset</var> and <var title="">length</var> as its arguments.
  If this threw an exception, terminate these steps. Otherwise, let
  <var title="">new data</var> be the value returned.

  <li>Call the <a href="#context-object">context object</a>'s
  <code title="dom-CharacterData-deleteData"><a href="#dom-characterdata-deletedata">deleteData</a></code> method with
  <var title="">offset</var> and <var title="">length</var> as its arguments.
  If this threw an exception, terminate these steps.

  <li>Let <var title="">new node</var> be a new <code><a href="#text">Text</a></code> object, with the
  same <code title="dom-Node-ownerDocument"><a href="#dom-node-ownerdocument">ownerDocument</a></code> as the
  <a href="#context-object">context object</a>. Set <var title="">new node</var>'s
  <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> to <var title="">new data</var>.

  <li>Let <var title="">parent</var> be the <a href="#context-object">context object</a>'s
  <a href="#concept-tree-parent" title="concept-tree-parent">parent</a>. If <var title="">parent</var>
  is null, return <var title="">new node</var> and terminate these steps.

  <li>Call <var title="">parent</var>'s
  <code title="dom-Node-insertBefore"><a href="#dom-node-insertbefore">insertBefore</a></code> method with
  <var title="">new node</var> and the <a href="#context-object">context object</a>'s first
  <span title="concept-tree-next-sibling">next sibling as its argument.

  </span><li>Return <var title="">new node</var>.
</ol>

<p>The <dfn id="contiguous-text-nodes">contiguous <code>Text</code> nodes</dfn> of a node are the node
itself, the previous sibling <code><a href="#text">Text</a></code> node (if any) and its
<a href="#contiguous-text-nodes">contiguous <code>Text</code> nodes</a>, and the next sibling
<code><a href="#text">Text</a></code> node (if any) and its
<a href="#contiguous-text-nodes">contiguous <code>Text</code> nodes</a>, avoiding any
duplicates.

<p>The <dfn id="dom-text-wholetext" title="dom-Text-wholeText"><code>wholeText</code></dfn>
attribute must return a concatenation of the
<code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> of the
<a href="#contiguous-text-nodes">contiguous <code>Text</code> nodes</a> of the
<a href="#context-object">context object</a>, in <a href="#tree-order">tree order</a>.

<p>The
<dfn id="dom-text-replacewholetext" title="dom-Text-replaceWholeText"><code>replaceWholeText(<var title="">data</var>)</code></dfn>
method must run these steps:

<ol>
 <li><p>Remove the <a href="#contiguous-text-nodes">contiguous <code>Text</code> nodes</a> of the
 <a href="#context-object">context object</a>.
 <li><p>If <var title="">data</var> is not the empty string, insert a new
 <code><a href="#text">Text</a></code> node whose
 <code title="dom-CharacterData-data"><a href="#dom-characterdata-data">data</a></code> is <var title="">data</var> at the
 place of the removed nodes, return the new <code><a href="#text">Text</a></code> node, and
 then terminate these steps.
 <li><p>Return null.
</ol>

<p class="XXX">Can we remove replaceWholeText() in favor of making wholeText no longer readonly? Do we even need this wholeText business?

<!-- isElementContentWhitespace: Mozilla returns true if the node contains only
space, tab, newline -->


<h3 id="interface-comment"><span class="secno">5.11 </span>Interface <code><a href="#comment">Comment</a></code></h3>
<pre class="idl">interface <dfn id="comment">Comment</dfn> : <a href="#characterdata">CharacterData</a> {
};</pre>



<h2 id="collections"><span class="secno">6 </span>Collections</h2>
<p>A <dfn id="concept-collection" title="concept-collection">collection</dfn> is an object that
represents a lists of DOM nodes. A
<a href="#concept-collection" title="concept-collection">collection</a> can be either
<dfn id="concept-collection-live" title="concept-collection-live">live</dfn> or
<dfn id="concept-collection-static" title="concept-collection-static">static</dfn>. Unless otherwise stated,
a <a href="#concept-collection" title="concept-collection">collection</a> must be
<a href="#concept-collection-live" title="concept-collection-live">live</a>.

<p>If a <a href="#concept-collection" title="concept-collection">collection</a> is <a href="#concept-collection-live" title="concept-collection-live">live</a>, then the attributes and methods
on that object must operate on the actual underlying data, not a snapshot of
the data.

<p>When a <a href="#concept-collection" title="concept-collection">collection</a> is created, a
filter and a root are associated with it.

<p>The <a href="#concept-collection" title="concept-collection">collection</a> then
<dfn id="represented-by-the-collection" title="represented by the collection">represents</dfn> a view of the
subtree rooted at the <a href="#concept-collection" title="concept-collection">collection's</a>
root, containing only nodes that match the given filter. The view is linear.
In the absence of specific requirements to the contrary, the nodes within
the <a href="#concept-collection" title="concept-collection">collection</a> must be sorted in
<a href="#tree-order">tree order</a>.

<p>An attribute that returns a
<a href="#concept-collection-live" title="concept-collection-live">live</a>
<a href="#concept-collection" title="concept-collection">collection</a> must return the same object
every time it is retrieved.


<h3 id="interface-nodelist"><span class="secno">6.1 </span>Interface <code><a href="#nodelist">NodeList</a></code></h3>
<p>A <code><a href="#nodelist">NodeList</a></code> object is a kind of
<a href="#concept-collection" title="concept-collection">collection</a>.

<pre class="idl">interface <dfn id="nodelist">NodeList</dfn> {
  getter <a href="#node">Node</a> <a href="#dom-nodelist-item" title="dom-NodeList-item">item</a>(unsigned long index);
  readonly attribute unsigned long <a href="#dom-nodelist-length" title="dom-NodeList-length">length</a>;
};</pre>

<dl class="domintro">
 <dt><var title="">collection</var> . <code title="dom-NodeList-length"><a href="#dom-nodelist-length">length</a></code>
 <dd>
  <p>Returns the number of elements in the collection.

 <dt><var title="">element</var> = <var title="">collection</var> . <code title="dom-NodeList-item"><a href="#dom-nodelist-item">item</a></code>(<var title="">index</var>)
 <dt><var title="">element</var> = <var title="">collection</var>[<var title="">index</var>]
 <dd>
  <p>Returns the item with index <var title="">index</var> from the collection. The items are sorted in <a href="#tree-order">tree order</a>.
  <p>Returns null if <var title="">index</var> is out of range.
</dl>

<div class="impl">

<p>The object's <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>
are the numbers in the range zero to one less than the number of nodes
<a href="#represented-by-the-collection">represented by the collection</a>. If there are no such elements, then
there are no <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>.

<p>The <dfn id="dom-nodelist-length" title="dom-NodeList-length"><code>length</code></dfn> attribute must
return the number of nodes <a href="#represented-by-the-collection">represented by the collection</a>.

<p>The <dfn id="dom-nodelist-item" title="dom-NodeList-item"><code>item(<var title="">index</var>)</code></dfn> method must return the <var title="">index</var>th
node in the <a href="#concept-collection" title="concept-collection">collection</a>. If there is no
<var title="">index</var>th node in the <a href="#concept-collection" title="concept-collection">collection</a>, then the method must return null.

</div>


<h3 id="interface-htmlcollection"><span class="secno">6.2 </span>Interface <code><a href="#htmlcollection">HTMLCollection</a></code></h3>
<p>The <code><a href="#htmlcollection">HTMLCollection</a></code> interface represents a generic <a href="#concept-collection" title="concept-collection">collection</a> of elements.

<p class="note">This interface is called <code><a href="#htmlcollection">HTMLCollection</a></code> for
historical reasons. The various getters on this interface return <code class="external"><a href="http://dev.w3.org/2006/webapi/WebIDL/#idl-object">object</a></code> for interfaces that inherit from
it, which return other objects for historical reasons.

<pre class="idl">interface <dfn id="htmlcollection">HTMLCollection</dfn> {
  readonly attribute unsigned long <a href="#dom-htmlcollection-length" title="dom-HTMLCollection-length">length</a>;
  getter <a href="#element">Element</a> <a href="#dom-htmlcollection-item" title="dom-HTMLCollection-item">item</a>(unsigned long index);
  getter object <a href="#dom-htmlcollection-nameditem" title="dom-HTMLCollection-namedItem">namedItem</a>(DOMString name); // only returns <code><a href="#element">Element</a></code>
};</pre>

<dl class="domintro">
 <dt><var title="">collection</var> . <code title="dom-HTMLCollection-length"><a href="#dom-htmlcollection-length">length</a></code>
 <dd>
  <p>Returns the number of elements in the collection.

 <dt><var title="">element</var> = <var title="">collection</var> . <code title="dom-HTMLCollection-item"><a href="#dom-htmlcollection-item">item</a></code>(<var title="">index</var>)
 <dt><var title="">element</var> = <var title="">collection</var>[<var title="">index</var>]
 <dd>
  <p>Returns the item with index <var title="">index</var> from the collection. The items are sorted in <a href="#tree-order">tree order</a>.
  <p>Returns null if <var title="">index</var> is out of range.

 <dt><var title="">element</var> = <var title="">collection</var> . <code title="dom-HTMLCollection-namedItem"><a href="#dom-htmlcollection-nameditem">namedItem</a></code>(<var title="">name</var>)
 <dt><var title="">element</var> = <var title="">collection</var>[<var title="">name</var>]
 <dd>
  <p>Returns the first item with <a href="#concept-id" title="concept-id">ID</a> or name <var title="">name</var>
  from the collection.
  <p>Returns null if no element with that <a href="#concept-id" title="concept-id">ID</a> or name could be found.
  <p>Only <code title="">a</code>, <code title="">applet</code>,
  <code title="">area</code>, <code title="">embed</code>,
  <code title="">form</code>, <code title="">frame</code>,
  <code title="">frameset</code>, <code title="">iframe</code>,
  <code title="">img</code>, and <code title="">object</code> elements in the
  <a href="#html-namespace">HTML namespace</a> can have a name for the purpose of this
  method; their name is given by the value of their
  <code title="">name</code> attribute.
</dl>

<div class="impl">

<p>The object's <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>
are the numbers in the range zero to one less than the number of nodes
<a href="#represented-by-the-collection">represented by the collection</a>. If there are no such elements, then
there are no <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>.

<p>The <dfn id="dom-htmlcollection-length" title="dom-HTMLCollection-length"><code>length</code></dfn> attribute
must return the number of nodes <a href="#represented-by-the-collection">represented by the collection</a>.

<p>The <dfn id="dom-htmlcollection-item" title="dom-HTMLCollection-item"><code>item(<var title="">index</var>)</code></dfn> method must return the <var title="">index</var>th node in the collection. If there is no <var title="">index</var>th node in the collection, then the method must
return null.

<p>The <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-names">supported property names</a> consist
of the values of the <code title="">name</code> attributes of each <code title="">a</code>, <code title="">applet</code>, <code title="">area</code>, <code title="">embed</code>, <code title="">form</code>, <code title="">frame</code>, <code title="">frameset</code>, <code title="">iframe</code>, <code title="">img</code>, and
<code title="">object</code> element in the <a href="#html-namespace">HTML namespace</a>,
<a href="#represented-by-the-collection">represented by the collection</a> with a <code title="">name</code>
attribute, plus the list of <a href="#concept-id" title="concept-id">IDs</a> that the elements
<a href="#represented-by-the-collection">represented by the collection</a> have.

<p>The
<dfn id="dom-htmlcollection-nameditem" title="dom-HTMLCollection-namedItem"><code>namedItem(<var title="">key</var>)</code></dfn>
method must return the first node in the
<a href="#concept-collection" title="concept-collection">collection</a> that falls into one of the
following categories:

<ul>
 <li>It is an <code title="">a</code>, <code title="">applet</code>, <code title="">area</code>, <code title="">embed</code>, <code title="">form</code>, <code title="">frame</code>, <code title="">frameset</code>, <code title="">iframe</code>,
 <code title="">img</code>, or <code title="">object</code> element, in the <a href="#html-namespace">HTML
 namespace</a>, with a <code title="">name</code> attribute equal to <var title="">key</var>, or,

 <li>It is an element with an <a href="#concept-id" title="concept-id">ID</a>
 equal to <var title="">key</var>.
</ul>

<p>If no such elements are found, then the method must return
null.

</div>


<!-- AttrExodus
<h3>Interface <code>NamedNodeMap</code></h3>
<p>Since <code title=dom-Node-attributes>attributes</code> is the
only remaining API using this interface and the tentative plan is to change
<code>Attr</code> we also plan to remove this interface and replace it with
a lightweight <code>AttrMap</code> or some such &mdash;
<a href=http://lists.w3.org/Archives/Public/public-webapps/2010JulSep/0797.html>http://lists.w3.org/Archives/Public/public-webapps/2010JulSep/0797.html</a>

<p>A <code>NamedNodeMap</code> object is a kind of <span
title=concept-collection>collection</span>, whose primary purpose is to expose
<code>Node</code>s by name.

<pre class=idl>interface <dfn>NamedNodeMap</dfn> {
  <span>Node</span> <span title=dom-NamedNodeMap-getNamedItem>getNamedItem</span>(DOMString name);
  <span>Node</span> <span title=dom-NamedNodeMap-setNamedItem>setNamedItem</span>(<span>Node</span> arg);
  <span>Node</span> <span title=dom-NamedNodeMap-removeNamedItem>removeNamedItem</span>(DOMString name);
  <span>Node</span> <span title=dom-NamedNodeMap-item>item</span>(unsigned long index);
  readonly attribute unsigned long <span title=dom-NamedNodeMap-length>length</span>;
  <span>Node</span> <span title=dom-NamedNodeMap-getNamedItemNS>getNamedItemNS</span>(DOMString namespace, DOMString localName);
  <span>Node</span> <span title=dom-NamedNodeMap-setNamedItemNS>setNamedItemNS</span>(<span>Node</span> arg);
  <span>Node</span> <span title=dom-NamedNodeMap-removeNamedItemNS>removeNamedItemNS</span>(DOMString namespace, DOMString localName);
};</pre>

<p><dfn title=dom-NamedNodeMap-getNamedItem>getNamedItem</dfn>

<p><dfn title=dom-NamedNodeMap-setNamedItem>setNamedItem</dfn>

<p><dfn title=dom-NamedNodeMap-removeNamedItem>removeNamedItem</dfn>

<p><dfn title=dom-NamedNodeMap-item>item</dfn>

<p>The <dfn title=dom-NamedNodeMap-length><code>length</code></dfn> attribute must return the number of nodes <span>represented by the collection</span>.

<p><dfn title=dom-NamedNodeMap-getNamedItemNS>getNamedItemNS</dfn>

<p><dfn title=dom-NamedNodeMap-setNamedItemNS>setNamedItemNS</dfn>

<p><dfn title=dom-NamedNodeMap-removeNamedItemNS>removeNamedItemNS</dfn>
-->


<h2 id="lists"><span class="secno">7 </span>Lists</h2>

<h3 id="interface-domstringlist"><span class="secno">7.1 </span>Interface <code><a href="#domstringlist">DOMStringList</a></code></h3>

<p class="XXX">Only HTMLPropertiesCollection.names, DataTranser.types, Clipboard.types, and Document.styleSheetSets seem to use this API. Should they use something like DOMString[] instead if Web IDL introduces that?

<pre class="idl">interface <dfn id="domstringlist">DOMStringList</dfn> {
  readonly attribute unsigned long <a href="#dom-domstringlist-length" title="dom-DOMStringList-length">length</a>;
  getter DOMString <a href="#dom-domstringlist-item" title="dom-DOMStringList-item">item</a>(unsigned long <var title="">index</var>);
  boolean <a href="#dom-domstringlist-contains" title="dom-DOMStringList-contains">contains</a>(DOMString <var title="">string</var>);
};</pre>

<p>The <code><a href="#domstringlist">DOMStringList</a></code> interface represents an interface to an
ordered list of strings.

<dl class="domintro">
 <dt><var title="">stringlist</var> . <code title="dom-DOMStringList-length"><a href="#dom-domstringlist-length">length</a></code>
 <dd><p>Returns the number of tokens in the string.

 <dt><var title="">string</var> = <var title="">stringlist</var> . <code title="dom-DOMStringList-item"><a href="#dom-domstringlist-item">item</a></code>(<var title="">index</var>)
 <dt><var title="">stringlist</var>[<var title="">index</var>]
 <dd>
  <p>Returns the string with index <var title="">index</var>.
  <p>Returns null if <var title="">index</var> is out of range.

 <dt><var title="">hasstring</var> = <var title="">stringlist</var> . <code title="dom-DOMStringList-contains"><a href="#dom-domstringlist-contains">contains</a></code>(<var title="">string</var>)
 <dd><p>Returns true if the <var title="">string</var> is present; false
 otherwise.
</dl>

<div class="impl">

<p>The <dfn id="dom-domstringlist-length" title="dom-DOMStringList-length"><code>length</code></dfn>
attribute must return the number of strings in the list.

<p>The object's
<a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a> are the
numbers in the range zero to
<code title="dom-DOMTokenList-length"><a href="#dom-domtokenlist-length">length</a></code>&minus;1, unless the
<code title="dom-DOMTokenList-length"><a href="#dom-domtokenlist-length">length</a></code> is zero, in which case
there are no
<a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>.

<p>The
<dfn id="dom-domstringlist-item" title="dom-DOMStringList-item"><code>item(<var title="">index</var>)</code></dfn>
method must return the <var title="">index</var>th string in the list. If
<var title="">index</var> is equal to or greater than the number of strings, then the
method must return null.

<p>The
<dfn id="dom-domstringlist-contains" title="dom-DOMStringList-contains"><code>contains(<var title="">string</var>)</code></dfn>
method must return true if the list of strings contains <var title="">string</var>,
or false otherwise.

</div>


<h3 id="interface-domtokenlist"><span class="secno">7.2 </span>Interface <code><a href="#domtokenlist">DOMTokenList</a></code></h3>
<p>The <code><a href="#domtokenlist">DOMTokenList</a></code> interface represents an interface
to an underlying string that consists of a <a href="#set-of-space-separated-tokens">set of
space-separated tokens</a>.

<p class="note"><code><a href="#domtokenlist">DOMTokenList</a></code> objects are always
<a href="#case-sensitive">case-sensitive</a>, even when the underlying string might
ordinarily be treated in a case-insensitive manner.

<pre class="idl">interface <dfn id="domtokenlist">DOMTokenList</dfn> {
  readonly attribute unsigned long <a href="#dom-domtokenlist-length" title="dom-DOMTokenList-length">length</a>;
  getter DOMString <a href="#dom-domtokenlist-item" title="dom-DOMTokenList-item">item</a>(unsigned long index);
  boolean <a href="#dom-domtokenlist-contains" title="dom-DOMTokenList-contains">contains</a>(DOMString token);
  void <a href="#dom-domtokenlist-add" title="dom-DOMTokenList-add">add</a>(DOMString token);
  void <a href="#dom-domtokenlist-remove" title="dom-DOMTokenList-remove">remove</a>(DOMString token);
  boolean <a href="#dom-domtokenlist-toggle" title="dom-DOMTokenList-toggle">toggle</a>(DOMString token);
  <a href="#dom-domtokenlist-tostring" title="dom-DOMTokenList-toString">stringifier</a> DOMString ();
};</pre>

<dl class="domintro">
 <dt><var title="">tokenlist</var> . <code title="dom-DOMTokenList-length"><a href="#dom-domtokenlist-length">length</a></code>
 <dd>
  <p>Returns the number of tokens in the string.

 <dt><var title="">element</var> = <var title="">tokenlist</var> . <code title="dom-DOMTokenList-item"><a href="#dom-domtokenlist-item">item</a></code>(<var title="">index</var>)
 <dt><var title="">tokenlist</var>[<var title="">index</var>]
 <dd>
  <p>Returns the token with index <var title="">index</var>. The tokens are returned in the order they are found in the underlying string.
  <p>Returns null if <var title="">index</var> is out of range.

 <dt><var title="">hastoken</var> = <var title="">tokenlist</var> . <code title="dom-DOMTokenList-contains"><a href="#dom-domtokenlist-contains">contains</a></code>(<var title="">token</var>)
 <dd>
  <p>Returns true if the <var title="">token</var> is present; false otherwise.
  <p>Throws a <code title="dom-DOMException-SYNTAX_ERR"><a href="#dom-domexception-syntax_err">SYNTAX_ERR</a></code> exception if <var title="">token</var> is empty.
  <p>Throws an <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code> exception if <var title="">token</var> contains any spaces.

 <dt><var title="">tokenlist</var> . <code title="dom-DOMTokenList-add"><a href="#dom-domtokenlist-add">add</a></code>(<var title="">token</var>)
 <dd>
  <p>Adds <var title="">token</var>, unless it is already present.
  <p>Throws a <code title="dom-DOMException-SYNTAX_ERR"><a href="#dom-domexception-syntax_err">SYNTAX_ERR</a></code> exception if <var title="">token</var> is empty.
  <p>Throws an <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code> exception if <var title="">token</var> contains any spaces.

 <dt><var title="">tokenlist</var> . <code title="dom-DOMTokenList-remove"><a href="#dom-domtokenlist-remove">remove</a></code>(<var title="">token</var>)
 <dd>
  <p>Removes <var title="">token</var> if it is present.
  <p>Throws a <code title="dom-DOMException-SYNTAX_ERR"><a href="#dom-domexception-syntax_err">SYNTAX_ERR</a></code> exception if <var title="">token</var> is empty.
  <p>Throws an <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code> exception if <var title="">token</var> contains any spaces.

 <dt><var title="">hastoken</var> = <var title="">tokenlist</var> . <code title="dom-DOMTokenList-toggle"><a href="#dom-domtokenlist-toggle">toggle</a></code>(<var title="">token</var>)
 <dd>
  <p>Adds <var title="">token</var> if it is not present, or removes
  it if it is. Returns true if <var title="">token</var> is now
  present (it was added); returns false if it is not (it was
  removed).
  <p>Throws a <code title="dom-DOMException-SYNTAX_ERR"><a href="#dom-domexception-syntax_err">SYNTAX_ERR</a></code> exception if <var title="">token</var> is empty.
  <p>Throws an <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code> exception if <var title="">token</var> contains any spaces.
</dl>

<div class="impl">

<p>The <dfn id="dom-domtokenlist-length" title="dom-DOMTokenList-length"><code>length</code></dfn>
attribute must return the number of tokens that result from <a href="#split-a-string-on-spaces" title="split a string on spaces">splitting the underlying string on
spaces</a>. This is the <var title="dom-DOMTokenList-length"><a href="#dom-domtokenlist-length">length</a></var>.

<p>The object's <a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>
are the numbers in the range zero to
<span title=""><var title="dom-DOMTokenList-length"><a href="#dom-domtokenlist-length">length</a></var>&minus;1</span>,
unless the <var title="dom-DOMTokenList-length"><a href="#dom-domtokenlist-length">length</a></var> is zero, in which
case there are no
<a class="external" href="http://dev.w3.org/2006/webapi/WebIDL/#dfn-supported-property-indices">supported property indices</a>.

<p>The
<dfn id="dom-domtokenlist-item" title="dom-DOMTokenList-item"><code>item(<var title="">index</var>)</code></dfn>
method must
<a href="#split-a-string-on-spaces" title="split a string on spaces">split the underlying string on spaces</a>,
preserving the order of the tokens as found in the underlying string, and then
return the <var title="">index</var>th item in this list. If <var title="">index</var>
is equal to or greater than the number of tokens, then the method must return null.

<p class="example">For example, if the string is "<code title="">a b a c</code>"
then there are four tokens: the token with index 0 is "<code title="">a</code>",
the token with index 1 is "<code title="">b</code>", the token with index 2 is
"<code title="">a</code>", and the token with index 3 is "<code title="">c</code>".

<p>The
<dfn id="dom-domtokenlist-contains" title="dom-DOMTokenList-contains"><code>contains(<var title="">token</var>)</code></dfn>
method must run the following algorithm:

<ol>
 <li>If the <var title="">token</var> argument is the empty string, then throw a
 <code title="dom-DOMException-SYNTAX_ERR"><a href="#dom-domexception-syntax_err">SYNTAX_ERR</a></code> exception and
 terminate these steps.

 <li>If the <var title="">token</var> argument contains any
 <a href="#space-character" title="space character">space characters</a>, then throw an
 <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.

 <li>Otherwise,
 <a href="#split-a-string-on-spaces" title="split a string on spaces">split the underlying string on spaces</a>
 to get the list of tokens in the object's underlying string.

 <li>If the token indicated by <var title="">token</var> is a
 <a href="#case-sensitive">case-sensitive</a> match for one of the tokens in the object's
 underlying string then return true and terminate these steps.

 <li>Otherwise, return false.
</ol>

<p>The
<dfn id="dom-domtokenlist-add" title="dom-DOMTokenList-add"><code>add(<var title="">token</var>)</code></dfn>
method must run the following algorithm:

<ol>
 <li>If the <var title="">token</var> argument is the empty string, then throw a
 <code title="dom-DOMException-SYNTAX_ERR"><a href="#dom-domexception-syntax_err">SYNTAX_ERR</a></code> exception and
 terminate these steps.

 <li>If the <var title="">token</var> argument contains any
 <a href="#space-character" title="space character">space characters</a>, then throw an
 <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.

 <li>Otherwise,
 <a href="#split-a-string-on-spaces" title="split a string on spaces">split the underlying string on spaces</a>
 to get the list of tokens in the object's underlying string.

 <li>If the given <var title="">token</var> is a <a href="#case-sensitive">case-sensitive</a> match
 for one of the tokens in the <code><a href="#domtokenlist">DOMTokenList</a></code> object's underlying
 string then terminate these steps.

 <li>Otherwise, if the <code><a href="#domtokenlist">DOMTokenList</a></code> object's underlying string is
 not the empty string and the last character of that string is not a
 <a href="#space-character">space character</a>, then append a U+0020 SPACE character to the end
 of that string.

 <li>Append the value of <var title="">token</var> to the end of the
 <code><a href="#domtokenlist">DOMTokenList</a></code> object's underlying string.
</ol>

<p>The
<dfn id="dom-domtokenlist-remove" title="dom-DOMTokenList-remove"><code>remove(<var title="">token</var>)</code></dfn>
method must run the following algorithm:

<ol>
 <li>If the <var title="">token</var> argument is the empty string, then throw a
 <code title="dom-DOMException-SYNTAX_ERR"><a href="#dom-domexception-syntax_err">SYNTAX_ERR</a></code> exception and
 terminate these steps.

 <li>If the <var title="">token</var> argument contains any
 <a href="#space-character" title="space character">space characters</a>, then throw an
 <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.

 <li>Otherwise,
 <a href="#remove-a-token-from-a-string" title="remove a token from a string">remove the given <var title="">token</var> from the underlying string</a>.
</ol>

<p>The
<dfn id="dom-domtokenlist-toggle" title="dom-DOMTokenList-toggle"><code>toggle(<var title="">token</var>)</code></dfn>
method must run the following algorithm:

<ol>
 <li>If the <var title="">token</var> argument is the empty string, then throw a
 <code title="dom-DOMException-SYNTAX_ERR"><a href="#dom-domexception-syntax_err">SYNTAX_ERR</a></code> exception and
 terminate these steps.

 <li>If the <var title="">token</var> argument contains any
 <a href="#space-character" title="space character">space characters</a>, then throw an
 <code title="dom-DOMException-INVALID_CHARACTER_ERR"><a href="#dom-domexception-invalid_character_err">INVALID_CHARACTER_ERR</a></code>
 exception and terminate these steps.

 <li>Otherwise,
 <a href="#split-a-string-on-spaces" title="split a string on spaces">split the underlying string on spaces</a>
 to get the list of tokens in the object's underlying string.

 <li>If the given <var title="">token</var> is a <a href="#case-sensitive">case-sensitive</a> match
 for one of the tokens in the <code><a href="#domtokenlist">DOMTokenList</a></code> object's underlying
 string then
 <a href="#remove-a-token-from-a-string" title="remove a token from a string">remove the given <var title="">token</var> from the underlying string</a>,
 return false and terminate these steps.

 <li>Otherwise, if the <code><a href="#domtokenlist">DOMTokenList</a></code> object's underlying string is
 not the empty string and the last character of that string is not a
 <a href="#space-character">space character</a>, then append a U+0020 SPACE character to the end
 of that string.

 <li>Append the value of <var title="">token</var> to the end of the
 <code><a href="#domtokenlist">DOMTokenList</a></code> object's underlying string.

 <li>Return true.
</ol>

<p>Objects implementing the <code><a href="#domtokenlist">DOMTokenList</a></code> interface must
<dfn id="dom-domtokenlist-tostring" title="dom-DOMTokenList-toString">stringify</dfn> to the object's
underlying string representation.

</div>


<h3 id="interface-domsettabletokenlist"><span class="secno">7.3 </span>Interface <code><a href="#domsettabletokenlist">DOMSettableTokenList</a></code></h3>

<p>The <code><a href="#domsettabletokenlist">DOMSettableTokenList</a></code> interface is the same as the
<code><a href="#domtokenlist">DOMTokenList</a></code> interface, except that it allows the
underlying string to be directly changed.

<pre class="idl">interface <dfn id="domsettabletokenlist">DOMSettableTokenList</dfn> : <a href="#domtokenlist">DOMTokenList</a> {
            attribute DOMString <a href="#dom-domsettabletokenlist-value" title="dom-DOMSettableTokenList-value">value</a>;
};</pre>

<dl class="domintro">
 <dt><var title="">tokenlist</var> . <code title="dom-DOMSettableTokenList-value"><a href="#dom-domsettabletokenlist-value">value</a></code>
 <dd>
  <p>Returns the underlying string.
  <p>Can be set, to change the underlying string.
</dl>

<div class="impl">

<p>An object implementing the <code><a href="#domsettabletokenlist">DOMSettableTokenList</a></code>
interface must act as defined for the <code><a href="#domtokenlist">DOMTokenList</a></code>
interface, except for the <code title="dom-DOMSettableTokenList-value"><a href="#dom-domsettabletokenlist-value">value</a></code> attribute defined
here.

<p>The <dfn id="dom-domsettabletokenlist-value" title="dom-DOMSettableTokenList-value"><code>value</code></dfn>
attribute must return the underlying string and, on setting must replace the underlying string with the new value.

</div>



<h2 id="dom-features"><span class="secno">8 </span>DOM features</h2>
<p class="warning">Authors are strongly discouraged from using
<a href="#concept-domfeature" title="concept-DOMfeature">DOM features</a>, as they are notoriously
unreliable and imprecise. Authors are encouraged to rely on explicit feature
testing or graceful degradation.

<p>A <dfn id="concept-domfeature" title="concept-DOMfeature">DOM feature</dfn> is a unique,
<a href="#ascii-case-insensitive">ASCII case-insensitive</a> string that represents a certain feature of
the user agent.

<p>A <dfn id="concept-domfeatureversion" title="concept-DOMfeatureversion">DOM feature version</dfn> is a (<var title="">feature</var>,&nbsp;<var title="">version</var>) tuple, where <var title="">feature</var> is <a href="#concept-domfeature" title="concept-DOMfeature">DOM feature</a>
and <var title="">version</var> is a <a href="#case-sensitive">case-sensitive</a> string
representing a version number.
<!--of the form "<var title>major</var>.<var title>minor</var>".-->

<p>Specifications may define which <a href="#concept-domfeature" title="concept-DOMfeature">DOM
features</a> a user agent is to <dfn id="concept-support-domfeature" title="concept-support-DOMfeature">support</dfn>, as well as an associated list of
one or more <a href="#case-sensitive">case-sensitive</a> strings representing version numbers, and under which circumstances, when necessary for compatibility (i.e. because of historical use). Specifications must not introduce new <a href="#concept-domfeature" title="concept-DOMfeature">DOM
features</a> or new versions for existing features.

<div class="impl">

<p>A user agent must <dfn id="concept-support-domfeatureversion" title="concept-support-DOMfeatureversion">support</dfn>
a <a href="#concept-domfeatureversion" title="concept-DOMfeatureversion">DOM feature version</a> (<var title="">feature</var>,&nbsp;<var title="">version</var>) if it <a href="#concept-support-domfeature" title="concept-support-DOMfeature">supports</a> a <a href="#concept-domfeature" title="concept-DOMfeature">DOM feature</a> that is a <a href="#ascii-case-insensitive">ASCII
case-insensitive</a> match for <var title="">feature</var> and <var title="">version</var> is in the associated list of versions.

<p>A user agent must <a href="#concept-support-domfeatureversion" title="concept-support-DOMfeatureversion">support</a> the (<var title="">feature</var>,&nbsp;"") tuple if it <a href="#concept-support-domfeature" title="concept-support-DOMfeature">supports</a> a <a href="#concept-domfeature" title="concept-DOMfeature">DOM feature</a> that is a <a href="#ascii-case-insensitive">ASCII
case-insensitive</a> match for <var title="">feature</var>.

<p>For historical reasons, user agents must <a href="#concept-support-domfeatureversion" title="concept-support-DOMfeatureversion">support</a> the
"XML" <a href="#concept-domfeature" title="concept-DOMfeature">DOM feature</a> with the versions "1.0"
and "2.0" associated with it, and the "Core" <a href="#concept-domfeature" title="concept-DOMfeature">DOM
feature</a> with the version "2.0" associated with it.

<!-- Chrome supports Core/1.0; Opera supports x/undefined -->

</div>



<h2 id="historical"><span class="secno">9 </span>Historical</h2>

<!-- XXX we should probably just nuke this section in due course. No need to keep old dreams alive. -->

<p>As explained in <a href="#goals">goals</a> this specification attempts to
update various DOM specifications. Along the way a number of changes has
been made of which this section is a rough summary.

<p>The features defined by this specification mostly originated elsewhere
and have been moved here as this was deemed a more appropriate location. As
such this specification includes features defined by former DOM Events and
DOM Core specifications, features once defined by HTML, and features defined
by the Element Traversal specification.</p>

<h3 id="dom-events"><span class="secno">9.1 </span>DOM Events</h3>

<p>This specification only replaces the core event model and not any of the
events for specific contexts (e.g. user interface events).

<p>It makes the following changes:</p>

<ul class="brief">
 <li>No more restrictions on <code title="dom-Event-type"><a href="#dom-event-type">Event.type</a></code>.
 <li>No need to invoke <code title="dom-Event-initEvent"><a href="#dom-event-initevent">initEvent()</a></code> to
 initialize an event.</li>
 <li><code title="dom-Event-preventDefault"><a href="#dom-event-preventdefault">preventDefault()</a></code> only
 changes what <code title="dom-Event-defaultPrevented"><a href="#dom-event-defaultprevented">defaultPrevented</a></code>
 and <code title="dom-EventTarget-dispatchEvent"><a href="#dom-eventtarget-dispatchevent">dispatchEvent()</a></code> return
 if the event is cancelable.
 <li>Removes <dfn id="eventexception"><code>EventException</code></dfn>.
 <li>Fire is no longer synonymous with dispatch, but includes initializing
 an event.</li>
 <li>The propagation and canceled flags are unset when invoking
 <code title="dom-Event-initEvent"><a href="#dom-event-initevent">initEvent()</a></code> rather than after
 dispatch.
</ul>


<h3 id="dom-core"><span class="secno">9.2 </span>DOM Core</h3>

<p><dfn id="domstring"><code>DOMString</code></dfn> and
<dfn id="domtimestamp"><code>DOMTimeStamp</code></dfn> originally defined in DOM Level 3 Core
are now defined in Web IDL.

<p><code><a href="#node">Node</a></code> now inherits from <code><a href="#eventtarget">EventTarget</a></code>.</p>

<p>The remainder of interfaces and interface members listed in this section
were once part of DOM Core. Implementations conforming to this specification
will not support them.

<p>Interfaces:
<ul class="brief">
 <li><dfn id="cdatasection"><code>CDATASection</code></dfn>
 <li><dfn id="domconfiguration"><code>DOMConfiguration</code></dfn>
 <li><dfn id="domerror"><code>DOMError</code></dfn>
 <li><dfn id="domerrorhandler"><code>DOMErrorHandler</code></dfn>
 <li><dfn id="domimplementationlist"><code>DOMImplementationList</code></dfn>
 <li><dfn id="domimplementationsource"><code>DOMImplementationSource</code></dfn>
 <li><dfn id="domlocator"><code>DOMLocator</code></dfn>
 <li><dfn id="domobject"><code>DOMObject</code></dfn>
 <li><dfn id="domuserdata"><code>DOMUserData</code></dfn>
 <li><dfn id="entity"><code>Entity</code></dfn>
 <li><dfn id="entityreference"><code>EntityReference</code></dfn>
 <li><dfn id="namednodemap"><code>NamedNodeMap</code></dfn> <!--AttrExodus-->
 <li><dfn id="namelist"><code>NameList</code></dfn>
 <li><dfn id="notation"><code>Notation</code></dfn>
 <li><dfn id="typeinfo"><code>TypeInfo</code></dfn>
 <li><dfn id="userdatahandler"><code>UserDataHandler</code></dfn>
</ul>

<p>Interface members:
<dl>
 <dt><code><a href="#node">Node</a></code>
 <dd>
  <!--AttrExodus-->
  <p><dfn id="dom-node-hasattributes" title="dom-Node-hasAttributes"><code>hasAttributes()</code></dfn>
  <p><dfn id="dom-node-attributes" title="dom-Node-attributes"><code>attributes</code></dfn>

  <!--NodeExodus-->
  <p><dfn id="dom-node-namespaceuri" title="dom-Node-namespaceURI"><code>namespaceURI</code></dfn>
  <p><dfn id="dom-node-prefix" title="dom-Node-prefix"><code>prefix</code></dfn>
  <p><dfn id="dom-node-localname" title="dom-Node-localName"><code>localName</code></dfn>


  <p><dfn id="dom-node-normalize" title="dom-Node-normalize"><code>normalize()</code></dfn>
  <p><dfn id="dom-node-issupported" title="dom-Node-isSupported"><code>isSupported</code></dfn>
  <p><dfn id="dom-node-getfeature" title="dom-Node-getFeature"><code>getFeature()</code></dfn>
  <p><dfn id="dom-node-getuserdata" title="dom-Node-getUserData"><code>getUserData()</code></dfn>
  <p><dfn id="dom-node-setuserdata" title="dom-Node-setUserData"><code>setUserData()</code></dfn>

 <dt><code><a href="#document">Document</a></code>
 <dd>
  <p><dfn id="dom-document-createcdatasection" title="dom-Document-createCDATASection"><code>createCDATASection()</code></dfn>
  <p><dfn id="dom-document-createattribute" title="dom-Document-createAttribute"><code>createAttribute()</code></dfn>
  <p><dfn id="dom-document-createattributens" title="dom-Document-createAttributeNS"><code>createAttributeNS()</code></dfn>
  <p><dfn id="dom-document-inputencoding" title="dom-Document-inputEncoding"><code>inputEncoding</code></dfn>
  <p><dfn id="dom-document-xmlencoding" title="dom-Document-xmlEncoding"><code>xmlEncoding</code></dfn>
  <p><dfn id="dom-document-xmlstandalone" title="dom-Document-xmlStandalone"><code>xmlStandalone</code></dfn>
  <p><dfn id="dom-document-xmlversion" title="dom-Document-xmlVersion"><code>xmlVersion</code></dfn>
  <p><dfn id="dom-document-stricterrorchecking" title="dom-Document-strictErrorChecking"><code>strictErrorChecking</code></dfn>
  <p><dfn id="dom-document-domconfig" title="dom-Document-domConfig"><code>domConfig</code></dfn>
  <p><dfn id="dom-document-normalizedocument" title="dom-Document-normalizeDocument"><code>normalizeDocument()</code></dfn>
  <p><dfn id="dom-document-renamenode" title="dom-Document-renameNode"><code>renameNode()</code></dfn>

 <dt><code><a href="#domimplementation">DOMImplementation</a></code>
 <dd>
  <p><dfn id="dom-domimplementation-getfeature" title="dom-DOMImplementation-getFeature"><code>getFeature()</code></dfn>

 <dt><code><a href="#attr">Attr</a></code>
 <dd>
  <p>No longer inherits from <code><a href="#node">Node</a></code> and therefore completely
  changed.
  <!--AttrExodus
  <p><dfn title=dom-Attr-schemaTypeInfo><code>schemaTypeInfo</code></dfn>
  <p><dfn title=dom-Attr-isId><code>isId</code></dfn>
  -->

 <dt><code><a href="#element">Element</a></code>
 <dd>
  <p><dfn id="dom-element-getattributenode" title="dom-Element-getAttributeNode"><code>getAttributeNode()</code></dfn>
  <p><dfn id="dom-element-getattributenodens" title="dom-Element-getAttributeNodeNS"><code>getAttributeNodeNS()</code></dfn>
  <p><dfn id="dom-element-setattributenode" title="dom-Element-setAttributeNode"><code>setAttributeNode()</code></dfn>
  <p><dfn id="dom-element-removeattributenode" title="dom-Element-removeAttributeNode"><code>removeAttributeNode()</code></dfn>
  <p><dfn id="dom-element-schematypeinfo" title="dom-Element-schemaTypeInfo"><code>schemaTypeInfo</code></dfn>
  <p><dfn id="dom-element-setidattribute" title="dom-Element-setIdAttribute"><code>setIdAttribute()</code></dfn>
  <p><dfn id="dom-element-setidattributens" title="dom-Element-setIdAttributeNS"><code>setIdAttributeNS()</code></dfn>
  <p><dfn id="dom-element-setidattributenode" title="dom-Element-setIdAttributeNode"><code>setIdAttributeNode()</code></dfn>

 <dt><code><a href="#documenttype">DocumentType</a></code>
 <dd>
  <p><dfn id="dom-documenttype-entities" title="dom-DocumentType-entities"><code>entities</code></dfn>
  <p><dfn id="dom-documenttype-notations" title="dom-DocumentType-notations"><code>notations</code></dfn>
  <p><dfn id="dom-documenttype-internalsubset" title="dom-DocumentType-internalSubset"><code>internalSubset</code></dfn>

 <dt><code><a href="#text">Text</a></code>
 <dd>
  <p><dfn id="dom-text-iselementcontentwhitespace" title="dom-Text-isElementContentWhitespace"><code>isElementContentWhitespace</code></dfn>
</dl>


<h3 id="html"><span class="secno">9.3 </span>HTML</h3>

<p>A number of DOM methods behave in a special way based on the
<a href="#html-namespace">HTML namespace</a> or <a href="#html-document">HTML document</a> variables. This
specification makes that an intrinsic part of the DOM.


<h3 id="element-traversal"><span class="secno">9.4 </span>Element Traversal</h3>

<p>This specification has removed <dfn id="dom-element-childelementcount" title="dom-Element-childElementCount"><code>childElementCount</code></dfn>.



<h2 class="no-num" id="references">References</h2>
<h3 class="no-num" id="normative-references">Normative references</h3>
<div id="anolis-references-normative"><dl><dt id="refsRFC2119">[RFC2119]
<dd><cite><a href="http://www.ietf.org/rfc/rfc2119.txt">Key words for use in RFCs to Indicate Requirement Levels</a></cite>, S. Bradner. IETF.

<dt id="refsWEBIDL">[WEBIDL]
<dd><cite><a href="http://dev.w3.org/2006/webapi/WebIDL/">Web IDL</a></cite>, C. McCormack and S. Weinig. W3C.

<dt id="refsXML">[XML]
<dd><cite><a href="http://www.w3.org/TR/xml/">Extensible Markup Language</a></cite>, T. Bray, J. Paoli, C. Sperberg-McQueen et al.. W3C.

<dt id="refsXMLNS">[XMLNS]
<dd><cite><a href="http://www.w3.org/TR/xml-names/">Namespaces in XML</a></cite>, T. Bray, D. Hollander, A. Layman et al.. W3C.

</dl></div>

<h3 class="no-num" id="informative-references">Informative references</h3>
<div id="anolis-references-informative"><dl><dt id="refsHTML">[HTML]
<dd><cite><a href="http://www.whatwg.org/specs/web-apps/current-work/multipage">HTML</a></cite>, I. Hickson. WHATWG.

</dl></div>



<h2 class="no-num" id="acknowledgements">Acknowledgements</h2>

<p>Thanks to

Adrian Bateman,
Dethe Elza,
Glenn Maynard,
Jacob Rossi,
Jonas Sicking,
Henri Sivonen,
Olli Pettay, and
Shiki Okasaka

for their useful comments.

<p>Special thanks to Geoffrey Sneddon and Simon Pieters for editing the initial
version of this specification and their useful comments.

<p>Special thanks also to Ian Hickson for first specifying some parts of
this specification in HTML and his useful comments.
<a class="informative" href="#refsHTML">[HTML]</a>

<p>Finally, while this specification has been written from scratch, special
thanks should also be extended to the editors of the various specifications
that previously defined the features in this specification. In particular:
<ul>
<li>Arnaud Le Hors
<li>Bj&ouml;rn H&ouml;hrmann
<li>Doug Schepers
<li>Gavin Nicol
<li>Jonathan Robie
<li>Lauren Wood
<li>Mike Champion
<li>Philippe Le H&eacute;garet
<li>Robin Berjon
<li>Steve Byrne
<li>Tom Pixley
</ul>
