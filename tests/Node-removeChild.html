<!DOCTYPE html>
<title>Node.removeChild</title>
<link rel="author" title="Ms2ger" href="mailto:ms2ger@gmail.com">
<link rel="help" href="../web-dom-core#dom-node-removechild">
<link rel="help" href="http://dev.w3.org/2006/webapi/WebIDL/#es-interface">
<body>
<script src="support/test.js"></script>
<script>
function testCrossDocument() {
  try {
    var s = this.contentDocument.createElement("a");
    Test.is(s.ownerDocument, this.contentDocument);
    try {
      document.body.removeChild(s);
      Test.fail("Exception should have been thrown.");
    } catch (e) {
      Test.is(e.code, DOMException.NOT_FOUND_ERR);
    }
    Test.is(s.ownerDocument, this.contentDocument);

    s = this.contentDocument.createElement("b");
    this.contentDocument.body.appendChild(s);
    Test.is(s.ownerDocument, this.contentDocument);
    try {
      document.body.removeChild(s);
      Test.fail("Exception should have been thrown.");
    } catch (e) {
      Test.is(e.code, DOMException.NOT_FOUND_ERR);
    }
    Test.is(s.ownerDocument, this.contentDocument);
  } catch (e) {
    Test.fail("Exception was thrown.");
  }
  Test.finish();
}

Test.runUntilFinish([function() {
  var len = document.body.childNodes.length;
  try {
    document.body.removeChild(null);
    Test.fail("Exception should have been thrown.");
  } catch (e) {
    Test.is(e.code, DOMException.NOT_SUPPORTED_ERR);
  }
  Test.is(document.body.childNodes.length, len);

  try {
    document.body.removeChild({'a':'b'});
    Test.fail("Exception should have been thrown.");
  } catch (e) {
    Test.ok(e instanceof TypeError, "Should have thrown TypeError.");
  }
  Test.is(document.body.childNodes.length, len);
},
function() {
  document.body.setAttribute("abc", "fail");
  var attr = document.body.attributes[0];
  Test.ok(attr, "No attribute node?");
  try {
    attr.removeChild(attr.firstChild);
  } catch (e) {
    Test.fail("Exception was thrown.");
  }
  Test.is(document.body.getAttribute("abc"), "");
  Test.is(document.body.hasAttribute("abc"), true);
  Test.is(attr.value, "");
  Test.is(attr.childNodes.length, 0);
},
function() {
  attr.value = "pass";
  try {
    attr.removeChild(null);
    Test.fail("Exception should have been thrown.");
  } catch (e) {
    Test.is(e.code, DOMException.NOT_SUPPORTED_ERR);
  }
  Test.is(attr.value, "pass");
  Test.is(attr.childNodes.length, 1);
  Test.is(attr.childNodes[0].nodeValue, "pass");
},
function() {
  var iframe = document.createElement("iframe");
  iframe.onload = testCrossDocument;
  iframe.src = "support/document.html";
  document.body.appendChild(iframe);
}]);
</script>
